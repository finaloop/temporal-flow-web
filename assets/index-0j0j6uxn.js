import{r as O,a as Au,g as Sa,R as J,c as Ms}from"./vendor-wpXbf5jk.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const a of c.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerPolicy&&(c.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?c.credentials="include":s.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(s){if(s.ep)return;s.ep=!0;const c=r(s);fetch(s.href,c)}})();var Na={exports:{}},ko={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mu=O,Pu=Symbol.for("react.element"),Ru=Symbol.for("react.fragment"),ju=Object.prototype.hasOwnProperty,Du=Mu.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ou={key:!0,ref:!0,__self:!0,__source:!0};function Ca(e,t,r){var o,s={},c=null,a=null;r!==void 0&&(c=""+r),t.key!==void 0&&(c=""+t.key),t.ref!==void 0&&(a=t.ref);for(o in t)ju.call(t,o)&&!Ou.hasOwnProperty(o)&&(s[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps,t)s[o]===void 0&&(s[o]=t[o]);return{$$typeof:Pu,type:e,key:c,ref:a,props:s,_owner:Du.current}}ko.Fragment=Ru;ko.jsx=Ca;ko.jsxs=Ca;Na.exports=ko;var _=Na.exports,Ia,Ps=Au;Ia=Ps.createRoot,Ps.hydrateRoot;function et(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let r=0,o;r<e.length;r++)(o=et(e[r]))!==""&&(t+=(t&&" ")+o);else for(let r in e)e[r]&&(t+=(t&&" ")+r);return t}var Ta={exports:{}},Aa={},Ma={exports:{}},Pa={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vn=O;function $u(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Bu=typeof Object.is=="function"?Object.is:$u,zu=Vn.useState,Lu=Vn.useEffect,Fu=Vn.useLayoutEffect,Ku=Vn.useDebugValue;function Hu(e,t){var r=t(),o=zu({inst:{value:r,getSnapshot:t}}),s=o[0].inst,c=o[1];return Fu(function(){s.value=r,s.getSnapshot=t,ui(s)&&c({inst:s})},[e,r,t]),Lu(function(){return ui(s)&&c({inst:s}),e(function(){ui(s)&&c({inst:s})})},[e]),Ku(r),r}function ui(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Bu(e,r)}catch{return!0}}function Wu(e,t){return t()}var qu=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Wu:Hu;Pa.useSyncExternalStore=Vn.useSyncExternalStore!==void 0?Vn.useSyncExternalStore:qu;Ma.exports=Pa;var Vu=Ma.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Eo=O,Yu=Vu;function Uu(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Xu=typeof Object.is=="function"?Object.is:Uu,Gu=Yu.useSyncExternalStore,Zu=Eo.useRef,Ju=Eo.useEffect,Qu=Eo.useMemo,el=Eo.useDebugValue;Aa.useSyncExternalStoreWithSelector=function(e,t,r,o,s){var c=Zu(null);if(c.current===null){var a={hasValue:!1,value:null};c.current=a}else a=c.current;c=Qu(function(){function d(w){if(!p){if(p=!0,m=w,w=o(w),s!==void 0&&a.hasValue){var E=a.value;if(s(E,w))return g=E}return g=w}if(E=g,Xu(m,w))return E;var N=o(w);return s!==void 0&&s(E,N)?E:(m=w,g=N)}var p=!1,m,g,v=r===void 0?null:r;return[function(){return d(t())},v===null?void 0:function(){return d(v())}]},[t,r,o,s]);var l=Gu(e,c[0],c[1]);return Ju(function(){a.hasValue=!0,a.value=l},[l]),el(l),l};Ta.exports=Aa;var tl=Ta.exports;const nl=Sa(tl),rl={BASE_URL:"./",DEV:!1,MODE:"production",PROD:!0,SSR:!1},Rs=e=>{let t;const r=new Set,o=(m,g)=>{const v=typeof m=="function"?m(t):m;if(!Object.is(v,t)){const w=t;t=g??(typeof v!="object"||v===null)?v:Object.assign({},t,v),r.forEach(E=>E(t,w))}},s=()=>t,d={setState:o,getState:s,getInitialState:()=>p,subscribe:m=>(r.add(m),()=>r.delete(m)),destroy:()=>{(rl?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},p=t=e(o,s,d);return d},ol=e=>e?Rs(e):Rs,{useDebugValue:il}=J,{useSyncExternalStoreWithSelector:sl}=nl,al=e=>e;function Ra(e,t=al,r){const o=sl(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return il(o),o}const js=(e,t)=>{const r=ol(e),o=(s,c=t)=>Ra(r,s,c);return Object.assign(o,r),o},cl=(e,t)=>e?js(e,t):js;function Je(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[o,s]of e)if(!Object.is(s,t.get(o)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const o of e)if(!t.has(o))return!1;return!0}const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!1;for(const o of r)if(!Object.prototype.hasOwnProperty.call(t,o)||!Object.is(e[o],t[o]))return!1;return!0}var ul={value:()=>{}};function So(){for(var e=0,t=arguments.length,r={},o;e<t;++e){if(!(o=arguments[e]+"")||o in r||/[\s.]/.test(o))throw new Error("illegal type: "+o);r[o]=[]}return new uo(r)}function uo(e){this._=e}function ll(e,t){return e.trim().split(/^|\s+/).map(function(r){var o="",s=r.indexOf(".");if(s>=0&&(o=r.slice(s+1),r=r.slice(0,s)),r&&!t.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:o}})}uo.prototype=So.prototype={constructor:uo,on:function(e,t){var r=this._,o=ll(e+"",r),s,c=-1,a=o.length;if(arguments.length<2){for(;++c<a;)if((s=(e=o[c]).type)&&(s=fl(r[s],e.name)))return s;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++c<a;)if(s=(e=o[c]).type)r[s]=Ds(r[s],e.name,t);else if(t==null)for(s in r)r[s]=Ds(r[s],e.name,null);return this},copy:function(){var e={},t=this._;for(var r in t)e[r]=t[r].slice();return new uo(e)},call:function(e,t){if((s=arguments.length-2)>0)for(var r=new Array(s),o=0,s,c;o<s;++o)r[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(c=this._[e],o=0,s=c.length;o<s;++o)c[o].value.apply(t,r)},apply:function(e,t,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var o=this._[e],s=0,c=o.length;s<c;++s)o[s].value.apply(t,r)}};function fl(e,t){for(var r=0,o=e.length,s;r<o;++r)if((s=e[r]).name===t)return s.value}function Ds(e,t,r){for(var o=0,s=e.length;o<s;++o)if(e[o].name===t){e[o]=ul,e=e.slice(0,o).concat(e.slice(o+1));break}return r!=null&&e.push({name:t,value:r}),e}var bi="http://www.w3.org/1999/xhtml";const Os={svg:"http://www.w3.org/2000/svg",xhtml:bi,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function No(e){var t=e+="",r=t.indexOf(":");return r>=0&&(t=e.slice(0,r))!=="xmlns"&&(e=e.slice(r+1)),Os.hasOwnProperty(t)?{space:Os[t],local:e}:e}function dl(e){return function(){var t=this.ownerDocument,r=this.namespaceURI;return r===bi&&t.documentElement.namespaceURI===bi?t.createElement(e):t.createElementNS(r,e)}}function hl(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function ja(e){var t=No(e);return(t.local?hl:dl)(t)}function pl(){}function Hi(e){return e==null?pl:function(){return this.querySelector(e)}}function ml(e){typeof e!="function"&&(e=Hi(e));for(var t=this._groups,r=t.length,o=new Array(r),s=0;s<r;++s)for(var c=t[s],a=c.length,l=o[s]=new Array(a),d,p,m=0;m<a;++m)(d=c[m])&&(p=e.call(d,d.__data__,m,c))&&("__data__"in d&&(p.__data__=d.__data__),l[m]=p);return new mt(o,this._parents)}function yl(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function gl(){return[]}function Da(e){return e==null?gl:function(){return this.querySelectorAll(e)}}function vl(e){return function(){return yl(e.apply(this,arguments))}}function wl(e){typeof e=="function"?e=vl(e):e=Da(e);for(var t=this._groups,r=t.length,o=[],s=[],c=0;c<r;++c)for(var a=t[c],l=a.length,d,p=0;p<l;++p)(d=a[p])&&(o.push(e.call(d,d.__data__,p,a)),s.push(d));return new mt(o,s)}function Oa(e){return function(){return this.matches(e)}}function $a(e){return function(t){return t.matches(e)}}var xl=Array.prototype.find;function bl(e){return function(){return xl.call(this.children,e)}}function _l(){return this.firstElementChild}function kl(e){return this.select(e==null?_l:bl(typeof e=="function"?e:$a(e)))}var El=Array.prototype.filter;function Sl(){return Array.from(this.children)}function Nl(e){return function(){return El.call(this.children,e)}}function Cl(e){return this.selectAll(e==null?Sl:Nl(typeof e=="function"?e:$a(e)))}function Il(e){typeof e!="function"&&(e=Oa(e));for(var t=this._groups,r=t.length,o=new Array(r),s=0;s<r;++s)for(var c=t[s],a=c.length,l=o[s]=[],d,p=0;p<a;++p)(d=c[p])&&e.call(d,d.__data__,p,c)&&l.push(d);return new mt(o,this._parents)}function Ba(e){return new Array(e.length)}function Tl(){return new mt(this._enter||this._groups.map(Ba),this._parents)}function po(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}po.prototype={constructor:po,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Al(e){return function(){return e}}function Ml(e,t,r,o,s,c){for(var a=0,l,d=t.length,p=c.length;a<p;++a)(l=t[a])?(l.__data__=c[a],o[a]=l):r[a]=new po(e,c[a]);for(;a<d;++a)(l=t[a])&&(s[a]=l)}function Pl(e,t,r,o,s,c,a){var l,d,p=new Map,m=t.length,g=c.length,v=new Array(m),w;for(l=0;l<m;++l)(d=t[l])&&(v[l]=w=a.call(d,d.__data__,l,t)+"",p.has(w)?s[l]=d:p.set(w,d));for(l=0;l<g;++l)w=a.call(e,c[l],l,c)+"",(d=p.get(w))?(o[l]=d,d.__data__=c[l],p.delete(w)):r[l]=new po(e,c[l]);for(l=0;l<m;++l)(d=t[l])&&p.get(v[l])===d&&(s[l]=d)}function Rl(e){return e.__data__}function jl(e,t){if(!arguments.length)return Array.from(this,Rl);var r=t?Pl:Ml,o=this._parents,s=this._groups;typeof e!="function"&&(e=Al(e));for(var c=s.length,a=new Array(c),l=new Array(c),d=new Array(c),p=0;p<c;++p){var m=o[p],g=s[p],v=g.length,w=Dl(e.call(m,m&&m.__data__,p,o)),E=w.length,N=l[p]=new Array(E),z=a[p]=new Array(E),P=d[p]=new Array(v);r(m,g,N,z,P,w,t);for(var H=0,K=0,I,Q;H<E;++H)if(I=N[H]){for(H>=K&&(K=H+1);!(Q=z[K])&&++K<E;);I._next=Q||null}}return a=new mt(a,o),a._enter=l,a._exit=d,a}function Dl(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Ol(){return new mt(this._exit||this._groups.map(Ba),this._parents)}function $l(e,t,r){var o=this.enter(),s=this,c=this.exit();return typeof e=="function"?(o=e(o),o&&(o=o.selection())):o=o.append(e+""),t!=null&&(s=t(s),s&&(s=s.selection())),r==null?c.remove():r(c),o&&s?o.merge(s).order():s}function Bl(e){for(var t=e.selection?e.selection():e,r=this._groups,o=t._groups,s=r.length,c=o.length,a=Math.min(s,c),l=new Array(s),d=0;d<a;++d)for(var p=r[d],m=o[d],g=p.length,v=l[d]=new Array(g),w,E=0;E<g;++E)(w=p[E]||m[E])&&(v[E]=w);for(;d<s;++d)l[d]=r[d];return new mt(l,this._parents)}function zl(){for(var e=this._groups,t=-1,r=e.length;++t<r;)for(var o=e[t],s=o.length-1,c=o[s],a;--s>=0;)(a=o[s])&&(c&&a.compareDocumentPosition(c)^4&&c.parentNode.insertBefore(a,c),c=a);return this}function Ll(e){e||(e=Fl);function t(g,v){return g&&v?e(g.__data__,v.__data__):!g-!v}for(var r=this._groups,o=r.length,s=new Array(o),c=0;c<o;++c){for(var a=r[c],l=a.length,d=s[c]=new Array(l),p,m=0;m<l;++m)(p=a[m])&&(d[m]=p);d.sort(t)}return new mt(s,this._parents).order()}function Fl(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Kl(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Hl(){return Array.from(this)}function Wl(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var o=e[t],s=0,c=o.length;s<c;++s){var a=o[s];if(a)return a}return null}function ql(){let e=0;for(const t of this)++e;return e}function Vl(){return!this.node()}function Yl(e){for(var t=this._groups,r=0,o=t.length;r<o;++r)for(var s=t[r],c=0,a=s.length,l;c<a;++c)(l=s[c])&&e.call(l,l.__data__,c,s);return this}function Ul(e){return function(){this.removeAttribute(e)}}function Xl(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Gl(e,t){return function(){this.setAttribute(e,t)}}function Zl(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Jl(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttribute(e):this.setAttribute(e,r)}}function Ql(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function ef(e,t){var r=No(e);if(arguments.length<2){var o=this.node();return r.local?o.getAttributeNS(r.space,r.local):o.getAttribute(r)}return this.each((t==null?r.local?Xl:Ul:typeof t=="function"?r.local?Ql:Jl:r.local?Zl:Gl)(r,t))}function za(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function tf(e){return function(){this.style.removeProperty(e)}}function nf(e,t,r){return function(){this.style.setProperty(e,t,r)}}function rf(e,t,r){return function(){var o=t.apply(this,arguments);o==null?this.style.removeProperty(e):this.style.setProperty(e,o,r)}}function of(e,t,r){return arguments.length>1?this.each((t==null?tf:typeof t=="function"?rf:nf)(e,t,r??"")):Yn(this.node(),e)}function Yn(e,t){return e.style.getPropertyValue(t)||za(e).getComputedStyle(e,null).getPropertyValue(t)}function sf(e){return function(){delete this[e]}}function af(e,t){return function(){this[e]=t}}function cf(e,t){return function(){var r=t.apply(this,arguments);r==null?delete this[e]:this[e]=r}}function uf(e,t){return arguments.length>1?this.each((t==null?sf:typeof t=="function"?cf:af)(e,t)):this.node()[e]}function La(e){return e.trim().split(/^|\s+/)}function Wi(e){return e.classList||new Fa(e)}function Fa(e){this._node=e,this._names=La(e.getAttribute("class")||"")}Fa.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Ka(e,t){for(var r=Wi(e),o=-1,s=t.length;++o<s;)r.add(t[o])}function Ha(e,t){for(var r=Wi(e),o=-1,s=t.length;++o<s;)r.remove(t[o])}function lf(e){return function(){Ka(this,e)}}function ff(e){return function(){Ha(this,e)}}function df(e,t){return function(){(t.apply(this,arguments)?Ka:Ha)(this,e)}}function hf(e,t){var r=La(e+"");if(arguments.length<2){for(var o=Wi(this.node()),s=-1,c=r.length;++s<c;)if(!o.contains(r[s]))return!1;return!0}return this.each((typeof t=="function"?df:t?lf:ff)(r,t))}function pf(){this.textContent=""}function mf(e){return function(){this.textContent=e}}function yf(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function gf(e){return arguments.length?this.each(e==null?pf:(typeof e=="function"?yf:mf)(e)):this.node().textContent}function vf(){this.innerHTML=""}function wf(e){return function(){this.innerHTML=e}}function xf(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function bf(e){return arguments.length?this.each(e==null?vf:(typeof e=="function"?xf:wf)(e)):this.node().innerHTML}function _f(){this.nextSibling&&this.parentNode.appendChild(this)}function kf(){return this.each(_f)}function Ef(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Sf(){return this.each(Ef)}function Nf(e){var t=typeof e=="function"?e:ja(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Cf(){return null}function If(e,t){var r=typeof e=="function"?e:ja(e),o=t==null?Cf:typeof t=="function"?t:Hi(t);return this.select(function(){return this.insertBefore(r.apply(this,arguments),o.apply(this,arguments)||null)})}function Tf(){var e=this.parentNode;e&&e.removeChild(this)}function Af(){return this.each(Tf)}function Mf(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Pf(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Rf(e){return this.select(e?Pf:Mf)}function jf(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Df(e){return function(t){e.call(this,t,this.__data__)}}function Of(e){return e.trim().split(/^|\s+/).map(function(t){var r="",o=t.indexOf(".");return o>=0&&(r=t.slice(o+1),t=t.slice(0,o)),{type:t,name:r}})}function $f(e){return function(){var t=this.__on;if(t){for(var r=0,o=-1,s=t.length,c;r<s;++r)c=t[r],(!e.type||c.type===e.type)&&c.name===e.name?this.removeEventListener(c.type,c.listener,c.options):t[++o]=c;++o?t.length=o:delete this.__on}}}function Bf(e,t,r){return function(){var o=this.__on,s,c=Df(t);if(o){for(var a=0,l=o.length;a<l;++a)if((s=o[a]).type===e.type&&s.name===e.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=c,s.options=r),s.value=t;return}}this.addEventListener(e.type,c,r),s={type:e.type,name:e.name,value:t,listener:c,options:r},o?o.push(s):this.__on=[s]}}function zf(e,t,r){var o=Of(e+""),s,c=o.length,a;if(arguments.length<2){var l=this.node().__on;if(l){for(var d=0,p=l.length,m;d<p;++d)for(s=0,m=l[d];s<c;++s)if((a=o[s]).type===m.type&&a.name===m.name)return m.value}return}for(l=t?Bf:$f,s=0;s<c;++s)this.each(l(o[s],t,r));return this}function Wa(e,t,r){var o=za(e),s=o.CustomEvent;typeof s=="function"?s=new s(t,r):(s=o.document.createEvent("Event"),r?(s.initEvent(t,r.bubbles,r.cancelable),s.detail=r.detail):s.initEvent(t,!1,!1)),e.dispatchEvent(s)}function Lf(e,t){return function(){return Wa(this,e,t)}}function Ff(e,t){return function(){return Wa(this,e,t.apply(this,arguments))}}function Kf(e,t){return this.each((typeof t=="function"?Ff:Lf)(e,t))}function*Hf(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var o=e[t],s=0,c=o.length,a;s<c;++s)(a=o[s])&&(yield a)}var qa=[null];function mt(e,t){this._groups=e,this._parents=t}function Cr(){return new mt([[document.documentElement]],qa)}function Wf(){return this}mt.prototype=Cr.prototype={constructor:mt,select:ml,selectAll:wl,selectChild:kl,selectChildren:Cl,filter:Il,data:jl,enter:Tl,exit:Ol,join:$l,merge:Bl,selection:Wf,order:zl,sort:Ll,call:Kl,nodes:Hl,node:Wl,size:ql,empty:Vl,each:Yl,attr:ef,style:of,property:uf,classed:hf,text:gf,html:bf,raise:kf,lower:Sf,append:Nf,insert:If,remove:Af,clone:Rf,datum:jf,on:zf,dispatch:Kf,[Symbol.iterator]:Hf};function bt(e){return typeof e=="string"?new mt([[document.querySelector(e)]],[document.documentElement]):new mt([[e]],qa)}function qf(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Ct(e,t){if(e=qf(e),t===void 0&&(t=e.currentTarget),t){var r=t.ownerSVGElement||t;if(r.createSVGPoint){var o=r.createSVGPoint();return o.x=e.clientX,o.y=e.clientY,o=o.matrixTransform(t.getScreenCTM().inverse()),[o.x,o.y]}if(t.getBoundingClientRect){var s=t.getBoundingClientRect();return[e.clientX-s.left-t.clientLeft,e.clientY-s.top-t.clientTop]}}return[e.pageX,e.pageY]}const Vf={passive:!1},vr={capture:!0,passive:!1};function li(e){e.stopImmediatePropagation()}function Hn(e){e.preventDefault(),e.stopImmediatePropagation()}function Va(e){var t=e.document.documentElement,r=bt(e).on("dragstart.drag",Hn,vr);"onselectstart"in t?r.on("selectstart.drag",Hn,vr):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Ya(e,t){var r=e.document.documentElement,o=bt(e).on("dragstart.drag",null);t&&(o.on("click.drag",Hn,vr),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in r?o.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}const Qr=e=>()=>e;function _i(e,{sourceEvent:t,subject:r,target:o,identifier:s,active:c,x:a,y:l,dx:d,dy:p,dispatch:m}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:c,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:d,enumerable:!0,configurable:!0},dy:{value:p,enumerable:!0,configurable:!0},_:{value:m}})}_i.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Yf(e){return!e.ctrlKey&&!e.button}function Uf(){return this.parentNode}function Xf(e,t){return t??{x:e.x,y:e.y}}function Gf(){return navigator.maxTouchPoints||"ontouchstart"in this}function Zf(){var e=Yf,t=Uf,r=Xf,o=Gf,s={},c=So("start","drag","end"),a=0,l,d,p,m,g=0;function v(I){I.on("mousedown.drag",w).filter(o).on("touchstart.drag",z).on("touchmove.drag",P,Vf).on("touchend.drag touchcancel.drag",H).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function w(I,Q){if(!(m||!e.call(this,I,Q))){var G=K(this,t.call(this,I,Q),I,Q,"mouse");G&&(bt(I.view).on("mousemove.drag",E,vr).on("mouseup.drag",N,vr),Va(I.view),li(I),p=!1,l=I.clientX,d=I.clientY,G("start",I))}}function E(I){if(Hn(I),!p){var Q=I.clientX-l,G=I.clientY-d;p=Q*Q+G*G>g}s.mouse("drag",I)}function N(I){bt(I.view).on("mousemove.drag mouseup.drag",null),Ya(I.view,p),Hn(I),s.mouse("end",I)}function z(I,Q){if(e.call(this,I,Q)){var G=I.changedTouches,Y=t.call(this,I,Q),te=G.length,V,ie;for(V=0;V<te;++V)(ie=K(this,Y,I,Q,G[V].identifier,G[V]))&&(li(I),ie("start",I,G[V]))}}function P(I){var Q=I.changedTouches,G=Q.length,Y,te;for(Y=0;Y<G;++Y)(te=s[Q[Y].identifier])&&(Hn(I),te("drag",I,Q[Y]))}function H(I){var Q=I.changedTouches,G=Q.length,Y,te;for(m&&clearTimeout(m),m=setTimeout(function(){m=null},500),Y=0;Y<G;++Y)(te=s[Q[Y].identifier])&&(li(I),te("end",I,Q[Y]))}function K(I,Q,G,Y,te,V){var ie=c.copy(),ee=Ct(V||G,Q),se,ae,b;if((b=r.call(I,new _i("beforestart",{sourceEvent:G,target:v,identifier:te,active:a,x:ee[0],y:ee[1],dx:0,dy:0,dispatch:ie}),Y))!=null)return se=b.x-ee[0]||0,ae=b.y-ee[1]||0,function A(R,Z,re){var M=ee,q;switch(R){case"start":s[te]=A,q=a++;break;case"end":delete s[te],--a;case"drag":ee=Ct(re||Z,Q),q=a;break}ie.call(R,I,new _i(R,{sourceEvent:Z,subject:b,target:v,identifier:te,active:q,x:ee[0]+se,y:ee[1]+ae,dx:ee[0]-M[0],dy:ee[1]-M[1],dispatch:ie}),Y)}}return v.filter=function(I){return arguments.length?(e=typeof I=="function"?I:Qr(!!I),v):e},v.container=function(I){return arguments.length?(t=typeof I=="function"?I:Qr(I),v):t},v.subject=function(I){return arguments.length?(r=typeof I=="function"?I:Qr(I),v):r},v.touchable=function(I){return arguments.length?(o=typeof I=="function"?I:Qr(!!I),v):o},v.on=function(){var I=c.on.apply(c,arguments);return I===c?v:I},v.clickDistance=function(I){return arguments.length?(g=(I=+I)*I,v):Math.sqrt(g)},v}function qi(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function Ua(e,t){var r=Object.create(e.prototype);for(var o in t)r[o]=t[o];return r}function Ir(){}var wr=.7,mo=1/wr,Wn="\\s*([+-]?\\d+)\\s*",xr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Kt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Jf=/^#([0-9a-f]{3,8})$/,Qf=new RegExp(`^rgb\\(${Wn},${Wn},${Wn}\\)$`),ed=new RegExp(`^rgb\\(${Kt},${Kt},${Kt}\\)$`),td=new RegExp(`^rgba\\(${Wn},${Wn},${Wn},${xr}\\)$`),nd=new RegExp(`^rgba\\(${Kt},${Kt},${Kt},${xr}\\)$`),rd=new RegExp(`^hsl\\(${xr},${Kt},${Kt}\\)$`),od=new RegExp(`^hsla\\(${xr},${Kt},${Kt},${xr}\\)$`),$s={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};qi(Ir,br,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Bs,formatHex:Bs,formatHex8:id,formatHsl:sd,formatRgb:zs,toString:zs});function Bs(){return this.rgb().formatHex()}function id(){return this.rgb().formatHex8()}function sd(){return Xa(this).formatHsl()}function zs(){return this.rgb().formatRgb()}function br(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=Jf.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?Ls(t):r===3?new ft(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?eo(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?eo(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Qf.exec(e))?new ft(t[1],t[2],t[3],1):(t=ed.exec(e))?new ft(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=td.exec(e))?eo(t[1],t[2],t[3],t[4]):(t=nd.exec(e))?eo(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=rd.exec(e))?Hs(t[1],t[2]/100,t[3]/100,1):(t=od.exec(e))?Hs(t[1],t[2]/100,t[3]/100,t[4]):$s.hasOwnProperty(e)?Ls($s[e]):e==="transparent"?new ft(NaN,NaN,NaN,0):null}function Ls(e){return new ft(e>>16&255,e>>8&255,e&255,1)}function eo(e,t,r,o){return o<=0&&(e=t=r=NaN),new ft(e,t,r,o)}function ad(e){return e instanceof Ir||(e=br(e)),e?(e=e.rgb(),new ft(e.r,e.g,e.b,e.opacity)):new ft}function ki(e,t,r,o){return arguments.length===1?ad(e):new ft(e,t,r,o??1)}function ft(e,t,r,o){this.r=+e,this.g=+t,this.b=+r,this.opacity=+o}qi(ft,ki,Ua(Ir,{brighter(e){return e=e==null?mo:Math.pow(mo,e),new ft(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?wr:Math.pow(wr,e),new ft(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ft(_n(this.r),_n(this.g),_n(this.b),yo(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Fs,formatHex:Fs,formatHex8:cd,formatRgb:Ks,toString:Ks}));function Fs(){return`#${xn(this.r)}${xn(this.g)}${xn(this.b)}`}function cd(){return`#${xn(this.r)}${xn(this.g)}${xn(this.b)}${xn((isNaN(this.opacity)?1:this.opacity)*255)}`}function Ks(){const e=yo(this.opacity);return`${e===1?"rgb(":"rgba("}${_n(this.r)}, ${_n(this.g)}, ${_n(this.b)}${e===1?")":`, ${e})`}`}function yo(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function _n(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function xn(e){return e=_n(e),(e<16?"0":"")+e.toString(16)}function Hs(e,t,r,o){return o<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new It(e,t,r,o)}function Xa(e){if(e instanceof It)return new It(e.h,e.s,e.l,e.opacity);if(e instanceof Ir||(e=br(e)),!e)return new It;if(e instanceof It)return e;e=e.rgb();var t=e.r/255,r=e.g/255,o=e.b/255,s=Math.min(t,r,o),c=Math.max(t,r,o),a=NaN,l=c-s,d=(c+s)/2;return l?(t===c?a=(r-o)/l+(r<o)*6:r===c?a=(o-t)/l+2:a=(t-r)/l+4,l/=d<.5?c+s:2-c-s,a*=60):l=d>0&&d<1?0:a,new It(a,l,d,e.opacity)}function ud(e,t,r,o){return arguments.length===1?Xa(e):new It(e,t,r,o??1)}function It(e,t,r,o){this.h=+e,this.s=+t,this.l=+r,this.opacity=+o}qi(It,ud,Ua(Ir,{brighter(e){return e=e==null?mo:Math.pow(mo,e),new It(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?wr:Math.pow(wr,e),new It(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,o=r+(r<.5?r:1-r)*t,s=2*r-o;return new ft(fi(e>=240?e-240:e+120,s,o),fi(e,s,o),fi(e<120?e+240:e-120,s,o),this.opacity)},clamp(){return new It(Ws(this.h),to(this.s),to(this.l),yo(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=yo(this.opacity);return`${e===1?"hsl(":"hsla("}${Ws(this.h)}, ${to(this.s)*100}%, ${to(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Ws(e){return e=(e||0)%360,e<0?e+360:e}function to(e){return Math.max(0,Math.min(1,e||0))}function fi(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const Ga=e=>()=>e;function ld(e,t){return function(r){return e+r*t}}function fd(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(o){return Math.pow(e+o*t,r)}}function dd(e){return(e=+e)==1?Za:function(t,r){return r-t?fd(t,r,e):Ga(isNaN(t)?r:t)}}function Za(e,t){var r=t-e;return r?ld(e,r):Ga(isNaN(e)?t:e)}const qs=function e(t){var r=dd(t);function o(s,c){var a=r((s=ki(s)).r,(c=ki(c)).r),l=r(s.g,c.g),d=r(s.b,c.b),p=Za(s.opacity,c.opacity);return function(m){return s.r=a(m),s.g=l(m),s.b=d(m),s.opacity=p(m),s+""}}return o.gamma=e,o}(1);function fn(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}var Ei=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,di=new RegExp(Ei.source,"g");function hd(e){return function(){return e}}function pd(e){return function(t){return e(t)+""}}function md(e,t){var r=Ei.lastIndex=di.lastIndex=0,o,s,c,a=-1,l=[],d=[];for(e=e+"",t=t+"";(o=Ei.exec(e))&&(s=di.exec(t));)(c=s.index)>r&&(c=t.slice(r,c),l[a]?l[a]+=c:l[++a]=c),(o=o[0])===(s=s[0])?l[a]?l[a]+=s:l[++a]=s:(l[++a]=null,d.push({i:a,x:fn(o,s)})),r=di.lastIndex;return r<t.length&&(c=t.slice(r),l[a]?l[a]+=c:l[++a]=c),l.length<2?d[0]?pd(d[0].x):hd(t):(t=d.length,function(p){for(var m=0,g;m<t;++m)l[(g=d[m]).i]=g.x(p);return l.join("")})}var Vs=180/Math.PI,Si={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Ja(e,t,r,o,s,c){var a,l,d;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(d=e*r+t*o)&&(r-=e*d,o-=t*d),(l=Math.sqrt(r*r+o*o))&&(r/=l,o/=l,d/=l),e*o<t*r&&(e=-e,t=-t,d=-d,a=-a),{translateX:s,translateY:c,rotate:Math.atan2(t,e)*Vs,skewX:Math.atan(d)*Vs,scaleX:a,scaleY:l}}var no;function yd(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Si:Ja(t.a,t.b,t.c,t.d,t.e,t.f)}function gd(e){return e==null||(no||(no=document.createElementNS("http://www.w3.org/2000/svg","g")),no.setAttribute("transform",e),!(e=no.transform.baseVal.consolidate()))?Si:(e=e.matrix,Ja(e.a,e.b,e.c,e.d,e.e,e.f))}function Qa(e,t,r,o){function s(p){return p.length?p.pop()+" ":""}function c(p,m,g,v,w,E){if(p!==g||m!==v){var N=w.push("translate(",null,t,null,r);E.push({i:N-4,x:fn(p,g)},{i:N-2,x:fn(m,v)})}else(g||v)&&w.push("translate("+g+t+v+r)}function a(p,m,g,v){p!==m?(p-m>180?m+=360:m-p>180&&(p+=360),v.push({i:g.push(s(g)+"rotate(",null,o)-2,x:fn(p,m)})):m&&g.push(s(g)+"rotate("+m+o)}function l(p,m,g,v){p!==m?v.push({i:g.push(s(g)+"skewX(",null,o)-2,x:fn(p,m)}):m&&g.push(s(g)+"skewX("+m+o)}function d(p,m,g,v,w,E){if(p!==g||m!==v){var N=w.push(s(w)+"scale(",null,",",null,")");E.push({i:N-4,x:fn(p,g)},{i:N-2,x:fn(m,v)})}else(g!==1||v!==1)&&w.push(s(w)+"scale("+g+","+v+")")}return function(p,m){var g=[],v=[];return p=e(p),m=e(m),c(p.translateX,p.translateY,m.translateX,m.translateY,g,v),a(p.rotate,m.rotate,g,v),l(p.skewX,m.skewX,g,v),d(p.scaleX,p.scaleY,m.scaleX,m.scaleY,g,v),p=m=null,function(w){for(var E=-1,N=v.length,z;++E<N;)g[(z=v[E]).i]=z.x(w);return g.join("")}}}var vd=Qa(yd,"px, ","px)","deg)"),wd=Qa(gd,", ",")",")"),xd=1e-12;function Ys(e){return((e=Math.exp(e))+1/e)/2}function bd(e){return((e=Math.exp(e))-1/e)/2}function _d(e){return((e=Math.exp(2*e))-1)/(e+1)}const kd=function e(t,r,o){function s(c,a){var l=c[0],d=c[1],p=c[2],m=a[0],g=a[1],v=a[2],w=m-l,E=g-d,N=w*w+E*E,z,P;if(N<xd)P=Math.log(v/p)/t,z=function(Y){return[l+Y*w,d+Y*E,p*Math.exp(t*Y*P)]};else{var H=Math.sqrt(N),K=(v*v-p*p+o*N)/(2*p*r*H),I=(v*v-p*p-o*N)/(2*v*r*H),Q=Math.log(Math.sqrt(K*K+1)-K),G=Math.log(Math.sqrt(I*I+1)-I);P=(G-Q)/t,z=function(Y){var te=Y*P,V=Ys(Q),ie=p/(r*H)*(V*_d(t*te+Q)-bd(Q));return[l+ie*w,d+ie*E,p*V/Ys(t*te+Q)]}}return z.duration=P*1e3*t/Math.SQRT2,z}return s.rho=function(c){var a=Math.max(.001,+c),l=a*a,d=l*l;return e(a,l,d)},s}(Math.SQRT2,2,4);var Un=0,mr=0,lr=0,ec=1e3,go,yr,vo=0,En=0,Co=0,_r=typeof performance=="object"&&performance.now?performance:Date,tc=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Vi(){return En||(tc(Ed),En=_r.now()+Co)}function Ed(){En=0}function wo(){this._call=this._time=this._next=null}wo.prototype=nc.prototype={constructor:wo,restart:function(e,t,r){if(typeof e!="function")throw new TypeError("callback is not a function");r=(r==null?Vi():+r)+(t==null?0:+t),!this._next&&yr!==this&&(yr?yr._next=this:go=this,yr=this),this._call=e,this._time=r,Ni()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ni())}};function nc(e,t,r){var o=new wo;return o.restart(e,t,r),o}function Sd(){Vi(),++Un;for(var e=go,t;e;)(t=En-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Un}function Us(){En=(vo=_r.now())+Co,Un=mr=0;try{Sd()}finally{Un=0,Cd(),En=0}}function Nd(){var e=_r.now(),t=e-vo;t>ec&&(Co-=t,vo=e)}function Cd(){for(var e,t=go,r,o=1/0;t;)t._call?(o>t._time&&(o=t._time),e=t,t=t._next):(r=t._next,t._next=null,t=e?e._next=r:go=r);yr=e,Ni(o)}function Ni(e){if(!Un){mr&&(mr=clearTimeout(mr));var t=e-En;t>24?(e<1/0&&(mr=setTimeout(Us,e-_r.now()-Co)),lr&&(lr=clearInterval(lr))):(lr||(vo=_r.now(),lr=setInterval(Nd,ec)),Un=1,tc(Us))}}function Xs(e,t,r){var o=new wo;return t=t==null?0:+t,o.restart(s=>{o.stop(),e(s+t)},t,r),o}var Id=So("start","end","cancel","interrupt"),Td=[],rc=0,Gs=1,Ci=2,lo=3,Zs=4,Ii=5,fo=6;function Io(e,t,r,o,s,c){var a=e.__transition;if(!a)e.__transition={};else if(r in a)return;Ad(e,r,{name:t,index:o,group:s,on:Id,tween:Td,time:c.time,delay:c.delay,duration:c.duration,ease:c.ease,timer:null,state:rc})}function Yi(e,t){var r=At(e,t);if(r.state>rc)throw new Error("too late; already scheduled");return r}function Ht(e,t){var r=At(e,t);if(r.state>lo)throw new Error("too late; already running");return r}function At(e,t){var r=e.__transition;if(!r||!(r=r[t]))throw new Error("transition not found");return r}function Ad(e,t,r){var o=e.__transition,s;o[t]=r,r.timer=nc(c,0,r.time);function c(p){r.state=Gs,r.timer.restart(a,r.delay,r.time),r.delay<=p&&a(p-r.delay)}function a(p){var m,g,v,w;if(r.state!==Gs)return d();for(m in o)if(w=o[m],w.name===r.name){if(w.state===lo)return Xs(a);w.state===Zs?(w.state=fo,w.timer.stop(),w.on.call("interrupt",e,e.__data__,w.index,w.group),delete o[m]):+m<t&&(w.state=fo,w.timer.stop(),w.on.call("cancel",e,e.__data__,w.index,w.group),delete o[m])}if(Xs(function(){r.state===lo&&(r.state=Zs,r.timer.restart(l,r.delay,r.time),l(p))}),r.state=Ci,r.on.call("start",e,e.__data__,r.index,r.group),r.state===Ci){for(r.state=lo,s=new Array(v=r.tween.length),m=0,g=-1;m<v;++m)(w=r.tween[m].value.call(e,e.__data__,r.index,r.group))&&(s[++g]=w);s.length=g+1}}function l(p){for(var m=p<r.duration?r.ease.call(null,p/r.duration):(r.timer.restart(d),r.state=Ii,1),g=-1,v=s.length;++g<v;)s[g].call(e,m);r.state===Ii&&(r.on.call("end",e,e.__data__,r.index,r.group),d())}function d(){r.state=fo,r.timer.stop(),delete o[t];for(var p in o)return;delete e.__transition}}function ho(e,t){var r=e.__transition,o,s,c=!0,a;if(r){t=t==null?null:t+"";for(a in r){if((o=r[a]).name!==t){c=!1;continue}s=o.state>Ci&&o.state<Ii,o.state=fo,o.timer.stop(),o.on.call(s?"interrupt":"cancel",e,e.__data__,o.index,o.group),delete r[a]}c&&delete e.__transition}}function Md(e){return this.each(function(){ho(this,e)})}function Pd(e,t){var r,o;return function(){var s=Ht(this,e),c=s.tween;if(c!==r){o=r=c;for(var a=0,l=o.length;a<l;++a)if(o[a].name===t){o=o.slice(),o.splice(a,1);break}}s.tween=o}}function Rd(e,t,r){var o,s;if(typeof r!="function")throw new Error;return function(){var c=Ht(this,e),a=c.tween;if(a!==o){s=(o=a).slice();for(var l={name:t,value:r},d=0,p=s.length;d<p;++d)if(s[d].name===t){s[d]=l;break}d===p&&s.push(l)}c.tween=s}}function jd(e,t){var r=this._id;if(e+="",arguments.length<2){for(var o=At(this.node(),r).tween,s=0,c=o.length,a;s<c;++s)if((a=o[s]).name===e)return a.value;return null}return this.each((t==null?Pd:Rd)(r,e,t))}function Ui(e,t,r){var o=e._id;return e.each(function(){var s=Ht(this,o);(s.value||(s.value={}))[t]=r.apply(this,arguments)}),function(s){return At(s,o).value[t]}}function oc(e,t){var r;return(typeof t=="number"?fn:t instanceof br?qs:(r=br(t))?(t=r,qs):md)(e,t)}function Dd(e){return function(){this.removeAttribute(e)}}function Od(e){return function(){this.removeAttributeNS(e.space,e.local)}}function $d(e,t,r){var o,s=r+"",c;return function(){var a=this.getAttribute(e);return a===s?null:a===o?c:c=t(o=a,r)}}function Bd(e,t,r){var o,s=r+"",c;return function(){var a=this.getAttributeNS(e.space,e.local);return a===s?null:a===o?c:c=t(o=a,r)}}function zd(e,t,r){var o,s,c;return function(){var a,l=r(this),d;return l==null?void this.removeAttribute(e):(a=this.getAttribute(e),d=l+"",a===d?null:a===o&&d===s?c:(s=d,c=t(o=a,l)))}}function Ld(e,t,r){var o,s,c;return function(){var a,l=r(this),d;return l==null?void this.removeAttributeNS(e.space,e.local):(a=this.getAttributeNS(e.space,e.local),d=l+"",a===d?null:a===o&&d===s?c:(s=d,c=t(o=a,l)))}}function Fd(e,t){var r=No(e),o=r==="transform"?wd:oc;return this.attrTween(e,typeof t=="function"?(r.local?Ld:zd)(r,o,Ui(this,"attr."+e,t)):t==null?(r.local?Od:Dd)(r):(r.local?Bd:$d)(r,o,t))}function Kd(e,t){return function(r){this.setAttribute(e,t.call(this,r))}}function Hd(e,t){return function(r){this.setAttributeNS(e.space,e.local,t.call(this,r))}}function Wd(e,t){var r,o;function s(){var c=t.apply(this,arguments);return c!==o&&(r=(o=c)&&Hd(e,c)),r}return s._value=t,s}function qd(e,t){var r,o;function s(){var c=t.apply(this,arguments);return c!==o&&(r=(o=c)&&Kd(e,c)),r}return s._value=t,s}function Vd(e,t){var r="attr."+e;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;var o=No(e);return this.tween(r,(o.local?Wd:qd)(o,t))}function Yd(e,t){return function(){Yi(this,e).delay=+t.apply(this,arguments)}}function Ud(e,t){return t=+t,function(){Yi(this,e).delay=t}}function Xd(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Yd:Ud)(t,e)):At(this.node(),t).delay}function Gd(e,t){return function(){Ht(this,e).duration=+t.apply(this,arguments)}}function Zd(e,t){return t=+t,function(){Ht(this,e).duration=t}}function Jd(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Gd:Zd)(t,e)):At(this.node(),t).duration}function Qd(e,t){if(typeof t!="function")throw new Error;return function(){Ht(this,e).ease=t}}function eh(e){var t=this._id;return arguments.length?this.each(Qd(t,e)):At(this.node(),t).ease}function th(e,t){return function(){var r=t.apply(this,arguments);if(typeof r!="function")throw new Error;Ht(this,e).ease=r}}function nh(e){if(typeof e!="function")throw new Error;return this.each(th(this._id,e))}function rh(e){typeof e!="function"&&(e=Oa(e));for(var t=this._groups,r=t.length,o=new Array(r),s=0;s<r;++s)for(var c=t[s],a=c.length,l=o[s]=[],d,p=0;p<a;++p)(d=c[p])&&e.call(d,d.__data__,p,c)&&l.push(d);return new Qt(o,this._parents,this._name,this._id)}function oh(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,r=e._groups,o=t.length,s=r.length,c=Math.min(o,s),a=new Array(o),l=0;l<c;++l)for(var d=t[l],p=r[l],m=d.length,g=a[l]=new Array(m),v,w=0;w<m;++w)(v=d[w]||p[w])&&(g[w]=v);for(;l<o;++l)a[l]=t[l];return new Qt(a,this._parents,this._name,this._id)}function ih(e){return(e+"").trim().split(/^|\s+/).every(function(t){var r=t.indexOf(".");return r>=0&&(t=t.slice(0,r)),!t||t==="start"})}function sh(e,t,r){var o,s,c=ih(t)?Yi:Ht;return function(){var a=c(this,e),l=a.on;l!==o&&(s=(o=l).copy()).on(t,r),a.on=s}}function ah(e,t){var r=this._id;return arguments.length<2?At(this.node(),r).on.on(e):this.each(sh(r,e,t))}function ch(e){return function(){var t=this.parentNode;for(var r in this.__transition)if(+r!==e)return;t&&t.removeChild(this)}}function uh(){return this.on("end.remove",ch(this._id))}function lh(e){var t=this._name,r=this._id;typeof e!="function"&&(e=Hi(e));for(var o=this._groups,s=o.length,c=new Array(s),a=0;a<s;++a)for(var l=o[a],d=l.length,p=c[a]=new Array(d),m,g,v=0;v<d;++v)(m=l[v])&&(g=e.call(m,m.__data__,v,l))&&("__data__"in m&&(g.__data__=m.__data__),p[v]=g,Io(p[v],t,r,v,p,At(m,r)));return new Qt(c,this._parents,t,r)}function fh(e){var t=this._name,r=this._id;typeof e!="function"&&(e=Da(e));for(var o=this._groups,s=o.length,c=[],a=[],l=0;l<s;++l)for(var d=o[l],p=d.length,m,g=0;g<p;++g)if(m=d[g]){for(var v=e.call(m,m.__data__,g,d),w,E=At(m,r),N=0,z=v.length;N<z;++N)(w=v[N])&&Io(w,t,r,N,v,E);c.push(v),a.push(m)}return new Qt(c,a,t,r)}var dh=Cr.prototype.constructor;function hh(){return new dh(this._groups,this._parents)}function ph(e,t){var r,o,s;return function(){var c=Yn(this,e),a=(this.style.removeProperty(e),Yn(this,e));return c===a?null:c===r&&a===o?s:s=t(r=c,o=a)}}function ic(e){return function(){this.style.removeProperty(e)}}function mh(e,t,r){var o,s=r+"",c;return function(){var a=Yn(this,e);return a===s?null:a===o?c:c=t(o=a,r)}}function yh(e,t,r){var o,s,c;return function(){var a=Yn(this,e),l=r(this),d=l+"";return l==null&&(d=l=(this.style.removeProperty(e),Yn(this,e))),a===d?null:a===o&&d===s?c:(s=d,c=t(o=a,l))}}function gh(e,t){var r,o,s,c="style."+t,a="end."+c,l;return function(){var d=Ht(this,e),p=d.on,m=d.value[c]==null?l||(l=ic(t)):void 0;(p!==r||s!==m)&&(o=(r=p).copy()).on(a,s=m),d.on=o}}function vh(e,t,r){var o=(e+="")=="transform"?vd:oc;return t==null?this.styleTween(e,ph(e,o)).on("end.style."+e,ic(e)):typeof t=="function"?this.styleTween(e,yh(e,o,Ui(this,"style."+e,t))).each(gh(this._id,e)):this.styleTween(e,mh(e,o,t),r).on("end.style."+e,null)}function wh(e,t,r){return function(o){this.style.setProperty(e,t.call(this,o),r)}}function xh(e,t,r){var o,s;function c(){var a=t.apply(this,arguments);return a!==s&&(o=(s=a)&&wh(e,a,r)),o}return c._value=t,c}function bh(e,t,r){var o="style."+(e+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(t==null)return this.tween(o,null);if(typeof t!="function")throw new Error;return this.tween(o,xh(e,t,r??""))}function _h(e){return function(){this.textContent=e}}function kh(e){return function(){var t=e(this);this.textContent=t??""}}function Eh(e){return this.tween("text",typeof e=="function"?kh(Ui(this,"text",e)):_h(e==null?"":e+""))}function Sh(e){return function(t){this.textContent=e.call(this,t)}}function Nh(e){var t,r;function o(){var s=e.apply(this,arguments);return s!==r&&(t=(r=s)&&Sh(s)),t}return o._value=e,o}function Ch(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Nh(e))}function Ih(){for(var e=this._name,t=this._id,r=sc(),o=this._groups,s=o.length,c=0;c<s;++c)for(var a=o[c],l=a.length,d,p=0;p<l;++p)if(d=a[p]){var m=At(d,t);Io(d,e,r,p,a,{time:m.time+m.delay+m.duration,delay:0,duration:m.duration,ease:m.ease})}return new Qt(o,this._parents,e,r)}function Th(){var e,t,r=this,o=r._id,s=r.size();return new Promise(function(c,a){var l={value:a},d={value:function(){--s===0&&c()}};r.each(function(){var p=Ht(this,o),m=p.on;m!==e&&(t=(e=m).copy(),t._.cancel.push(l),t._.interrupt.push(l),t._.end.push(d)),p.on=t}),s===0&&c()})}var Ah=0;function Qt(e,t,r,o){this._groups=e,this._parents=t,this._name=r,this._id=o}function sc(){return++Ah}var Gt=Cr.prototype;Qt.prototype={constructor:Qt,select:lh,selectAll:fh,selectChild:Gt.selectChild,selectChildren:Gt.selectChildren,filter:rh,merge:oh,selection:hh,transition:Ih,call:Gt.call,nodes:Gt.nodes,node:Gt.node,size:Gt.size,empty:Gt.empty,each:Gt.each,on:ah,attr:Fd,attrTween:Vd,style:vh,styleTween:bh,text:Eh,textTween:Ch,remove:uh,tween:jd,delay:Xd,duration:Jd,ease:eh,easeVarying:nh,end:Th,[Symbol.iterator]:Gt[Symbol.iterator]};function Mh(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Ph={time:null,delay:0,duration:250,ease:Mh};function Rh(e,t){for(var r;!(r=e.__transition)||!(r=r[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return r}function jh(e){var t,r;e instanceof Qt?(t=e._id,e=e._name):(t=sc(),(r=Ph).time=Vi(),e=e==null?null:e+"");for(var o=this._groups,s=o.length,c=0;c<s;++c)for(var a=o[c],l=a.length,d,p=0;p<l;++p)(d=a[p])&&Io(d,e,t,p,a,r||Rh(d,t));return new Qt(o,this._parents,e,t)}Cr.prototype.interrupt=Md;Cr.prototype.transition=jh;const ro=e=>()=>e;function Dh(e,{sourceEvent:t,target:r,transform:o,dispatch:s}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:s}})}function Zt(e,t,r){this.k=e,this.x=t,this.y=r}Zt.prototype={constructor:Zt,scale:function(e){return e===1?this:new Zt(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Zt(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Jt=new Zt(1,0,0);Zt.prototype;function hi(e){e.stopImmediatePropagation()}function fr(e){e.preventDefault(),e.stopImmediatePropagation()}function Oh(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function $h(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Js(){return this.__zoom||Jt}function Bh(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function zh(){return navigator.maxTouchPoints||"ontouchstart"in this}function Lh(e,t,r){var o=e.invertX(t[0][0])-r[0][0],s=e.invertX(t[1][0])-r[1][0],c=e.invertY(t[0][1])-r[0][1],a=e.invertY(t[1][1])-r[1][1];return e.translate(s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s),a>c?(c+a)/2:Math.min(0,c)||Math.max(0,a))}function ac(){var e=Oh,t=$h,r=Lh,o=Bh,s=zh,c=[0,1/0],a=[[-1/0,-1/0],[1/0,1/0]],l=250,d=kd,p=So("start","zoom","end"),m,g,v,w=500,E=150,N=0,z=10;function P(b){b.property("__zoom",Js).on("wheel.zoom",te,{passive:!1}).on("mousedown.zoom",V).on("dblclick.zoom",ie).filter(s).on("touchstart.zoom",ee).on("touchmove.zoom",se).on("touchend.zoom touchcancel.zoom",ae).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}P.transform=function(b,A,R,Z){var re=b.selection?b.selection():b;re.property("__zoom",Js),b!==re?Q(b,A,R,Z):re.interrupt().each(function(){G(this,arguments).event(Z).start().zoom(null,typeof A=="function"?A.apply(this,arguments):A).end()})},P.scaleBy=function(b,A,R,Z){P.scaleTo(b,function(){var re=this.__zoom.k,M=typeof A=="function"?A.apply(this,arguments):A;return re*M},R,Z)},P.scaleTo=function(b,A,R,Z){P.transform(b,function(){var re=t.apply(this,arguments),M=this.__zoom,q=R==null?I(re):typeof R=="function"?R.apply(this,arguments):R,oe=M.invert(q),ce=typeof A=="function"?A.apply(this,arguments):A;return r(K(H(M,ce),q,oe),re,a)},R,Z)},P.translateBy=function(b,A,R,Z){P.transform(b,function(){return r(this.__zoom.translate(typeof A=="function"?A.apply(this,arguments):A,typeof R=="function"?R.apply(this,arguments):R),t.apply(this,arguments),a)},null,Z)},P.translateTo=function(b,A,R,Z,re){P.transform(b,function(){var M=t.apply(this,arguments),q=this.__zoom,oe=Z==null?I(M):typeof Z=="function"?Z.apply(this,arguments):Z;return r(Jt.translate(oe[0],oe[1]).scale(q.k).translate(typeof A=="function"?-A.apply(this,arguments):-A,typeof R=="function"?-R.apply(this,arguments):-R),M,a)},Z,re)};function H(b,A){return A=Math.max(c[0],Math.min(c[1],A)),A===b.k?b:new Zt(A,b.x,b.y)}function K(b,A,R){var Z=A[0]-R[0]*b.k,re=A[1]-R[1]*b.k;return Z===b.x&&re===b.y?b:new Zt(b.k,Z,re)}function I(b){return[(+b[0][0]+ +b[1][0])/2,(+b[0][1]+ +b[1][1])/2]}function Q(b,A,R,Z){b.on("start.zoom",function(){G(this,arguments).event(Z).start()}).on("interrupt.zoom end.zoom",function(){G(this,arguments).event(Z).end()}).tween("zoom",function(){var re=this,M=arguments,q=G(re,M).event(Z),oe=t.apply(re,M),ce=R==null?I(oe):typeof R=="function"?R.apply(re,M):R,me=Math.max(oe[1][0]-oe[0][0],oe[1][1]-oe[0][1]),ve=re.__zoom,be=typeof A=="function"?A.apply(re,M):A,Se=d(ve.invert(ce).concat(me/ve.k),be.invert(ce).concat(me/be.k));return function(Ie){if(Ie===1)Ie=be;else{var De=Se(Ie),de=me/De[2];Ie=new Zt(de,ce[0]-De[0]*de,ce[1]-De[1]*de)}q.zoom(null,Ie)}})}function G(b,A,R){return!R&&b.__zooming||new Y(b,A)}function Y(b,A){this.that=b,this.args=A,this.active=0,this.sourceEvent=null,this.extent=t.apply(b,A),this.taps=0}Y.prototype={event:function(b){return b&&(this.sourceEvent=b),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(b,A){return this.mouse&&b!=="mouse"&&(this.mouse[1]=A.invert(this.mouse[0])),this.touch0&&b!=="touch"&&(this.touch0[1]=A.invert(this.touch0[0])),this.touch1&&b!=="touch"&&(this.touch1[1]=A.invert(this.touch1[0])),this.that.__zoom=A,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(b){var A=bt(this.that).datum();p.call(b,this.that,new Dh(b,{sourceEvent:this.sourceEvent,target:P,type:b,transform:this.that.__zoom,dispatch:p}),A)}};function te(b,...A){if(!e.apply(this,arguments))return;var R=G(this,A).event(b),Z=this.__zoom,re=Math.max(c[0],Math.min(c[1],Z.k*Math.pow(2,o.apply(this,arguments)))),M=Ct(b);if(R.wheel)(R.mouse[0][0]!==M[0]||R.mouse[0][1]!==M[1])&&(R.mouse[1]=Z.invert(R.mouse[0]=M)),clearTimeout(R.wheel);else{if(Z.k===re)return;R.mouse=[M,Z.invert(M)],ho(this),R.start()}fr(b),R.wheel=setTimeout(q,E),R.zoom("mouse",r(K(H(Z,re),R.mouse[0],R.mouse[1]),R.extent,a));function q(){R.wheel=null,R.end()}}function V(b,...A){if(v||!e.apply(this,arguments))return;var R=b.currentTarget,Z=G(this,A,!0).event(b),re=bt(b.view).on("mousemove.zoom",ce,!0).on("mouseup.zoom",me,!0),M=Ct(b,R),q=b.clientX,oe=b.clientY;Va(b.view),hi(b),Z.mouse=[M,this.__zoom.invert(M)],ho(this),Z.start();function ce(ve){if(fr(ve),!Z.moved){var be=ve.clientX-q,Se=ve.clientY-oe;Z.moved=be*be+Se*Se>N}Z.event(ve).zoom("mouse",r(K(Z.that.__zoom,Z.mouse[0]=Ct(ve,R),Z.mouse[1]),Z.extent,a))}function me(ve){re.on("mousemove.zoom mouseup.zoom",null),Ya(ve.view,Z.moved),fr(ve),Z.event(ve).end()}}function ie(b,...A){if(e.apply(this,arguments)){var R=this.__zoom,Z=Ct(b.changedTouches?b.changedTouches[0]:b,this),re=R.invert(Z),M=R.k*(b.shiftKey?.5:2),q=r(K(H(R,M),Z,re),t.apply(this,A),a);fr(b),l>0?bt(this).transition().duration(l).call(Q,q,Z,b):bt(this).call(P.transform,q,Z,b)}}function ee(b,...A){if(e.apply(this,arguments)){var R=b.touches,Z=R.length,re=G(this,A,b.changedTouches.length===Z).event(b),M,q,oe,ce;for(hi(b),q=0;q<Z;++q)oe=R[q],ce=Ct(oe,this),ce=[ce,this.__zoom.invert(ce),oe.identifier],re.touch0?!re.touch1&&re.touch0[2]!==ce[2]&&(re.touch1=ce,re.taps=0):(re.touch0=ce,M=!0,re.taps=1+!!m);m&&(m=clearTimeout(m)),M&&(re.taps<2&&(g=ce[0],m=setTimeout(function(){m=null},w)),ho(this),re.start())}}function se(b,...A){if(this.__zooming){var R=G(this,A).event(b),Z=b.changedTouches,re=Z.length,M,q,oe,ce;for(fr(b),M=0;M<re;++M)q=Z[M],oe=Ct(q,this),R.touch0&&R.touch0[2]===q.identifier?R.touch0[0]=oe:R.touch1&&R.touch1[2]===q.identifier&&(R.touch1[0]=oe);if(q=R.that.__zoom,R.touch1){var me=R.touch0[0],ve=R.touch0[1],be=R.touch1[0],Se=R.touch1[1],Ie=(Ie=be[0]-me[0])*Ie+(Ie=be[1]-me[1])*Ie,De=(De=Se[0]-ve[0])*De+(De=Se[1]-ve[1])*De;q=H(q,Math.sqrt(Ie/De)),oe=[(me[0]+be[0])/2,(me[1]+be[1])/2],ce=[(ve[0]+Se[0])/2,(ve[1]+Se[1])/2]}else if(R.touch0)oe=R.touch0[0],ce=R.touch0[1];else return;R.zoom("touch",r(K(q,oe,ce),R.extent,a))}}function ae(b,...A){if(this.__zooming){var R=G(this,A).event(b),Z=b.changedTouches,re=Z.length,M,q;for(hi(b),v&&clearTimeout(v),v=setTimeout(function(){v=null},w),M=0;M<re;++M)q=Z[M],R.touch0&&R.touch0[2]===q.identifier?delete R.touch0:R.touch1&&R.touch1[2]===q.identifier&&delete R.touch1;if(R.touch1&&!R.touch0&&(R.touch0=R.touch1,delete R.touch1),R.touch0)R.touch0[1]=this.__zoom.invert(R.touch0[0]);else if(R.end(),R.taps===2&&(q=Ct(q,this),Math.hypot(g[0]-q[0],g[1]-q[1])<z)){var oe=bt(this).on("dblclick.zoom");oe&&oe.apply(this,arguments)}}}return P.wheelDelta=function(b){return arguments.length?(o=typeof b=="function"?b:ro(+b),P):o},P.filter=function(b){return arguments.length?(e=typeof b=="function"?b:ro(!!b),P):e},P.touchable=function(b){return arguments.length?(s=typeof b=="function"?b:ro(!!b),P):s},P.extent=function(b){return arguments.length?(t=typeof b=="function"?b:ro([[+b[0][0],+b[0][1]],[+b[1][0],+b[1][1]]]),P):t},P.scaleExtent=function(b){return arguments.length?(c[0]=+b[0],c[1]=+b[1],P):[c[0],c[1]]},P.translateExtent=function(b){return arguments.length?(a[0][0]=+b[0][0],a[1][0]=+b[1][0],a[0][1]=+b[0][1],a[1][1]=+b[1][1],P):[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},P.constrain=function(b){return arguments.length?(r=b,P):r},P.duration=function(b){return arguments.length?(l=+b,P):l},P.interpolate=function(b){return arguments.length?(d=b,P):d},P.on=function(){var b=p.on.apply(p,arguments);return b===p?P:b},P.clickDistance=function(b){return arguments.length?(N=(b=+b)*b,P):Math.sqrt(N)},P.tapDistance=function(b){return arguments.length?(z=+b,P):z},P}const To=O.createContext(null),Fh=To.Provider,en={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},cc=en.error001();function ze(e,t){const r=O.useContext(To);if(r===null)throw new Error(cc);return Ra(r,e,t)}const Ue=()=>{const e=O.useContext(To);if(e===null)throw new Error(cc);return O.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},Kh=e=>e.userSelectionActive?"none":"all";function kr({position:e,children:t,className:r,style:o,...s}){const c=ze(Kh),a=`${e}`.split("-");return J.createElement("div",{className:et(["react-flow__panel",r,...a]),style:{...o,pointerEvents:c},...s},t)}function Hh({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:J.createElement(kr,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},J.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const Wh=({x:e,y:t,label:r,labelStyle:o={},labelShowBg:s=!0,labelBgStyle:c={},labelBgPadding:a=[2,4],labelBgBorderRadius:l=2,children:d,className:p,...m})=>{const g=O.useRef(null),[v,w]=O.useState({x:0,y:0,width:0,height:0}),E=et(["react-flow__edge-textwrapper",p]);return O.useEffect(()=>{if(g.current){const N=g.current.getBBox();w({x:N.x,y:N.y,width:N.width,height:N.height})}},[r]),typeof r>"u"||!r?null:J.createElement("g",{transform:`translate(${e-v.width/2} ${t-v.height/2})`,className:E,visibility:v.width?"visible":"hidden",...m},s&&J.createElement("rect",{width:v.width+2*a[0],x:-a[0],y:-a[1],height:v.height+2*a[1],className:"react-flow__edge-textbg",style:c,rx:l,ry:l}),J.createElement("text",{className:"react-flow__edge-text",y:v.height/2,dy:"0.3em",ref:g,style:o},r),d)};var qh=O.memo(Wh);const Xi=e=>({width:e.offsetWidth,height:e.offsetHeight}),Xn=(e,t=0,r=1)=>Math.min(Math.max(e,t),r),Gi=(e={x:0,y:0},t)=>({x:Xn(e.x,t[0][0],t[1][0]),y:Xn(e.y,t[0][1],t[1][1])}),Qs=(e,t,r)=>e<t?Xn(Math.abs(e-t),1,50)/50:e>r?-Xn(Math.abs(e-r),1,50)/50:0,uc=(e,t)=>{const r=Qs(e.x,35,t.width-35)*20,o=Qs(e.y,35,t.height-35)*20;return[r,o]},lc=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},fc=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Er=({x:e,y:t,width:r,height:o})=>({x:e,y:t,x2:e+r,y2:t+o}),dc=({x:e,y:t,x2:r,y2:o})=>({x:e,y:t,width:r-e,height:o-t}),ea=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),Vh=(e,t)=>dc(fc(Er(e),Er(t))),Ti=(e,t)=>{const r=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(r*o)},Yh=e=>_t(e.width)&&_t(e.height)&&_t(e.x)&&_t(e.y),_t=e=>!isNaN(e)&&isFinite(e),We=Symbol.for("internals"),hc=["Enter"," ","Escape"],Uh=(e,t)=>{},Xh=e=>"nativeEvent"in e;function Ai(e){var s,c;const t=Xh(e)?e.nativeEvent:e,r=((c=(s=t.composedPath)==null?void 0:s.call(t))==null?void 0:c[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(r==null?void 0:r.nodeName)||(r==null?void 0:r.hasAttribute("contenteditable"))||!!(r!=null&&r.closest(".nokey"))}const pc=e=>"clientX"in e,mn=(e,t)=>{var c,a;const r=pc(e),o=r?e.clientX:(c=e.touches)==null?void 0:c[0].clientX,s=r?e.clientY:(a=e.touches)==null?void 0:a[0].clientY;return{x:o-((t==null?void 0:t.left)??0),y:s-((t==null?void 0:t.top)??0)}},xo=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0},Tr=({id:e,path:t,labelX:r,labelY:o,label:s,labelStyle:c,labelShowBg:a,labelBgStyle:l,labelBgPadding:d,labelBgBorderRadius:p,style:m,markerEnd:g,markerStart:v,interactionWidth:w=20})=>J.createElement(J.Fragment,null,J.createElement("path",{id:e,style:m,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:g,markerStart:v}),w&&J.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:w,className:"react-flow__edge-interaction"}),s&&_t(r)&&_t(o)?J.createElement(qh,{x:r,y:o,label:s,labelStyle:c,labelShowBg:a,labelBgStyle:l,labelBgPadding:d,labelBgBorderRadius:p}):null);Tr.displayName="BaseEdge";function dr(e,t,r){return r===void 0?r:o=>{const s=t().edges.find(c=>c.id===e);s&&r(o,{...s})}}function mc({sourceX:e,sourceY:t,targetX:r,targetY:o}){const s=Math.abs(r-e)/2,c=r<e?r+s:r-s,a=Math.abs(o-t)/2,l=o<t?o+a:o-a;return[c,l,s,a]}function yc({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:s,sourceControlY:c,targetControlX:a,targetControlY:l}){const d=e*.125+s*.375+a*.375+r*.125,p=t*.125+c*.375+l*.375+o*.125,m=Math.abs(d-e),g=Math.abs(p-t);return[d,p,m,g]}var Sn;(function(e){e.Strict="strict",e.Loose="loose"})(Sn||(Sn={}));var bn;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(bn||(bn={}));var Sr;(function(e){e.Partial="partial",e.Full="full"})(Sr||(Sr={}));var hn;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(hn||(hn={}));var bo;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(bo||(bo={}));var _e;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(_e||(_e={}));function ta({pos:e,x1:t,y1:r,x2:o,y2:s}){return e===_e.Left||e===_e.Right?[.5*(t+o),r]:[t,.5*(r+s)]}function gc({sourceX:e,sourceY:t,sourcePosition:r=_e.Bottom,targetX:o,targetY:s,targetPosition:c=_e.Top}){const[a,l]=ta({pos:r,x1:e,y1:t,x2:o,y2:s}),[d,p]=ta({pos:c,x1:o,y1:s,x2:e,y2:t}),[m,g,v,w]=yc({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:a,sourceControlY:l,targetControlX:d,targetControlY:p});return[`M${e},${t} C${a},${l} ${d},${p} ${o},${s}`,m,g,v,w]}const Zi=O.memo(({sourceX:e,sourceY:t,targetX:r,targetY:o,sourcePosition:s=_e.Bottom,targetPosition:c=_e.Top,label:a,labelStyle:l,labelShowBg:d,labelBgStyle:p,labelBgPadding:m,labelBgBorderRadius:g,style:v,markerEnd:w,markerStart:E,interactionWidth:N})=>{const[z,P,H]=gc({sourceX:e,sourceY:t,sourcePosition:s,targetX:r,targetY:o,targetPosition:c});return J.createElement(Tr,{path:z,labelX:P,labelY:H,label:a,labelStyle:l,labelShowBg:d,labelBgStyle:p,labelBgPadding:m,labelBgBorderRadius:g,style:v,markerEnd:w,markerStart:E,interactionWidth:N})});Zi.displayName="SimpleBezierEdge";const na={[_e.Left]:{x:-1,y:0},[_e.Right]:{x:1,y:0},[_e.Top]:{x:0,y:-1},[_e.Bottom]:{x:0,y:1}},Gh=({source:e,sourcePosition:t=_e.Bottom,target:r})=>t===_e.Left||t===_e.Right?e.x<r.x?{x:1,y:0}:{x:-1,y:0}:e.y<r.y?{x:0,y:1}:{x:0,y:-1},ra=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Zh({source:e,sourcePosition:t=_e.Bottom,target:r,targetPosition:o=_e.Top,center:s,offset:c}){const a=na[t],l=na[o],d={x:e.x+a.x*c,y:e.y+a.y*c},p={x:r.x+l.x*c,y:r.y+l.y*c},m=Gh({source:d,sourcePosition:t,target:p}),g=m.x!==0?"x":"y",v=m[g];let w=[],E,N;const z={x:0,y:0},P={x:0,y:0},[H,K,I,Q]=mc({sourceX:e.x,sourceY:e.y,targetX:r.x,targetY:r.y});if(a[g]*l[g]===-1){E=s.x??H,N=s.y??K;const Y=[{x:E,y:d.y},{x:E,y:p.y}],te=[{x:d.x,y:N},{x:p.x,y:N}];a[g]===v?w=g==="x"?Y:te:w=g==="x"?te:Y}else{const Y=[{x:d.x,y:p.y}],te=[{x:p.x,y:d.y}];if(g==="x"?w=a.x===v?te:Y:w=a.y===v?Y:te,t===o){const ae=Math.abs(e[g]-r[g]);if(ae<=c){const b=Math.min(c-1,c-ae);a[g]===v?z[g]=(d[g]>e[g]?-1:1)*b:P[g]=(p[g]>r[g]?-1:1)*b}}if(t!==o){const ae=g==="x"?"y":"x",b=a[g]===l[ae],A=d[ae]>p[ae],R=d[ae]<p[ae];(a[g]===1&&(!b&&A||b&&R)||a[g]!==1&&(!b&&R||b&&A))&&(w=g==="x"?Y:te)}const V={x:d.x+z.x,y:d.y+z.y},ie={x:p.x+P.x,y:p.y+P.y},ee=Math.max(Math.abs(V.x-w[0].x),Math.abs(ie.x-w[0].x)),se=Math.max(Math.abs(V.y-w[0].y),Math.abs(ie.y-w[0].y));ee>=se?(E=(V.x+ie.x)/2,N=w[0].y):(E=w[0].x,N=(V.y+ie.y)/2)}return[[e,{x:d.x+z.x,y:d.y+z.y},...w,{x:p.x+P.x,y:p.y+P.y},r],E,N,I,Q]}function Jh(e,t,r,o){const s=Math.min(ra(e,t)/2,ra(t,r)/2,o),{x:c,y:a}=t;if(e.x===c&&c===r.x||e.y===a&&a===r.y)return`L${c} ${a}`;if(e.y===a){const p=e.x<r.x?-1:1,m=e.y<r.y?1:-1;return`L ${c+s*p},${a}Q ${c},${a} ${c},${a+s*m}`}const l=e.x<r.x?1:-1,d=e.y<r.y?-1:1;return`L ${c},${a+s*d}Q ${c},${a} ${c+s*l},${a}`}function Mi({sourceX:e,sourceY:t,sourcePosition:r=_e.Bottom,targetX:o,targetY:s,targetPosition:c=_e.Top,borderRadius:a=5,centerX:l,centerY:d,offset:p=20}){const[m,g,v,w,E]=Zh({source:{x:e,y:t},sourcePosition:r,target:{x:o,y:s},targetPosition:c,center:{x:l,y:d},offset:p});return[m.reduce((z,P,H)=>{let K="";return H>0&&H<m.length-1?K=Jh(m[H-1],P,m[H+1],a):K=`${H===0?"M":"L"}${P.x} ${P.y}`,z+=K,z},""),g,v,w,E]}const Ao=O.memo(({sourceX:e,sourceY:t,targetX:r,targetY:o,label:s,labelStyle:c,labelShowBg:a,labelBgStyle:l,labelBgPadding:d,labelBgBorderRadius:p,style:m,sourcePosition:g=_e.Bottom,targetPosition:v=_e.Top,markerEnd:w,markerStart:E,pathOptions:N,interactionWidth:z})=>{const[P,H,K]=Mi({sourceX:e,sourceY:t,sourcePosition:g,targetX:r,targetY:o,targetPosition:v,borderRadius:N==null?void 0:N.borderRadius,offset:N==null?void 0:N.offset});return J.createElement(Tr,{path:P,labelX:H,labelY:K,label:s,labelStyle:c,labelShowBg:a,labelBgStyle:l,labelBgPadding:d,labelBgBorderRadius:p,style:m,markerEnd:w,markerStart:E,interactionWidth:z})});Ao.displayName="SmoothStepEdge";const Ji=O.memo(e=>{var t;return J.createElement(Ao,{...e,pathOptions:O.useMemo(()=>{var r;return{borderRadius:0,offset:(r=e.pathOptions)==null?void 0:r.offset}},[(t=e.pathOptions)==null?void 0:t.offset])})});Ji.displayName="StepEdge";function Qh({sourceX:e,sourceY:t,targetX:r,targetY:o}){const[s,c,a,l]=mc({sourceX:e,sourceY:t,targetX:r,targetY:o});return[`M ${e},${t}L ${r},${o}`,s,c,a,l]}const Qi=O.memo(({sourceX:e,sourceY:t,targetX:r,targetY:o,label:s,labelStyle:c,labelShowBg:a,labelBgStyle:l,labelBgPadding:d,labelBgBorderRadius:p,style:m,markerEnd:g,markerStart:v,interactionWidth:w})=>{const[E,N,z]=Qh({sourceX:e,sourceY:t,targetX:r,targetY:o});return J.createElement(Tr,{path:E,labelX:N,labelY:z,label:s,labelStyle:c,labelShowBg:a,labelBgStyle:l,labelBgPadding:d,labelBgBorderRadius:p,style:m,markerEnd:g,markerStart:v,interactionWidth:w})});Qi.displayName="StraightEdge";function oo(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function oa({pos:e,x1:t,y1:r,x2:o,y2:s,c}){switch(e){case _e.Left:return[t-oo(t-o,c),r];case _e.Right:return[t+oo(o-t,c),r];case _e.Top:return[t,r-oo(r-s,c)];case _e.Bottom:return[t,r+oo(s-r,c)]}}function vc({sourceX:e,sourceY:t,sourcePosition:r=_e.Bottom,targetX:o,targetY:s,targetPosition:c=_e.Top,curvature:a=.25}){const[l,d]=oa({pos:r,x1:e,y1:t,x2:o,y2:s,c:a}),[p,m]=oa({pos:c,x1:o,y1:s,x2:e,y2:t,c:a}),[g,v,w,E]=yc({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:l,sourceControlY:d,targetControlX:p,targetControlY:m});return[`M${e},${t} C${l},${d} ${p},${m} ${o},${s}`,g,v,w,E]}const _o=O.memo(({sourceX:e,sourceY:t,targetX:r,targetY:o,sourcePosition:s=_e.Bottom,targetPosition:c=_e.Top,label:a,labelStyle:l,labelShowBg:d,labelBgStyle:p,labelBgPadding:m,labelBgBorderRadius:g,style:v,markerEnd:w,markerStart:E,pathOptions:N,interactionWidth:z})=>{const[P,H,K]=vc({sourceX:e,sourceY:t,sourcePosition:s,targetX:r,targetY:o,targetPosition:c,curvature:N==null?void 0:N.curvature});return J.createElement(Tr,{path:P,labelX:H,labelY:K,label:a,labelStyle:l,labelShowBg:d,labelBgStyle:p,labelBgPadding:m,labelBgBorderRadius:g,style:v,markerEnd:w,markerStart:E,interactionWidth:z})});_o.displayName="BezierEdge";const es=O.createContext(null),ep=es.Provider;es.Consumer;const tp=()=>O.useContext(es),np=e=>"id"in e&&"source"in e&&"target"in e,rp=({source:e,sourceHandle:t,target:r,targetHandle:o})=>`reactflow__edge-${e}${t||""}-${r}${o||""}`,Pi=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`,op=(e,t)=>t.some(r=>r.source===e.source&&r.target===e.target&&(r.sourceHandle===e.sourceHandle||!r.sourceHandle&&!e.sourceHandle)&&(r.targetHandle===e.targetHandle||!r.targetHandle&&!e.targetHandle)),ip=(e,t)=>{if(!e.source||!e.target)return t;let r;return np(e)?r={...e}:r={...e,id:rp(e)},op(r,t)?t:t.concat(r)},Ri=({x:e,y:t},[r,o,s],c,[a,l])=>{const d={x:(e-r)/s,y:(t-o)/s};return c?{x:a*Math.round(d.x/a),y:l*Math.round(d.y/l)}:d},wc=({x:e,y:t},[r,o,s])=>({x:e*s+r,y:t*s+o}),kn=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const r=(e.width??0)*t[0],o=(e.height??0)*t[1],s={x:e.position.x-r,y:e.position.y-o};return{...s,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-r,y:e.positionAbsolute.y-o}:s}},Mo=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const r=e.reduce((o,s)=>{const{x:c,y:a}=kn(s,t).positionAbsolute;return fc(o,Er({x:c,y:a,width:s.width||0,height:s.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return dc(r)},xc=(e,t,[r,o,s]=[0,0,1],c=!1,a=!1,l=[0,0])=>{const d={x:(t.x-r)/s,y:(t.y-o)/s,width:t.width/s,height:t.height/s},p=[];return e.forEach(m=>{const{width:g,height:v,selectable:w=!0,hidden:E=!1}=m;if(a&&!w||E)return!1;const{positionAbsolute:N}=kn(m,l),z={x:N.x,y:N.y,width:g||0,height:v||0},P=Ti(d,z),H=typeof g>"u"||typeof v>"u"||g===null||v===null,K=c&&P>0,I=(g||0)*(v||0);(H||K||P>=I||m.dragging)&&p.push(m)}),p},bc=(e,t)=>{const r=e.map(o=>o.id);return t.filter(o=>r.includes(o.source)||r.includes(o.target))},_c=(e,t,r,o,s,c=.1)=>{const a=t/(e.width*(1+c)),l=r/(e.height*(1+c)),d=Math.min(a,l),p=Xn(d,o,s),m=e.x+e.width/2,g=e.y+e.height/2,v=t/2-m*p,w=r/2-g*p;return{x:v,y:w,zoom:p}},wn=(e,t=0)=>e.transition().duration(t);function ia(e,t,r,o){return(t[r]||[]).reduce((s,c)=>{var a,l;return`${e.id}-${c.id}-${r}`!==o&&s.push({id:c.id||null,type:r,nodeId:e.id,x:(((a=e.positionAbsolute)==null?void 0:a.x)??0)+c.x+c.width/2,y:(((l=e.positionAbsolute)==null?void 0:l.y)??0)+c.y+c.height/2}),s},[])}function sp(e,t,r,o,s,c){const{x:a,y:l}=mn(e),p=t.elementsFromPoint(a,l).find(E=>E.classList.contains("react-flow__handle"));if(p){const E=p.getAttribute("data-nodeid");if(E){const N=ts(void 0,p),z=p.getAttribute("data-handleid"),P=c({nodeId:E,id:z,type:N});if(P){const H=s.find(K=>K.nodeId===E&&K.type===N&&K.id===z);return{handle:{id:z,type:N,nodeId:E,x:(H==null?void 0:H.x)||r.x,y:(H==null?void 0:H.y)||r.y},validHandleResult:P}}}}let m=[],g=1/0;if(s.forEach(E=>{const N=Math.sqrt((E.x-r.x)**2+(E.y-r.y)**2);if(N<=o){const z=c(E);N<=g&&(N<g?m=[{handle:E,validHandleResult:z}]:N===g&&m.push({handle:E,validHandleResult:z}),g=N)}}),!m.length)return{handle:null,validHandleResult:kc()};if(m.length===1)return m[0];const v=m.some(({validHandleResult:E})=>E.isValid),w=m.some(({handle:E})=>E.type==="target");return m.find(({handle:E,validHandleResult:N})=>w?E.type==="target":v?N.isValid:!0)||m[0]}const ap={source:null,target:null,sourceHandle:null,targetHandle:null},kc=()=>({handleDomNode:null,isValid:!1,connection:ap,endHandle:null});function Ec(e,t,r,o,s,c,a){const l=s==="target",d=a.querySelector(`.react-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),p={...kc(),handleDomNode:d};if(d){const m=ts(void 0,d),g=d.getAttribute("data-nodeid"),v=d.getAttribute("data-handleid"),w=d.classList.contains("connectable"),E=d.classList.contains("connectableend"),N={source:l?g:r,sourceHandle:l?v:o,target:l?r:g,targetHandle:l?o:v};p.connection=N,w&&E&&(t===Sn.Strict?l&&m==="source"||!l&&m==="target":g!==r||v!==o)&&(p.endHandle={nodeId:g,handleId:v,type:m},p.isValid=c(N))}return p}function cp({nodes:e,nodeId:t,handleId:r,handleType:o}){return e.reduce((s,c)=>{if(c[We]){const{handleBounds:a}=c[We];let l=[],d=[];a&&(l=ia(c,a,"source",`${t}-${r}-${o}`),d=ia(c,a,"target",`${t}-${r}-${o}`)),s.push(...l,...d)}return s},[])}function ts(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function pi(e){e==null||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function up(e,t){let r=null;return t?r="valid":e&&!t&&(r="invalid"),r}function Sc({event:e,handleId:t,nodeId:r,onConnect:o,isTarget:s,getState:c,setState:a,isValidConnection:l,edgeUpdaterType:d,onReconnectEnd:p}){const m=lc(e.target),{connectionMode:g,domNode:v,autoPanOnConnect:w,connectionRadius:E,onConnectStart:N,panBy:z,getNodes:P,cancelConnection:H}=c();let K=0,I;const{x:Q,y:G}=mn(e),Y=m==null?void 0:m.elementFromPoint(Q,G),te=ts(d,Y),V=v==null?void 0:v.getBoundingClientRect();if(!V||!te)return;let ie,ee=mn(e,V),se=!1,ae=null,b=!1,A=null;const R=cp({nodes:P(),nodeId:r,handleId:t,handleType:te}),Z=()=>{if(!w)return;const[q,oe]=uc(ee,V);z({x:q,y:oe}),K=requestAnimationFrame(Z)};a({connectionPosition:ee,connectionStatus:null,connectionNodeId:r,connectionHandleId:t,connectionHandleType:te,connectionStartHandle:{nodeId:r,handleId:t,type:te},connectionEndHandle:null}),N==null||N(e,{nodeId:r,handleId:t,handleType:te});function re(q){const{transform:oe}=c();ee=mn(q,V);const{handle:ce,validHandleResult:me}=sp(q,m,Ri(ee,oe,!1,[1,1]),E,R,ve=>Ec(ve,g,r,t,s?"target":"source",l,m));if(I=ce,se||(Z(),se=!0),A=me.handleDomNode,ae=me.connection,b=me.isValid,a({connectionPosition:I&&b?wc({x:I.x,y:I.y},oe):ee,connectionStatus:up(!!I,b),connectionEndHandle:me.endHandle}),!I&&!b&&!A)return pi(ie);ae.source!==ae.target&&A&&(pi(ie),ie=A,A.classList.add("connecting","react-flow__handle-connecting"),A.classList.toggle("valid",b),A.classList.toggle("react-flow__handle-valid",b))}function M(q){var oe,ce;(I||A)&&ae&&b&&(o==null||o(ae)),(ce=(oe=c()).onConnectEnd)==null||ce.call(oe,q),d&&(p==null||p(q)),pi(ie),H(),cancelAnimationFrame(K),se=!1,b=!1,ae=null,A=null,m.removeEventListener("mousemove",re),m.removeEventListener("mouseup",M),m.removeEventListener("touchmove",re),m.removeEventListener("touchend",M)}m.addEventListener("mousemove",re),m.addEventListener("mouseup",M),m.addEventListener("touchmove",re),m.addEventListener("touchend",M)}const sa=()=>!0,lp=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),fp=(e,t,r)=>o=>{const{connectionStartHandle:s,connectionEndHandle:c,connectionClickStartHandle:a}=o;return{connecting:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.handleId)===t&&(s==null?void 0:s.type)===r||(c==null?void 0:c.nodeId)===e&&(c==null?void 0:c.handleId)===t&&(c==null?void 0:c.type)===r,clickConnecting:(a==null?void 0:a.nodeId)===e&&(a==null?void 0:a.handleId)===t&&(a==null?void 0:a.type)===r}},Nc=O.forwardRef(({type:e="source",position:t=_e.Top,isValidConnection:r,isConnectable:o=!0,isConnectableStart:s=!0,isConnectableEnd:c=!0,id:a,onConnect:l,children:d,className:p,onMouseDown:m,onTouchStart:g,...v},w)=>{var V,ie;const E=a||null,N=e==="target",z=Ue(),P=tp(),{connectOnClick:H,noPanClassName:K}=ze(lp,Je),{connecting:I,clickConnecting:Q}=ze(fp(P,E,e),Je);P||(ie=(V=z.getState()).onError)==null||ie.call(V,"010",en.error010());const G=ee=>{const{defaultEdgeOptions:se,onConnect:ae,hasDefaultEdges:b}=z.getState(),A={...se,...ee};if(b){const{edges:R,setEdges:Z}=z.getState();Z(ip(A,R))}ae==null||ae(A),l==null||l(A)},Y=ee=>{if(!P)return;const se=pc(ee);s&&(se&&ee.button===0||!se)&&Sc({event:ee,handleId:E,nodeId:P,onConnect:G,isTarget:N,getState:z.getState,setState:z.setState,isValidConnection:r||z.getState().isValidConnection||sa}),se?m==null||m(ee):g==null||g(ee)},te=ee=>{const{onClickConnectStart:se,onClickConnectEnd:ae,connectionClickStartHandle:b,connectionMode:A,isValidConnection:R}=z.getState();if(!P||!b&&!s)return;if(!b){se==null||se(ee,{nodeId:P,handleId:E,handleType:e}),z.setState({connectionClickStartHandle:{nodeId:P,type:e,handleId:E}});return}const Z=lc(ee.target),re=r||R||sa,{connection:M,isValid:q}=Ec({nodeId:P,id:E,type:e},A,b.nodeId,b.handleId||null,b.type,re,Z);q&&G(M),ae==null||ae(ee),z.setState({connectionClickStartHandle:null})};return J.createElement("div",{"data-handleid":E,"data-nodeid":P,"data-handlepos":t,"data-id":`${P}-${E}-${e}`,className:et(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",K,p,{source:!N,target:N,connectable:o,connectablestart:s,connectableend:c,connecting:Q,connectionindicator:o&&(s&&!I||c&&I)}]),onMouseDown:Y,onTouchStart:Y,onClick:H?te:void 0,ref:w,...v},d)});Nc.displayName="Handle";var pn=O.memo(Nc);const Cc=({data:e,isConnectable:t,targetPosition:r=_e.Top,sourcePosition:o=_e.Bottom})=>J.createElement(J.Fragment,null,J.createElement(pn,{type:"target",position:r,isConnectable:t}),e==null?void 0:e.label,J.createElement(pn,{type:"source",position:o,isConnectable:t}));Cc.displayName="DefaultNode";var ji=O.memo(Cc);const Ic=({data:e,isConnectable:t,sourcePosition:r=_e.Bottom})=>J.createElement(J.Fragment,null,e==null?void 0:e.label,J.createElement(pn,{type:"source",position:r,isConnectable:t}));Ic.displayName="InputNode";var Tc=O.memo(Ic);const Ac=({data:e,isConnectable:t,targetPosition:r=_e.Top})=>J.createElement(J.Fragment,null,J.createElement(pn,{type:"target",position:r,isConnectable:t}),e==null?void 0:e.label);Ac.displayName="OutputNode";var Mc=O.memo(Ac);const ns=()=>null;ns.displayName="GroupNode";const dp=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),io=e=>e.id;function hp(e,t){return Je(e.selectedNodes.map(io),t.selectedNodes.map(io))&&Je(e.selectedEdges.map(io),t.selectedEdges.map(io))}const Pc=O.memo(({onSelectionChange:e})=>{const t=Ue(),{selectedNodes:r,selectedEdges:o}=ze(dp,hp);return O.useEffect(()=>{const s={nodes:r,edges:o};e==null||e(s),t.getState().onSelectionChange.forEach(c=>c(s))},[r,o,e]),null});Pc.displayName="SelectionListener";const pp=e=>!!e.onSelectionChange;function mp({onSelectionChange:e}){const t=ze(pp);return e||t?J.createElement(Pc,{onSelectionChange:e}):null}const yp=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function Bn(e,t){O.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function Pe(e,t,r){O.useEffect(()=>{typeof t<"u"&&r({[e]:t})},[t])}const gp=({nodes:e,edges:t,defaultNodes:r,defaultEdges:o,onConnect:s,onConnectStart:c,onConnectEnd:a,onClickConnectStart:l,onClickConnectEnd:d,nodesDraggable:p,nodesConnectable:m,nodesFocusable:g,edgesFocusable:v,edgesUpdatable:w,elevateNodesOnSelect:E,minZoom:N,maxZoom:z,nodeExtent:P,onNodesChange:H,onEdgesChange:K,elementsSelectable:I,connectionMode:Q,snapGrid:G,snapToGrid:Y,translateExtent:te,connectOnClick:V,defaultEdgeOptions:ie,fitView:ee,fitViewOptions:se,onNodesDelete:ae,onEdgesDelete:b,onNodeDrag:A,onNodeDragStart:R,onNodeDragStop:Z,onSelectionDrag:re,onSelectionDragStart:M,onSelectionDragStop:q,noPanClassName:oe,nodeOrigin:ce,rfId:me,autoPanOnConnect:ve,autoPanOnNodeDrag:be,onError:Se,connectionRadius:Ie,isValidConnection:De,nodeDragThreshold:de})=>{const{setNodes:Re,setEdges:He,setDefaultNodesAndEdges:Ee,setMinZoom:qe,setMaxZoom:Xe,setTranslateExtent:$e,setNodeExtent:at,reset:Oe}=ze(yp,Je),ke=Ue();return O.useEffect(()=>{const Qe=o==null?void 0:o.map(dt=>({...dt,...ie}));return Ee(r,Qe),()=>{Oe()}},[]),Pe("defaultEdgeOptions",ie,ke.setState),Pe("connectionMode",Q,ke.setState),Pe("onConnect",s,ke.setState),Pe("onConnectStart",c,ke.setState),Pe("onConnectEnd",a,ke.setState),Pe("onClickConnectStart",l,ke.setState),Pe("onClickConnectEnd",d,ke.setState),Pe("nodesDraggable",p,ke.setState),Pe("nodesConnectable",m,ke.setState),Pe("nodesFocusable",g,ke.setState),Pe("edgesFocusable",v,ke.setState),Pe("edgesUpdatable",w,ke.setState),Pe("elementsSelectable",I,ke.setState),Pe("elevateNodesOnSelect",E,ke.setState),Pe("snapToGrid",Y,ke.setState),Pe("snapGrid",G,ke.setState),Pe("onNodesChange",H,ke.setState),Pe("onEdgesChange",K,ke.setState),Pe("connectOnClick",V,ke.setState),Pe("fitViewOnInit",ee,ke.setState),Pe("fitViewOnInitOptions",se,ke.setState),Pe("onNodesDelete",ae,ke.setState),Pe("onEdgesDelete",b,ke.setState),Pe("onNodeDrag",A,ke.setState),Pe("onNodeDragStart",R,ke.setState),Pe("onNodeDragStop",Z,ke.setState),Pe("onSelectionDrag",re,ke.setState),Pe("onSelectionDragStart",M,ke.setState),Pe("onSelectionDragStop",q,ke.setState),Pe("noPanClassName",oe,ke.setState),Pe("nodeOrigin",ce,ke.setState),Pe("rfId",me,ke.setState),Pe("autoPanOnConnect",ve,ke.setState),Pe("autoPanOnNodeDrag",be,ke.setState),Pe("onError",Se,ke.setState),Pe("connectionRadius",Ie,ke.setState),Pe("isValidConnection",De,ke.setState),Pe("nodeDragThreshold",de,ke.setState),Bn(e,Re),Bn(t,He),Bn(N,qe),Bn(z,Xe),Bn(te,$e),Bn(P,at),null},aa={display:"none"},vp={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Rc="react-flow__node-desc",jc="react-flow__edge-desc",wp="react-flow__aria-live",xp=e=>e.ariaLiveMessage;function bp({rfId:e}){const t=ze(xp);return J.createElement("div",{id:`${wp}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:vp},t)}function _p({rfId:e,disableKeyboardA11y:t}){return J.createElement(J.Fragment,null,J.createElement("div",{id:`${Rc}-${e}`,style:aa},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),J.createElement("div",{id:`${jc}-${e}`,style:aa},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&J.createElement(bp,{rfId:e}))}var Nr=(e=null,t={actInsideInputWithModifier:!0})=>{const[r,o]=O.useState(!1),s=O.useRef(!1),c=O.useRef(new Set([])),[a,l]=O.useMemo(()=>{if(e!==null){const p=(Array.isArray(e)?e:[e]).filter(g=>typeof g=="string").map(g=>g.split("+")),m=p.reduce((g,v)=>g.concat(...v),[]);return[p,m]}return[[],[]]},[e]);return O.useEffect(()=>{const d=typeof document<"u"?document:null,p=(t==null?void 0:t.target)||d;if(e!==null){const m=w=>{if(s.current=w.ctrlKey||w.metaKey||w.shiftKey,(!s.current||s.current&&!t.actInsideInputWithModifier)&&Ai(w))return!1;const N=ua(w.code,l);c.current.add(w[N]),ca(a,c.current,!1)&&(w.preventDefault(),o(!0))},g=w=>{if((!s.current||s.current&&!t.actInsideInputWithModifier)&&Ai(w))return!1;const N=ua(w.code,l);ca(a,c.current,!0)?(o(!1),c.current.clear()):c.current.delete(w[N]),w.key==="Meta"&&c.current.clear(),s.current=!1},v=()=>{c.current.clear(),o(!1)};return p==null||p.addEventListener("keydown",m),p==null||p.addEventListener("keyup",g),window.addEventListener("blur",v),()=>{p==null||p.removeEventListener("keydown",m),p==null||p.removeEventListener("keyup",g),window.removeEventListener("blur",v)}}},[e,o]),r};function ca(e,t,r){return e.filter(o=>r||o.length===t.size).some(o=>o.every(s=>t.has(s)))}function ua(e,t){return t.includes(e)?"code":"key"}function Dc(e,t,r,o){var l,d;const s=e.parentNode||e.parentId;if(!s)return r;const c=t.get(s),a=kn(c,o);return Dc(c,t,{x:(r.x??0)+a.x,y:(r.y??0)+a.y,z:(((l=c[We])==null?void 0:l.z)??0)>(r.z??0)?((d=c[We])==null?void 0:d.z)??0:r.z??0},o)}function Oc(e,t,r){e.forEach(o=>{var c;const s=o.parentNode||o.parentId;if(s&&!e.has(s))throw new Error(`Parent node ${s} not found`);if(s||r!=null&&r[o.id]){const{x:a,y:l,z:d}=Dc(o,e,{...o.position,z:((c=o[We])==null?void 0:c.z)??0},t);o.positionAbsolute={x:a,y:l},o[We].z=d,r!=null&&r[o.id]&&(o[We].isParent=!0)}})}function mi(e,t,r,o){const s=new Map,c={},a=o?1e3:0;return e.forEach(l=>{var w;const d=(_t(l.zIndex)?l.zIndex:0)+(l.selected?a:0),p=t.get(l.id),m={...l,positionAbsolute:{x:l.position.x,y:l.position.y}},g=l.parentNode||l.parentId;g&&(c[g]=!0);const v=(p==null?void 0:p.type)&&(p==null?void 0:p.type)!==l.type;Object.defineProperty(m,We,{enumerable:!1,value:{handleBounds:v||(w=p==null?void 0:p[We])==null?void 0:w.handleBounds,z:d}}),s.set(l.id,m)}),Oc(s,r,c),s}function $c(e,t={}){const{getNodes:r,width:o,height:s,minZoom:c,maxZoom:a,d3Zoom:l,d3Selection:d,fitViewOnInitDone:p,fitViewOnInit:m,nodeOrigin:g}=e(),v=t.initial&&!p&&m;if(l&&d&&(v||!t.initial)){const E=r().filter(z=>{var H;const P=t.includeHiddenNodes?z.width&&z.height:!z.hidden;return(H=t.nodes)!=null&&H.length?P&&t.nodes.some(K=>K.id===z.id):P}),N=E.every(z=>z.width&&z.height);if(E.length>0&&N){const z=Mo(E,g),{x:P,y:H,zoom:K}=_c(z,o,s,t.minZoom??c,t.maxZoom??a,t.padding??.1),I=Jt.translate(P,H).scale(K);return typeof t.duration=="number"&&t.duration>0?l.transform(wn(d,t.duration),I):l.transform(d,I),!0}}return!1}function kp(e,t){return e.forEach(r=>{const o=t.get(r.id);o&&t.set(o.id,{...o,[We]:o[We],selected:r.selected})}),new Map(t)}function Ep(e,t){return t.map(r=>{const o=e.find(s=>s.id===r.id);return o&&(r.selected=o.selected),r})}function so({changedNodes:e,changedEdges:t,get:r,set:o}){const{nodeInternals:s,edges:c,onNodesChange:a,onEdgesChange:l,hasDefaultNodes:d,hasDefaultEdges:p}=r();e!=null&&e.length&&(d&&o({nodeInternals:kp(e,s)}),a==null||a(e)),t!=null&&t.length&&(p&&o({edges:Ep(t,c)}),l==null||l(t))}const zn=()=>{},Sp={zoomIn:zn,zoomOut:zn,zoomTo:zn,getZoom:()=>1,setViewport:zn,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:zn,fitBounds:zn,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},Np=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),Cp=()=>{const e=Ue(),{d3Zoom:t,d3Selection:r}=ze(Np,Je);return O.useMemo(()=>r&&t?{zoomIn:s=>t.scaleBy(wn(r,s==null?void 0:s.duration),1.2),zoomOut:s=>t.scaleBy(wn(r,s==null?void 0:s.duration),1/1.2),zoomTo:(s,c)=>t.scaleTo(wn(r,c==null?void 0:c.duration),s),getZoom:()=>e.getState().transform[2],setViewport:(s,c)=>{const[a,l,d]=e.getState().transform,p=Jt.translate(s.x??a,s.y??l).scale(s.zoom??d);t.transform(wn(r,c==null?void 0:c.duration),p)},getViewport:()=>{const[s,c,a]=e.getState().transform;return{x:s,y:c,zoom:a}},fitView:s=>$c(e.getState,s),setCenter:(s,c,a)=>{const{width:l,height:d,maxZoom:p}=e.getState(),m=typeof(a==null?void 0:a.zoom)<"u"?a.zoom:p,g=l/2-s*m,v=d/2-c*m,w=Jt.translate(g,v).scale(m);t.transform(wn(r,a==null?void 0:a.duration),w)},fitBounds:(s,c)=>{const{width:a,height:l,minZoom:d,maxZoom:p}=e.getState(),{x:m,y:g,zoom:v}=_c(s,a,l,d,p,(c==null?void 0:c.padding)??.1),w=Jt.translate(m,g).scale(v);t.transform(wn(r,c==null?void 0:c.duration),w)},project:s=>{const{transform:c,snapToGrid:a,snapGrid:l}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),Ri(s,c,a,l)},screenToFlowPosition:s=>{const{transform:c,snapToGrid:a,snapGrid:l,domNode:d}=e.getState();if(!d)return s;const{x:p,y:m}=d.getBoundingClientRect(),g={x:s.x-p,y:s.y-m};return Ri(g,c,a,l)},flowToScreenPosition:s=>{const{transform:c,domNode:a}=e.getState();if(!a)return s;const{x:l,y:d}=a.getBoundingClientRect(),p=wc(s,c);return{x:p.x+l,y:p.y+d}},viewportInitialized:!0}:Sp,[t,r])};function rs(){const e=Cp(),t=Ue(),r=O.useCallback(()=>t.getState().getNodes().map(N=>({...N})),[]),o=O.useCallback(N=>t.getState().nodeInternals.get(N),[]),s=O.useCallback(()=>{const{edges:N=[]}=t.getState();return N.map(z=>({...z}))},[]),c=O.useCallback(N=>{const{edges:z=[]}=t.getState();return z.find(P=>P.id===N)},[]),a=O.useCallback(N=>{const{getNodes:z,setNodes:P,hasDefaultNodes:H,onNodesChange:K}=t.getState(),I=z(),Q=typeof N=="function"?N(I):N;if(H)P(Q);else if(K){const G=Q.length===0?I.map(Y=>({type:"remove",id:Y.id})):Q.map(Y=>({item:Y,type:"reset"}));K(G)}},[]),l=O.useCallback(N=>{const{edges:z=[],setEdges:P,hasDefaultEdges:H,onEdgesChange:K}=t.getState(),I=typeof N=="function"?N(z):N;if(H)P(I);else if(K){const Q=I.length===0?z.map(G=>({type:"remove",id:G.id})):I.map(G=>({item:G,type:"reset"}));K(Q)}},[]),d=O.useCallback(N=>{const z=Array.isArray(N)?N:[N],{getNodes:P,setNodes:H,hasDefaultNodes:K,onNodesChange:I}=t.getState();if(K){const G=[...P(),...z];H(G)}else if(I){const Q=z.map(G=>({item:G,type:"add"}));I(Q)}},[]),p=O.useCallback(N=>{const z=Array.isArray(N)?N:[N],{edges:P=[],setEdges:H,hasDefaultEdges:K,onEdgesChange:I}=t.getState();if(K)H([...P,...z]);else if(I){const Q=z.map(G=>({item:G,type:"add"}));I(Q)}},[]),m=O.useCallback(()=>{const{getNodes:N,edges:z=[],transform:P}=t.getState(),[H,K,I]=P;return{nodes:N().map(Q=>({...Q})),edges:z.map(Q=>({...Q})),viewport:{x:H,y:K,zoom:I}}},[]),g=O.useCallback(({nodes:N,edges:z})=>{const{nodeInternals:P,getNodes:H,edges:K,hasDefaultNodes:I,hasDefaultEdges:Q,onNodesDelete:G,onEdgesDelete:Y,onNodesChange:te,onEdgesChange:V}=t.getState(),ie=(N||[]).map(A=>A.id),ee=(z||[]).map(A=>A.id),se=H().reduce((A,R)=>{const Z=R.parentNode||R.parentId,re=!ie.includes(R.id)&&Z&&A.find(q=>q.id===Z);return(typeof R.deletable=="boolean"?R.deletable:!0)&&(ie.includes(R.id)||re)&&A.push(R),A},[]),ae=K.filter(A=>typeof A.deletable=="boolean"?A.deletable:!0),b=ae.filter(A=>ee.includes(A.id));if(se||b){const A=bc(se,ae),R=[...b,...A],Z=R.reduce((re,M)=>(re.includes(M.id)||re.push(M.id),re),[]);if((Q||I)&&(Q&&t.setState({edges:K.filter(re=>!Z.includes(re.id))}),I&&(se.forEach(re=>{P.delete(re.id)}),t.setState({nodeInternals:new Map(P)}))),Z.length>0&&(Y==null||Y(R),V&&V(Z.map(re=>({id:re,type:"remove"})))),se.length>0&&(G==null||G(se),te)){const re=se.map(M=>({id:M.id,type:"remove"}));te(re)}}},[]),v=O.useCallback(N=>{const z=Yh(N),P=z?null:t.getState().nodeInternals.get(N.id);return!z&&!P?[null,null,z]:[z?N:ea(P),P,z]},[]),w=O.useCallback((N,z=!0,P)=>{const[H,K,I]=v(N);return H?(P||t.getState().getNodes()).filter(Q=>{if(!I&&(Q.id===K.id||!Q.positionAbsolute))return!1;const G=ea(Q),Y=Ti(G,H);return z&&Y>0||Y>=H.width*H.height}):[]},[]),E=O.useCallback((N,z,P=!0)=>{const[H]=v(N);if(!H)return!1;const K=Ti(H,z);return P&&K>0||K>=H.width*H.height},[]);return O.useMemo(()=>({...e,getNodes:r,getNode:o,getEdges:s,getEdge:c,setNodes:a,setEdges:l,addNodes:d,addEdges:p,toObject:m,deleteElements:g,getIntersectingNodes:w,isNodeIntersecting:E}),[e,r,o,s,c,a,l,d,p,m,g,w,E])}const Ip={actInsideInputWithModifier:!1};var Tp=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const r=Ue(),{deleteElements:o}=rs(),s=Nr(e,Ip),c=Nr(t);O.useEffect(()=>{if(s){const{edges:a,getNodes:l}=r.getState(),d=l().filter(m=>m.selected),p=a.filter(m=>m.selected);o({nodes:d,edges:p}),r.setState({nodesSelectionActive:!1})}},[s]),O.useEffect(()=>{r.setState({multiSelectionActive:c})},[c])};function Ap(e){const t=Ue();O.useEffect(()=>{let r;const o=()=>{var c,a;if(!e.current)return;const s=Xi(e.current);(s.height===0||s.width===0)&&((a=(c=t.getState()).onError)==null||a.call(c,"004",en.error004())),t.setState({width:s.width||500,height:s.height||500})};return o(),window.addEventListener("resize",o),e.current&&(r=new ResizeObserver(()=>o()),r.observe(e.current)),()=>{window.removeEventListener("resize",o),r&&e.current&&r.unobserve(e.current)}},[])}const os={position:"absolute",width:"100%",height:"100%",top:0,left:0},Mp=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,ao=e=>({x:e.x,y:e.y,zoom:e.k}),Ln=(e,t)=>e.target.closest(`.${t}`),la=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),fa=e=>{const t=e.ctrlKey&&xo()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},Pp=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),Rp=({onMove:e,onMoveStart:t,onMoveEnd:r,onPaneContextMenu:o,zoomOnScroll:s=!0,zoomOnPinch:c=!0,panOnScroll:a=!1,panOnScrollSpeed:l=.5,panOnScrollMode:d=bn.Free,zoomOnDoubleClick:p=!0,elementsSelectable:m,panOnDrag:g=!0,defaultViewport:v,translateExtent:w,minZoom:E,maxZoom:N,zoomActivationKeyCode:z,preventScrolling:P=!0,children:H,noWheelClassName:K,noPanClassName:I})=>{const Q=O.useRef(),G=Ue(),Y=O.useRef(!1),te=O.useRef(!1),V=O.useRef(null),ie=O.useRef({x:0,y:0,zoom:0}),{d3Zoom:ee,d3Selection:se,d3ZoomHandler:ae,userSelectionActive:b}=ze(Pp,Je),A=Nr(z),R=O.useRef(0),Z=O.useRef(!1),re=O.useRef();return Ap(V),O.useEffect(()=>{if(V.current){const M=V.current.getBoundingClientRect(),q=ac().scaleExtent([E,N]).translateExtent(w),oe=bt(V.current).call(q),ce=Jt.translate(v.x,v.y).scale(Xn(v.zoom,E,N)),me=[[0,0],[M.width,M.height]],ve=q.constrain()(ce,me,w);q.transform(oe,ve),q.wheelDelta(fa),G.setState({d3Zoom:q,d3Selection:oe,d3ZoomHandler:oe.on("wheel.zoom"),transform:[ve.x,ve.y,ve.k],domNode:V.current.closest(".react-flow")})}},[]),O.useEffect(()=>{se&&ee&&(a&&!A&&!b?se.on("wheel.zoom",M=>{if(Ln(M,K))return!1;M.preventDefault(),M.stopImmediatePropagation();const q=se.property("__zoom").k||1;if(M.ctrlKey&&c){const De=Ct(M),de=fa(M),Re=q*Math.pow(2,de);ee.scaleTo(se,Re,De,M);return}const oe=M.deltaMode===1?20:1;let ce=d===bn.Vertical?0:M.deltaX*oe,me=d===bn.Horizontal?0:M.deltaY*oe;!xo()&&M.shiftKey&&d!==bn.Vertical&&(ce=M.deltaY*oe,me=0),ee.translateBy(se,-(ce/q)*l,-(me/q)*l,{internal:!0});const ve=ao(se.property("__zoom")),{onViewportChangeStart:be,onViewportChange:Se,onViewportChangeEnd:Ie}=G.getState();clearTimeout(re.current),Z.current||(Z.current=!0,t==null||t(M,ve),be==null||be(ve)),Z.current&&(e==null||e(M,ve),Se==null||Se(ve),re.current=setTimeout(()=>{r==null||r(M,ve),Ie==null||Ie(ve),Z.current=!1},150))},{passive:!1}):typeof ae<"u"&&se.on("wheel.zoom",function(M,q){if(!P&&M.type==="wheel"&&!M.ctrlKey||Ln(M,K))return null;M.preventDefault(),ae.call(this,M,q)},{passive:!1}))},[b,a,d,se,ee,ae,A,c,P,K,t,e,r]),O.useEffect(()=>{ee&&ee.on("start",M=>{var ce,me;if(!M.sourceEvent||M.sourceEvent.internal)return null;R.current=(ce=M.sourceEvent)==null?void 0:ce.button;const{onViewportChangeStart:q}=G.getState(),oe=ao(M.transform);Y.current=!0,ie.current=oe,((me=M.sourceEvent)==null?void 0:me.type)==="mousedown"&&G.setState({paneDragging:!0}),q==null||q(oe),t==null||t(M.sourceEvent,oe)})},[ee,t]),O.useEffect(()=>{ee&&(b&&!Y.current?ee.on("zoom",null):b||ee.on("zoom",M=>{var oe;const{onViewportChange:q}=G.getState();if(G.setState({transform:[M.transform.x,M.transform.y,M.transform.k]}),te.current=!!(o&&la(g,R.current??0)),(e||q)&&!((oe=M.sourceEvent)!=null&&oe.internal)){const ce=ao(M.transform);q==null||q(ce),e==null||e(M.sourceEvent,ce)}}))},[b,ee,e,g,o]),O.useEffect(()=>{ee&&ee.on("end",M=>{if(!M.sourceEvent||M.sourceEvent.internal)return null;const{onViewportChangeEnd:q}=G.getState();if(Y.current=!1,G.setState({paneDragging:!1}),o&&la(g,R.current??0)&&!te.current&&o(M.sourceEvent),te.current=!1,(r||q)&&Mp(ie.current,M.transform)){const oe=ao(M.transform);ie.current=oe,clearTimeout(Q.current),Q.current=setTimeout(()=>{q==null||q(oe),r==null||r(M.sourceEvent,oe)},a?150:0)}})},[ee,a,g,r,o]),O.useEffect(()=>{ee&&ee.filter(M=>{const q=A||s,oe=c&&M.ctrlKey;if((g===!0||Array.isArray(g)&&g.includes(1))&&M.button===1&&M.type==="mousedown"&&(Ln(M,"react-flow__node")||Ln(M,"react-flow__edge")))return!0;if(!g&&!q&&!a&&!p&&!c||b||!p&&M.type==="dblclick"||Ln(M,K)&&M.type==="wheel"||Ln(M,I)&&(M.type!=="wheel"||a&&M.type==="wheel"&&!A)||!c&&M.ctrlKey&&M.type==="wheel"||!q&&!a&&!oe&&M.type==="wheel"||!g&&(M.type==="mousedown"||M.type==="touchstart")||Array.isArray(g)&&!g.includes(M.button)&&M.type==="mousedown")return!1;const ce=Array.isArray(g)&&g.includes(M.button)||!M.button||M.button<=1;return(!M.ctrlKey||M.type==="wheel")&&ce})},[b,ee,s,c,a,p,g,m,A]),J.createElement("div",{className:"react-flow__renderer",ref:V,style:os},H)},jp=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Dp(){const{userSelectionActive:e,userSelectionRect:t}=ze(jp,Je);return e&&t?J.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function da(e,t){const r=t.parentNode||t.parentId,o=e.find(s=>s.id===r);if(o){const s=t.position.x+t.width-o.width,c=t.position.y+t.height-o.height;if(s>0||c>0||t.position.x<0||t.position.y<0){if(o.style={...o.style},o.style.width=o.style.width??o.width,o.style.height=o.style.height??o.height,s>0&&(o.style.width+=s),c>0&&(o.style.height+=c),t.position.x<0){const a=Math.abs(t.position.x);o.position.x=o.position.x-a,o.style.width+=a,t.position.x=0}if(t.position.y<0){const a=Math.abs(t.position.y);o.position.y=o.position.y-a,o.style.height+=a,t.position.y=0}o.width=o.style.width,o.height=o.style.height}}}function Op(e,t){if(e.some(o=>o.type==="reset"))return e.filter(o=>o.type==="reset").map(o=>o.item);const r=e.filter(o=>o.type==="add").map(o=>o.item);return t.reduce((o,s)=>{const c=e.filter(l=>l.id===s.id);if(c.length===0)return o.push(s),o;const a={...s};for(const l of c)if(l)switch(l.type){case"select":{a.selected=l.selected;break}case"position":{typeof l.position<"u"&&(a.position=l.position),typeof l.positionAbsolute<"u"&&(a.positionAbsolute=l.positionAbsolute),typeof l.dragging<"u"&&(a.dragging=l.dragging),a.expandParent&&da(o,a);break}case"dimensions":{typeof l.dimensions<"u"&&(a.width=l.dimensions.width,a.height=l.dimensions.height),typeof l.updateStyle<"u"&&(a.style={...a.style||{},...l.dimensions}),typeof l.resizing=="boolean"&&(a.resizing=l.resizing),a.expandParent&&da(o,a);break}case"remove":return o}return o.push(a),o},r)}function Bc(e,t){return Op(e,t)}const dn=(e,t)=>({id:e,type:"select",selected:t});function Kn(e,t){return e.reduce((r,o)=>{const s=t.includes(o.id);return!o.selected&&s?(o.selected=!0,r.push(dn(o.id,!0))):o.selected&&!s&&(o.selected=!1,r.push(dn(o.id,!1))),r},[])}const yi=(e,t)=>r=>{r.target===t.current&&(e==null||e(r))},$p=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),zc=O.memo(({isSelecting:e,selectionMode:t=Sr.Full,panOnDrag:r,onSelectionStart:o,onSelectionEnd:s,onPaneClick:c,onPaneContextMenu:a,onPaneScroll:l,onPaneMouseEnter:d,onPaneMouseMove:p,onPaneMouseLeave:m,children:g})=>{const v=O.useRef(null),w=Ue(),E=O.useRef(0),N=O.useRef(0),z=O.useRef(),{userSelectionActive:P,elementsSelectable:H,dragging:K}=ze($p,Je),I=()=>{w.setState({userSelectionActive:!1,userSelectionRect:null}),E.current=0,N.current=0},Q=ae=>{c==null||c(ae),w.getState().resetSelectedElements(),w.setState({nodesSelectionActive:!1})},G=ae=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){ae.preventDefault();return}a==null||a(ae)},Y=l?ae=>l(ae):void 0,te=ae=>{const{resetSelectedElements:b,domNode:A}=w.getState();if(z.current=A==null?void 0:A.getBoundingClientRect(),!H||!e||ae.button!==0||ae.target!==v.current||!z.current)return;const{x:R,y:Z}=mn(ae,z.current);b(),w.setState({userSelectionRect:{width:0,height:0,startX:R,startY:Z,x:R,y:Z}}),o==null||o(ae)},V=ae=>{const{userSelectionRect:b,nodeInternals:A,edges:R,transform:Z,onNodesChange:re,onEdgesChange:M,nodeOrigin:q,getNodes:oe}=w.getState();if(!e||!z.current||!b)return;w.setState({userSelectionActive:!0,nodesSelectionActive:!1});const ce=mn(ae,z.current),me=b.startX??0,ve=b.startY??0,be={...b,x:ce.x<me?ce.x:me,y:ce.y<ve?ce.y:ve,width:Math.abs(ce.x-me),height:Math.abs(ce.y-ve)},Se=oe(),Ie=xc(A,be,Z,t===Sr.Partial,!0,q),De=bc(Ie,R).map(Re=>Re.id),de=Ie.map(Re=>Re.id);if(E.current!==de.length){E.current=de.length;const Re=Kn(Se,de);Re.length&&(re==null||re(Re))}if(N.current!==De.length){N.current=De.length;const Re=Kn(R,De);Re.length&&(M==null||M(Re))}w.setState({userSelectionRect:be})},ie=ae=>{if(ae.button!==0)return;const{userSelectionRect:b}=w.getState();!P&&b&&ae.target===v.current&&(Q==null||Q(ae)),w.setState({nodesSelectionActive:E.current>0}),I(),s==null||s(ae)},ee=ae=>{P&&(w.setState({nodesSelectionActive:E.current>0}),s==null||s(ae)),I()},se=H&&(e||P);return J.createElement("div",{className:et(["react-flow__pane",{dragging:K,selection:e}]),onClick:se?void 0:yi(Q,v),onContextMenu:yi(G,v),onWheel:yi(Y,v),onMouseEnter:se?void 0:d,onMouseDown:se?te:void 0,onMouseMove:se?V:p,onMouseUp:se?ie:void 0,onMouseLeave:se?ee:m,ref:v,style:os},g,J.createElement(Dp,null))});zc.displayName="Pane";function Lc(e,t){const r=e.parentNode||e.parentId;if(!r)return!1;const o=t.get(r);return o?o.selected?!0:Lc(o,t):!1}function ha(e,t,r){let o=e;do{if(o!=null&&o.matches(t))return!0;if(o===r.current)return!1;o=o.parentElement}while(o);return!1}function Bp(e,t,r,o){return Array.from(e.values()).filter(s=>(s.selected||s.id===o)&&(!s.parentNode||s.parentId||!Lc(s,e))&&(s.draggable||t&&typeof s.draggable>"u")).map(s=>{var c,a;return{id:s.id,position:s.position||{x:0,y:0},positionAbsolute:s.positionAbsolute||{x:0,y:0},distance:{x:r.x-(((c=s.positionAbsolute)==null?void 0:c.x)??0),y:r.y-(((a=s.positionAbsolute)==null?void 0:a.y)??0)},delta:{x:0,y:0},extent:s.extent,parentNode:s.parentNode||s.parentId,parentId:s.parentNode||s.parentId,width:s.width,height:s.height,expandParent:s.expandParent}})}function zp(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function Fc(e,t,r,o,s=[0,0],c){const a=zp(e,e.extent||o);let l=a;const d=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(d&&e.width&&e.height){const g=r.get(d),{x:v,y:w}=kn(g,s).positionAbsolute;l=g&&_t(v)&&_t(w)&&_t(g.width)&&_t(g.height)?[[v+e.width*s[0],w+e.height*s[1]],[v+g.width-e.width+e.width*s[0],w+g.height-e.height+e.height*s[1]]]:l}else c==null||c("005",en.error005()),l=a;else if(e.extent&&d&&e.extent!=="parent"){const g=r.get(d),{x:v,y:w}=kn(g,s).positionAbsolute;l=[[e.extent[0][0]+v,e.extent[0][1]+w],[e.extent[1][0]+v,e.extent[1][1]+w]]}let p={x:0,y:0};if(d){const g=r.get(d);p=kn(g,s).positionAbsolute}const m=l&&l!=="parent"?Gi(t,l):t;return{position:{x:m.x-p.x,y:m.y-p.y},positionAbsolute:m}}function gi({nodeId:e,dragItems:t,nodeInternals:r}){const o=t.map(s=>({...r.get(s.id),position:s.position,positionAbsolute:s.positionAbsolute}));return[e?o.find(s=>s.id===e):o[0],o]}const pa=(e,t,r,o)=>{const s=t.querySelectorAll(e);if(!s||!s.length)return null;const c=Array.from(s),a=t.getBoundingClientRect(),l={x:a.width*o[0],y:a.height*o[1]};return c.map(d=>{const p=d.getBoundingClientRect();return{id:d.getAttribute("data-handleid"),position:d.getAttribute("data-handlepos"),x:(p.left-a.left-l.x)/r,y:(p.top-a.top-l.y)/r,...Xi(d)}})};function hr(e,t,r){return r===void 0?r:o=>{const s=t().nodeInternals.get(e);s&&r(o,{...s})}}function Di({id:e,store:t,unselect:r=!1,nodeRef:o}){const{addSelectedNodes:s,unselectNodesAndEdges:c,multiSelectionActive:a,nodeInternals:l,onError:d}=t.getState(),p=l.get(e);if(!p){d==null||d("012",en.error012(e));return}t.setState({nodesSelectionActive:!1}),p.selected?(r||p.selected&&a)&&(c({nodes:[p],edges:[]}),requestAnimationFrame(()=>{var m;return(m=o==null?void 0:o.current)==null?void 0:m.blur()})):s([e])}function Lp(){const e=Ue();return O.useCallback(({sourceEvent:r})=>{const{transform:o,snapGrid:s,snapToGrid:c}=e.getState(),a=r.touches?r.touches[0].clientX:r.clientX,l=r.touches?r.touches[0].clientY:r.clientY,d={x:(a-o[0])/o[2],y:(l-o[1])/o[2]};return{xSnapped:c?s[0]*Math.round(d.x/s[0]):d.x,ySnapped:c?s[1]*Math.round(d.y/s[1]):d.y,...d}},[])}function vi(e){return(t,r,o)=>e==null?void 0:e(t,o)}function Kc({nodeRef:e,disabled:t=!1,noDragClassName:r,handleSelector:o,nodeId:s,isSelectable:c,selectNodesOnDrag:a}){const l=Ue(),[d,p]=O.useState(!1),m=O.useRef([]),g=O.useRef({x:null,y:null}),v=O.useRef(0),w=O.useRef(null),E=O.useRef({x:0,y:0}),N=O.useRef(null),z=O.useRef(!1),P=O.useRef(!1),H=O.useRef(!1),K=Lp();return O.useEffect(()=>{if(e!=null&&e.current){const I=bt(e.current),Q=({x:te,y:V})=>{const{nodeInternals:ie,onNodeDrag:ee,onSelectionDrag:se,updateNodePositions:ae,nodeExtent:b,snapGrid:A,snapToGrid:R,nodeOrigin:Z,onError:re}=l.getState();g.current={x:te,y:V};let M=!1,q={x:0,y:0,x2:0,y2:0};if(m.current.length>1&&b){const ce=Mo(m.current,Z);q=Er(ce)}if(m.current=m.current.map(ce=>{const me={x:te-ce.distance.x,y:V-ce.distance.y};R&&(me.x=A[0]*Math.round(me.x/A[0]),me.y=A[1]*Math.round(me.y/A[1]));const ve=[[b[0][0],b[0][1]],[b[1][0],b[1][1]]];m.current.length>1&&b&&!ce.extent&&(ve[0][0]=ce.positionAbsolute.x-q.x+b[0][0],ve[1][0]=ce.positionAbsolute.x+(ce.width??0)-q.x2+b[1][0],ve[0][1]=ce.positionAbsolute.y-q.y+b[0][1],ve[1][1]=ce.positionAbsolute.y+(ce.height??0)-q.y2+b[1][1]);const be=Fc(ce,me,ie,ve,Z,re);return M=M||ce.position.x!==be.position.x||ce.position.y!==be.position.y,ce.position=be.position,ce.positionAbsolute=be.positionAbsolute,ce}),!M)return;ae(m.current,!0,!0),p(!0);const oe=s?ee:vi(se);if(oe&&N.current){const[ce,me]=gi({nodeId:s,dragItems:m.current,nodeInternals:ie});oe(N.current,ce,me)}},G=()=>{if(!w.current)return;const[te,V]=uc(E.current,w.current);if(te!==0||V!==0){const{transform:ie,panBy:ee}=l.getState();g.current.x=(g.current.x??0)-te/ie[2],g.current.y=(g.current.y??0)-V/ie[2],ee({x:te,y:V})&&Q(g.current)}v.current=requestAnimationFrame(G)},Y=te=>{var Z;const{nodeInternals:V,multiSelectionActive:ie,nodesDraggable:ee,unselectNodesAndEdges:se,onNodeDragStart:ae,onSelectionDragStart:b}=l.getState();P.current=!0;const A=s?ae:vi(b);(!a||!c)&&!ie&&s&&((Z=V.get(s))!=null&&Z.selected||se()),s&&c&&a&&Di({id:s,store:l,nodeRef:e});const R=K(te);if(g.current=R,m.current=Bp(V,ee,R,s),A&&m.current){const[re,M]=gi({nodeId:s,dragItems:m.current,nodeInternals:V});A(te.sourceEvent,re,M)}};if(t)I.on(".drag",null);else{const te=Zf().on("start",V=>{const{domNode:ie,nodeDragThreshold:ee}=l.getState();ee===0&&Y(V),H.current=!1;const se=K(V);g.current=se,w.current=(ie==null?void 0:ie.getBoundingClientRect())||null,E.current=mn(V.sourceEvent,w.current)}).on("drag",V=>{var ae,b;const ie=K(V),{autoPanOnNodeDrag:ee,nodeDragThreshold:se}=l.getState();if(V.sourceEvent.type==="touchmove"&&V.sourceEvent.touches.length>1&&(H.current=!0),!H.current){if(!z.current&&P.current&&ee&&(z.current=!0,G()),!P.current){const A=ie.xSnapped-(((ae=g==null?void 0:g.current)==null?void 0:ae.x)??0),R=ie.ySnapped-(((b=g==null?void 0:g.current)==null?void 0:b.y)??0);Math.sqrt(A*A+R*R)>se&&Y(V)}(g.current.x!==ie.xSnapped||g.current.y!==ie.ySnapped)&&m.current&&P.current&&(N.current=V.sourceEvent,E.current=mn(V.sourceEvent,w.current),Q(ie))}}).on("end",V=>{if(!(!P.current||H.current)&&(p(!1),z.current=!1,P.current=!1,cancelAnimationFrame(v.current),m.current)){const{updateNodePositions:ie,nodeInternals:ee,onNodeDragStop:se,onSelectionDragStop:ae}=l.getState(),b=s?se:vi(ae);if(ie(m.current,!1,!1),b){const[A,R]=gi({nodeId:s,dragItems:m.current,nodeInternals:ee});b(V.sourceEvent,A,R)}}}).filter(V=>{const ie=V.target;return!V.button&&(!r||!ha(ie,`.${r}`,e))&&(!o||ha(ie,o,e))});return I.call(te),()=>{I.on(".drag",null)}}}},[e,t,r,o,c,l,s,a,K]),d}function Hc(){const e=Ue();return O.useCallback(r=>{const{nodeInternals:o,nodeExtent:s,updateNodePositions:c,getNodes:a,snapToGrid:l,snapGrid:d,onError:p,nodesDraggable:m}=e.getState(),g=a().filter(H=>H.selected&&(H.draggable||m&&typeof H.draggable>"u")),v=l?d[0]:5,w=l?d[1]:5,E=r.isShiftPressed?4:1,N=r.x*v*E,z=r.y*w*E,P=g.map(H=>{if(H.positionAbsolute){const K={x:H.positionAbsolute.x+N,y:H.positionAbsolute.y+z};l&&(K.x=d[0]*Math.round(K.x/d[0]),K.y=d[1]*Math.round(K.y/d[1]));const{positionAbsolute:I,position:Q}=Fc(H,K,o,s,void 0,p);H.position=Q,H.positionAbsolute=I}return H});c(P,!0,!1)},[])}const qn={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var pr=e=>{const t=({id:r,type:o,data:s,xPos:c,yPos:a,xPosOrigin:l,yPosOrigin:d,selected:p,onClick:m,onMouseEnter:g,onMouseMove:v,onMouseLeave:w,onContextMenu:E,onDoubleClick:N,style:z,className:P,isDraggable:H,isSelectable:K,isConnectable:I,isFocusable:Q,selectNodesOnDrag:G,sourcePosition:Y,targetPosition:te,hidden:V,resizeObserver:ie,dragHandle:ee,zIndex:se,isParent:ae,noDragClassName:b,noPanClassName:A,initialized:R,disableKeyboardA11y:Z,ariaLabel:re,rfId:M,hasHandleBounds:q})=>{const oe=Ue(),ce=O.useRef(null),me=O.useRef(null),ve=O.useRef(Y),be=O.useRef(te),Se=O.useRef(o),Ie=K||H||m||g||v||w,De=Hc(),de=hr(r,oe.getState,g),Re=hr(r,oe.getState,v),He=hr(r,oe.getState,w),Ee=hr(r,oe.getState,E),qe=hr(r,oe.getState,N),Xe=Oe=>{const{nodeDragThreshold:ke}=oe.getState();if(K&&(!G||!H||ke>0)&&Di({id:r,store:oe,nodeRef:ce}),m){const Qe=oe.getState().nodeInternals.get(r);Qe&&m(Oe,{...Qe})}},$e=Oe=>{if(!Ai(Oe)&&!Z)if(hc.includes(Oe.key)&&K){const ke=Oe.key==="Escape";Di({id:r,store:oe,unselect:ke,nodeRef:ce})}else H&&p&&Object.prototype.hasOwnProperty.call(qn,Oe.key)&&(oe.setState({ariaLiveMessage:`Moved selected node ${Oe.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~c}, y: ${~~a}`}),De({x:qn[Oe.key].x,y:qn[Oe.key].y,isShiftPressed:Oe.shiftKey}))};O.useEffect(()=>()=>{me.current&&(ie==null||ie.unobserve(me.current),me.current=null)},[]),O.useEffect(()=>{if(ce.current&&!V){const Oe=ce.current;(!R||!q||me.current!==Oe)&&(me.current&&(ie==null||ie.unobserve(me.current)),ie==null||ie.observe(Oe),me.current=Oe)}},[V,R,q]),O.useEffect(()=>{const Oe=Se.current!==o,ke=ve.current!==Y,Qe=be.current!==te;ce.current&&(Oe||ke||Qe)&&(Oe&&(Se.current=o),ke&&(ve.current=Y),Qe&&(be.current=te),oe.getState().updateNodeDimensions([{id:r,nodeElement:ce.current,forceUpdate:!0}]))},[r,o,Y,te]);const at=Kc({nodeRef:ce,disabled:V||!H,noDragClassName:b,handleSelector:ee,nodeId:r,isSelectable:K,selectNodesOnDrag:G});return V?null:J.createElement("div",{className:et(["react-flow__node",`react-flow__node-${o}`,{[A]:H},P,{selected:p,selectable:K,parent:ae,dragging:at}]),ref:ce,style:{zIndex:se,transform:`translate(${l}px,${d}px)`,pointerEvents:Ie?"all":"none",visibility:R?"visible":"hidden",...z},"data-id":r,"data-testid":`rf__node-${r}`,onMouseEnter:de,onMouseMove:Re,onMouseLeave:He,onContextMenu:Ee,onClick:Xe,onDoubleClick:qe,onKeyDown:Q?$e:void 0,tabIndex:Q?0:void 0,role:Q?"button":void 0,"aria-describedby":Z?void 0:`${Rc}-${M}`,"aria-label":re},J.createElement(ep,{value:r},J.createElement(e,{id:r,data:s,type:o,xPos:c,yPos:a,selected:p,isConnectable:I,sourcePosition:Y,targetPosition:te,dragging:at,dragHandle:ee,zIndex:se})))};return t.displayName="NodeWrapper",O.memo(t)};const Fp=e=>{const t=e.getNodes().filter(r=>r.selected);return{...Mo(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function Kp({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:r}){const o=Ue(),{width:s,height:c,x:a,y:l,transformString:d,userSelectionActive:p}=ze(Fp,Je),m=Hc(),g=O.useRef(null);if(O.useEffect(()=>{var E;r||(E=g.current)==null||E.focus({preventScroll:!0})},[r]),Kc({nodeRef:g}),p||!s||!c)return null;const v=e?E=>{const N=o.getState().getNodes().filter(z=>z.selected);e(E,N)}:void 0,w=E=>{Object.prototype.hasOwnProperty.call(qn,E.key)&&m({x:qn[E.key].x,y:qn[E.key].y,isShiftPressed:E.shiftKey})};return J.createElement("div",{className:et(["react-flow__nodesselection","react-flow__container",t]),style:{transform:d}},J.createElement("div",{ref:g,className:"react-flow__nodesselection-rect",onContextMenu:v,tabIndex:r?void 0:-1,onKeyDown:r?void 0:w,style:{width:s,height:c,top:l,left:a}}))}var Hp=O.memo(Kp);const Wp=e=>e.nodesSelectionActive,Wc=({children:e,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:c,onPaneScroll:a,deleteKeyCode:l,onMove:d,onMoveStart:p,onMoveEnd:m,selectionKeyCode:g,selectionOnDrag:v,selectionMode:w,onSelectionStart:E,onSelectionEnd:N,multiSelectionKeyCode:z,panActivationKeyCode:P,zoomActivationKeyCode:H,elementsSelectable:K,zoomOnScroll:I,zoomOnPinch:Q,panOnScroll:G,panOnScrollSpeed:Y,panOnScrollMode:te,zoomOnDoubleClick:V,panOnDrag:ie,defaultViewport:ee,translateExtent:se,minZoom:ae,maxZoom:b,preventScrolling:A,onSelectionContextMenu:R,noWheelClassName:Z,noPanClassName:re,disableKeyboardA11y:M})=>{const q=ze(Wp),oe=Nr(g),ce=Nr(P),me=ce||ie,ve=ce||G,be=oe||v&&me!==!0;return Tp({deleteKeyCode:l,multiSelectionKeyCode:z}),J.createElement(Rp,{onMove:d,onMoveStart:p,onMoveEnd:m,onPaneContextMenu:c,elementsSelectable:K,zoomOnScroll:I,zoomOnPinch:Q,panOnScroll:ve,panOnScrollSpeed:Y,panOnScrollMode:te,zoomOnDoubleClick:V,panOnDrag:!oe&&me,defaultViewport:ee,translateExtent:se,minZoom:ae,maxZoom:b,zoomActivationKeyCode:H,preventScrolling:A,noWheelClassName:Z,noPanClassName:re},J.createElement(zc,{onSelectionStart:E,onSelectionEnd:N,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:c,onPaneScroll:a,panOnDrag:me,isSelecting:!!be,selectionMode:w},e,q&&J.createElement(Hp,{onSelectionContextMenu:R,noPanClassName:re,disableKeyboardA11y:M})))};Wc.displayName="FlowRenderer";var qp=O.memo(Wc);function Vp(e){return ze(O.useCallback(r=>e?xc(r.nodeInternals,{x:0,y:0,width:r.width,height:r.height},r.transform,!0):r.getNodes(),[e]))}function Yp(e){const t={input:pr(e.input||Tc),default:pr(e.default||ji),output:pr(e.output||Mc),group:pr(e.group||ns)},r={},o=Object.keys(e).filter(s=>!["input","default","output","group"].includes(s)).reduce((s,c)=>(s[c]=pr(e[c]||ji),s),r);return{...t,...o}}const Up=({x:e,y:t,width:r,height:o,origin:s})=>!r||!o?{x:e,y:t}:s[0]<0||s[1]<0||s[0]>1||s[1]>1?{x:e,y:t}:{x:e-r*s[0],y:t-o*s[1]},Xp=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),qc=e=>{const{nodesDraggable:t,nodesConnectable:r,nodesFocusable:o,elementsSelectable:s,updateNodeDimensions:c,onError:a}=ze(Xp,Je),l=Vp(e.onlyRenderVisibleElements),d=O.useRef(),p=O.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const m=new ResizeObserver(g=>{const v=g.map(w=>({id:w.target.getAttribute("data-id"),nodeElement:w.target,forceUpdate:!0}));c(v)});return d.current=m,m},[]);return O.useEffect(()=>()=>{var m;(m=d==null?void 0:d.current)==null||m.disconnect()},[]),J.createElement("div",{className:"react-flow__nodes",style:os},l.map(m=>{var Q,G,Y;let g=m.type||"default";e.nodeTypes[g]||(a==null||a("003",en.error003(g)),g="default");const v=e.nodeTypes[g]||e.nodeTypes.default,w=!!(m.draggable||t&&typeof m.draggable>"u"),E=!!(m.selectable||s&&typeof m.selectable>"u"),N=!!(m.connectable||r&&typeof m.connectable>"u"),z=!!(m.focusable||o&&typeof m.focusable>"u"),P=e.nodeExtent?Gi(m.positionAbsolute,e.nodeExtent):m.positionAbsolute,H=(P==null?void 0:P.x)??0,K=(P==null?void 0:P.y)??0,I=Up({x:H,y:K,width:m.width??0,height:m.height??0,origin:e.nodeOrigin});return J.createElement(v,{key:m.id,id:m.id,className:m.className,style:m.style,type:g,data:m.data,sourcePosition:m.sourcePosition||_e.Bottom,targetPosition:m.targetPosition||_e.Top,hidden:m.hidden,xPos:H,yPos:K,xPosOrigin:I.x,yPosOrigin:I.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!m.selected,isDraggable:w,isSelectable:E,isConnectable:N,isFocusable:z,resizeObserver:p,dragHandle:m.dragHandle,zIndex:((Q=m[We])==null?void 0:Q.z)??0,isParent:!!((G=m[We])!=null&&G.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!m.width&&!!m.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:m.ariaLabel,hasHandleBounds:!!((Y=m[We])!=null&&Y.handleBounds)})}))};qc.displayName="NodeRenderer";var Gp=O.memo(qc);const Zp=(e,t,r)=>r===_e.Left?e-t:r===_e.Right?e+t:e,Jp=(e,t,r)=>r===_e.Top?e-t:r===_e.Bottom?e+t:e,ma="react-flow__edgeupdater",ya=({position:e,centerX:t,centerY:r,radius:o=10,onMouseDown:s,onMouseEnter:c,onMouseOut:a,type:l})=>J.createElement("circle",{onMouseDown:s,onMouseEnter:c,onMouseOut:a,className:et([ma,`${ma}-${l}`]),cx:Zp(t,o,e),cy:Jp(r,o,e),r:o,stroke:"transparent",fill:"transparent"}),Qp=()=>!0;var Fn=e=>{const t=({id:r,className:o,type:s,data:c,onClick:a,onEdgeDoubleClick:l,selected:d,animated:p,label:m,labelStyle:g,labelShowBg:v,labelBgStyle:w,labelBgPadding:E,labelBgBorderRadius:N,style:z,source:P,target:H,sourceX:K,sourceY:I,targetX:Q,targetY:G,sourcePosition:Y,targetPosition:te,elementsSelectable:V,hidden:ie,sourceHandleId:ee,targetHandleId:se,onContextMenu:ae,onMouseEnter:b,onMouseMove:A,onMouseLeave:R,reconnectRadius:Z,onReconnect:re,onReconnectStart:M,onReconnectEnd:q,markerEnd:oe,markerStart:ce,rfId:me,ariaLabel:ve,isFocusable:be,isReconnectable:Se,pathOptions:Ie,interactionWidth:De,disableKeyboardA11y:de})=>{const Re=O.useRef(null),[He,Ee]=O.useState(!1),[qe,Xe]=O.useState(!1),$e=Ue(),at=O.useMemo(()=>`url('#${Pi(ce,me)}')`,[ce,me]),Oe=O.useMemo(()=>`url('#${Pi(oe,me)}')`,[oe,me]);if(ie)return null;const ke=Fe=>{var Ge;const{edges:nt,addSelectedEdges:Et,unselectNodesAndEdges:rt,multiSelectionActive:xe}=$e.getState(),ut=nt.find(Rt=>Rt.id===r);ut&&(V&&($e.setState({nodesSelectionActive:!1}),ut.selected&&xe?(rt({nodes:[],edges:[ut]}),(Ge=Re.current)==null||Ge.blur()):Et([r])),a&&a(Fe,ut))},Qe=dr(r,$e.getState,l),dt=dr(r,$e.getState,ae),tt=dr(r,$e.getState,b),qt=dr(r,$e.getState,A),yt=dr(r,$e.getState,R),gt=(Fe,nt)=>{if(Fe.button!==0)return;const{edges:Et,isValidConnection:rt}=$e.getState(),xe=nt?H:P,ut=(nt?se:ee)||null,Ge=nt?"target":"source",Rt=rt||Qp,ye=nt,Vt=Et.find(jt=>jt.id===r);Xe(!0),M==null||M(Fe,Vt,Ge);const Nn=jt=>{Xe(!1),q==null||q(jt,Vt,Ge)};Sc({event:Fe,handleId:ut,nodeId:xe,onConnect:jt=>re==null?void 0:re(Vt,jt),isTarget:ye,getState:$e.getState,setState:$e.setState,isValidConnection:Rt,edgeUpdaterType:Ge,onReconnectEnd:Nn})},vt=Fe=>gt(Fe,!0),ct=Fe=>gt(Fe,!1),kt=()=>Ee(!0),wt=()=>Ee(!1),Mt=!V&&!a,Pt=Fe=>{var nt;if(!de&&hc.includes(Fe.key)&&V){const{unselectNodesAndEdges:Et,addSelectedEdges:rt,edges:xe}=$e.getState();Fe.key==="Escape"?((nt=Re.current)==null||nt.blur(),Et({edges:[xe.find(Ge=>Ge.id===r)]})):rt([r])}};return J.createElement("g",{className:et(["react-flow__edge",`react-flow__edge-${s}`,o,{selected:d,animated:p,inactive:Mt,updating:He}]),onClick:ke,onDoubleClick:Qe,onContextMenu:dt,onMouseEnter:tt,onMouseMove:qt,onMouseLeave:yt,onKeyDown:be?Pt:void 0,tabIndex:be?0:void 0,role:be?"button":"img","data-testid":`rf__edge-${r}`,"aria-label":ve===null?void 0:ve||`Edge from ${P} to ${H}`,"aria-describedby":be?`${jc}-${me}`:void 0,ref:Re},!qe&&J.createElement(e,{id:r,source:P,target:H,selected:d,animated:p,label:m,labelStyle:g,labelShowBg:v,labelBgStyle:w,labelBgPadding:E,labelBgBorderRadius:N,data:c,style:z,sourceX:K,sourceY:I,targetX:Q,targetY:G,sourcePosition:Y,targetPosition:te,sourceHandleId:ee,targetHandleId:se,markerStart:at,markerEnd:Oe,pathOptions:Ie,interactionWidth:De}),Se&&J.createElement(J.Fragment,null,(Se==="source"||Se===!0)&&J.createElement(ya,{position:Y,centerX:K,centerY:I,radius:Z,onMouseDown:vt,onMouseEnter:kt,onMouseOut:wt,type:"source"}),(Se==="target"||Se===!0)&&J.createElement(ya,{position:te,centerX:Q,centerY:G,radius:Z,onMouseDown:ct,onMouseEnter:kt,onMouseOut:wt,type:"target"})))};return t.displayName="EdgeWrapper",O.memo(t)};function em(e){const t={default:Fn(e.default||_o),straight:Fn(e.bezier||Qi),step:Fn(e.step||Ji),smoothstep:Fn(e.step||Ao),simplebezier:Fn(e.simplebezier||Zi)},r={},o=Object.keys(e).filter(s=>!["default","bezier"].includes(s)).reduce((s,c)=>(s[c]=Fn(e[c]||_o),s),r);return{...t,...o}}function ga(e,t,r=null){const o=((r==null?void 0:r.x)||0)+t.x,s=((r==null?void 0:r.y)||0)+t.y,c=(r==null?void 0:r.width)||t.width,a=(r==null?void 0:r.height)||t.height;switch(e){case _e.Top:return{x:o+c/2,y:s};case _e.Right:return{x:o+c,y:s+a/2};case _e.Bottom:return{x:o+c/2,y:s+a};case _e.Left:return{x:o,y:s+a/2}}}function va(e,t){return e?e.length===1||!t?e[0]:t&&e.find(r=>r.id===t)||null:null}const tm=(e,t,r,o,s,c)=>{const a=ga(r,e,t),l=ga(c,o,s);return{sourceX:a.x,sourceY:a.y,targetX:l.x,targetY:l.y}};function nm({sourcePos:e,targetPos:t,sourceWidth:r,sourceHeight:o,targetWidth:s,targetHeight:c,width:a,height:l,transform:d}){const p={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+r,t.x+s),y2:Math.max(e.y+o,t.y+c)};p.x===p.x2&&(p.x2+=1),p.y===p.y2&&(p.y2+=1);const m=Er({x:(0-d[0])/d[2],y:(0-d[1])/d[2],width:a/d[2],height:l/d[2]}),g=Math.max(0,Math.min(m.x2,p.x2)-Math.max(m.x,p.x)),v=Math.max(0,Math.min(m.y2,p.y2)-Math.max(m.y,p.y));return Math.ceil(g*v)>0}function wa(e){var o,s,c,a,l;const t=((o=e==null?void 0:e[We])==null?void 0:o.handleBounds)||null,r=t&&(e==null?void 0:e.width)&&(e==null?void 0:e.height)&&typeof((s=e==null?void 0:e.positionAbsolute)==null?void 0:s.x)<"u"&&typeof((c=e==null?void 0:e.positionAbsolute)==null?void 0:c.y)<"u";return[{x:((a=e==null?void 0:e.positionAbsolute)==null?void 0:a.x)||0,y:((l=e==null?void 0:e.positionAbsolute)==null?void 0:l.y)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0},t,!!r]}const rm=[{level:0,isMaxLevel:!0,edges:[]}];function om(e,t,r=!1){let o=-1;const s=e.reduce((a,l)=>{var m,g;const d=_t(l.zIndex);let p=d?l.zIndex:0;if(r){const v=t.get(l.target),w=t.get(l.source),E=l.selected||(v==null?void 0:v.selected)||(w==null?void 0:w.selected),N=Math.max(((m=w==null?void 0:w[We])==null?void 0:m.z)||0,((g=v==null?void 0:v[We])==null?void 0:g.z)||0,1e3);p=(d?l.zIndex:0)+(E?N:0)}return a[p]?a[p].push(l):a[p]=[l],o=p>o?p:o,a},{}),c=Object.entries(s).map(([a,l])=>{const d=+a;return{edges:l,level:d,isMaxLevel:d===o}});return c.length===0?rm:c}function im(e,t,r){const o=ze(O.useCallback(s=>e?s.edges.filter(c=>{const a=t.get(c.source),l=t.get(c.target);return(a==null?void 0:a.width)&&(a==null?void 0:a.height)&&(l==null?void 0:l.width)&&(l==null?void 0:l.height)&&nm({sourcePos:a.positionAbsolute||{x:0,y:0},targetPos:l.positionAbsolute||{x:0,y:0},sourceWidth:a.width,sourceHeight:a.height,targetWidth:l.width,targetHeight:l.height,width:s.width,height:s.height,transform:s.transform})}):s.edges,[e,t]));return om(o,t,r)}const sm=({color:e="none",strokeWidth:t=1})=>J.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),am=({color:e="none",strokeWidth:t=1})=>J.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),xa={[bo.Arrow]:sm,[bo.ArrowClosed]:am};function cm(e){const t=Ue();return O.useMemo(()=>{var s,c;return Object.prototype.hasOwnProperty.call(xa,e)?xa[e]:((c=(s=t.getState()).onError)==null||c.call(s,"009",en.error009(e)),null)},[e])}const um=({id:e,type:t,color:r,width:o=12.5,height:s=12.5,markerUnits:c="strokeWidth",strokeWidth:a,orient:l="auto-start-reverse"})=>{const d=cm(t);return d?J.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${o}`,markerHeight:`${s}`,viewBox:"-10 -10 20 20",markerUnits:c,orient:l,refX:"0",refY:"0"},J.createElement(d,{color:r,strokeWidth:a})):null},lm=({defaultColor:e,rfId:t})=>r=>{const o=[];return r.edges.reduce((s,c)=>([c.markerStart,c.markerEnd].forEach(a=>{if(a&&typeof a=="object"){const l=Pi(a,t);o.includes(l)||(s.push({id:l,color:a.color||e,...a}),o.push(l))}}),s),[]).sort((s,c)=>s.id.localeCompare(c.id))},Vc=({defaultColor:e,rfId:t})=>{const r=ze(O.useCallback(lm({defaultColor:e,rfId:t}),[e,t]),(o,s)=>!(o.length!==s.length||o.some((c,a)=>c.id!==s[a].id)));return J.createElement("defs",null,r.map(o=>J.createElement(um,{id:o.id,key:o.id,type:o.type,color:o.color,width:o.width,height:o.height,markerUnits:o.markerUnits,strokeWidth:o.strokeWidth,orient:o.orient})))};Vc.displayName="MarkerDefinitions";var fm=O.memo(Vc);const dm=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),Yc=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:r,rfId:o,edgeTypes:s,noPanClassName:c,onEdgeContextMenu:a,onEdgeMouseEnter:l,onEdgeMouseMove:d,onEdgeMouseLeave:p,onEdgeClick:m,onEdgeDoubleClick:g,onReconnect:v,onReconnectStart:w,onReconnectEnd:E,reconnectRadius:N,children:z,disableKeyboardA11y:P})=>{const{edgesFocusable:H,edgesUpdatable:K,elementsSelectable:I,width:Q,height:G,connectionMode:Y,nodeInternals:te,onError:V}=ze(dm,Je),ie=im(t,te,r);return Q?J.createElement(J.Fragment,null,ie.map(({level:ee,edges:se,isMaxLevel:ae})=>J.createElement("svg",{key:ee,style:{zIndex:ee},width:Q,height:G,className:"react-flow__edges react-flow__container"},ae&&J.createElement(fm,{defaultColor:e,rfId:o}),J.createElement("g",null,se.map(b=>{const[A,R,Z]=wa(te.get(b.source)),[re,M,q]=wa(te.get(b.target));if(!Z||!q)return null;let oe=b.type||"default";s[oe]||(V==null||V("011",en.error011(oe)),oe="default");const ce=s[oe]||s.default,me=Y===Sn.Strict?M.target:(M.target??[]).concat(M.source??[]),ve=va(R.source,b.sourceHandle),be=va(me,b.targetHandle),Se=(ve==null?void 0:ve.position)||_e.Bottom,Ie=(be==null?void 0:be.position)||_e.Top,De=!!(b.focusable||H&&typeof b.focusable>"u"),de=b.reconnectable||b.updatable,Re=typeof v<"u"&&(de||K&&typeof de>"u");if(!ve||!be)return V==null||V("008",en.error008(ve,b)),null;const{sourceX:He,sourceY:Ee,targetX:qe,targetY:Xe}=tm(A,ve,Se,re,be,Ie);return J.createElement(ce,{key:b.id,id:b.id,className:et([b.className,c]),type:oe,data:b.data,selected:!!b.selected,animated:!!b.animated,hidden:!!b.hidden,label:b.label,labelStyle:b.labelStyle,labelShowBg:b.labelShowBg,labelBgStyle:b.labelBgStyle,labelBgPadding:b.labelBgPadding,labelBgBorderRadius:b.labelBgBorderRadius,style:b.style,source:b.source,target:b.target,sourceHandleId:b.sourceHandle,targetHandleId:b.targetHandle,markerEnd:b.markerEnd,markerStart:b.markerStart,sourceX:He,sourceY:Ee,targetX:qe,targetY:Xe,sourcePosition:Se,targetPosition:Ie,elementsSelectable:I,onContextMenu:a,onMouseEnter:l,onMouseMove:d,onMouseLeave:p,onClick:m,onEdgeDoubleClick:g,onReconnect:v,onReconnectStart:w,onReconnectEnd:E,reconnectRadius:N,rfId:o,ariaLabel:b.ariaLabel,isFocusable:De,isReconnectable:Re,pathOptions:"pathOptions"in b?b.pathOptions:void 0,interactionWidth:b.interactionWidth,disableKeyboardA11y:P})})))),z):null};Yc.displayName="EdgeRenderer";var hm=O.memo(Yc);const pm=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function mm({children:e}){const t=ze(pm);return J.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function ym(e){const t=rs(),r=O.useRef(!1);O.useEffect(()=>{!r.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),r.current=!0)},[e,t.viewportInitialized])}const gm={[_e.Left]:_e.Right,[_e.Right]:_e.Left,[_e.Top]:_e.Bottom,[_e.Bottom]:_e.Top},Uc=({nodeId:e,handleType:t,style:r,type:o=hn.Bezier,CustomComponent:s,connectionStatus:c})=>{var G,Y,te;const{fromNode:a,handleId:l,toX:d,toY:p,connectionMode:m}=ze(O.useCallback(V=>({fromNode:V.nodeInternals.get(e),handleId:V.connectionHandleId,toX:(V.connectionPosition.x-V.transform[0])/V.transform[2],toY:(V.connectionPosition.y-V.transform[1])/V.transform[2],connectionMode:V.connectionMode}),[e]),Je),g=(G=a==null?void 0:a[We])==null?void 0:G.handleBounds;let v=g==null?void 0:g[t];if(m===Sn.Loose&&(v=v||(g==null?void 0:g[t==="source"?"target":"source"])),!a||!v)return null;const w=l?v.find(V=>V.id===l):v[0],E=w?w.x+w.width/2:(a.width??0)/2,N=w?w.y+w.height/2:a.height??0,z=(((Y=a.positionAbsolute)==null?void 0:Y.x)??0)+E,P=(((te=a.positionAbsolute)==null?void 0:te.y)??0)+N,H=w==null?void 0:w.position,K=H?gm[H]:null;if(!H||!K)return null;if(s)return J.createElement(s,{connectionLineType:o,connectionLineStyle:r,fromNode:a,fromHandle:w,fromX:z,fromY:P,toX:d,toY:p,fromPosition:H,toPosition:K,connectionStatus:c});let I="";const Q={sourceX:z,sourceY:P,sourcePosition:H,targetX:d,targetY:p,targetPosition:K};return o===hn.Bezier?[I]=vc(Q):o===hn.Step?[I]=Mi({...Q,borderRadius:0}):o===hn.SmoothStep?[I]=Mi(Q):o===hn.SimpleBezier?[I]=gc(Q):I=`M${z},${P} ${d},${p}`,J.createElement("path",{d:I,fill:"none",className:"react-flow__connection-path",style:r})};Uc.displayName="ConnectionLine";const vm=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function wm({containerStyle:e,style:t,type:r,component:o}){const{nodeId:s,handleType:c,nodesConnectable:a,width:l,height:d,connectionStatus:p}=ze(vm,Je);return!(s&&c&&l&&a)?null:J.createElement("svg",{style:e,width:l,height:d,className:"react-flow__edges react-flow__connectionline react-flow__container"},J.createElement("g",{className:et(["react-flow__connection",p])},J.createElement(Uc,{nodeId:s,handleType:c,style:t,type:r,CustomComponent:o,connectionStatus:p})))}function ba(e,t){return O.useRef(null),Ue(),O.useMemo(()=>t(e),[e])}const Xc=({nodeTypes:e,edgeTypes:t,onMove:r,onMoveStart:o,onMoveEnd:s,onInit:c,onNodeClick:a,onEdgeClick:l,onNodeDoubleClick:d,onEdgeDoubleClick:p,onNodeMouseEnter:m,onNodeMouseMove:g,onNodeMouseLeave:v,onNodeContextMenu:w,onSelectionContextMenu:E,onSelectionStart:N,onSelectionEnd:z,connectionLineType:P,connectionLineStyle:H,connectionLineComponent:K,connectionLineContainerStyle:I,selectionKeyCode:Q,selectionOnDrag:G,selectionMode:Y,multiSelectionKeyCode:te,panActivationKeyCode:V,zoomActivationKeyCode:ie,deleteKeyCode:ee,onlyRenderVisibleElements:se,elementsSelectable:ae,selectNodesOnDrag:b,defaultViewport:A,translateExtent:R,minZoom:Z,maxZoom:re,preventScrolling:M,defaultMarkerColor:q,zoomOnScroll:oe,zoomOnPinch:ce,panOnScroll:me,panOnScrollSpeed:ve,panOnScrollMode:be,zoomOnDoubleClick:Se,panOnDrag:Ie,onPaneClick:De,onPaneMouseEnter:de,onPaneMouseMove:Re,onPaneMouseLeave:He,onPaneScroll:Ee,onPaneContextMenu:qe,onEdgeContextMenu:Xe,onEdgeMouseEnter:$e,onEdgeMouseMove:at,onEdgeMouseLeave:Oe,onReconnect:ke,onReconnectStart:Qe,onReconnectEnd:dt,reconnectRadius:tt,noDragClassName:qt,noWheelClassName:yt,noPanClassName:gt,elevateEdgesOnSelect:vt,disableKeyboardA11y:ct,nodeOrigin:kt,nodeExtent:wt,rfId:Mt})=>{const Pt=ba(e,Yp),Fe=ba(t,em);return ym(c),J.createElement(qp,{onPaneClick:De,onPaneMouseEnter:de,onPaneMouseMove:Re,onPaneMouseLeave:He,onPaneContextMenu:qe,onPaneScroll:Ee,deleteKeyCode:ee,selectionKeyCode:Q,selectionOnDrag:G,selectionMode:Y,onSelectionStart:N,onSelectionEnd:z,multiSelectionKeyCode:te,panActivationKeyCode:V,zoomActivationKeyCode:ie,elementsSelectable:ae,onMove:r,onMoveStart:o,onMoveEnd:s,zoomOnScroll:oe,zoomOnPinch:ce,zoomOnDoubleClick:Se,panOnScroll:me,panOnScrollSpeed:ve,panOnScrollMode:be,panOnDrag:Ie,defaultViewport:A,translateExtent:R,minZoom:Z,maxZoom:re,onSelectionContextMenu:E,preventScrolling:M,noDragClassName:qt,noWheelClassName:yt,noPanClassName:gt,disableKeyboardA11y:ct},J.createElement(mm,null,J.createElement(hm,{edgeTypes:Fe,onEdgeClick:l,onEdgeDoubleClick:p,onlyRenderVisibleElements:se,onEdgeContextMenu:Xe,onEdgeMouseEnter:$e,onEdgeMouseMove:at,onEdgeMouseLeave:Oe,onReconnect:ke,onReconnectStart:Qe,onReconnectEnd:dt,reconnectRadius:tt,defaultMarkerColor:q,noPanClassName:gt,elevateEdgesOnSelect:!!vt,disableKeyboardA11y:ct,rfId:Mt},J.createElement(wm,{style:H,type:P,component:K,containerStyle:I})),J.createElement("div",{className:"react-flow__edgelabel-renderer"}),J.createElement(Gp,{nodeTypes:Pt,onNodeClick:a,onNodeDoubleClick:d,onNodeMouseEnter:m,onNodeMouseMove:g,onNodeMouseLeave:v,onNodeContextMenu:w,selectNodesOnDrag:b,onlyRenderVisibleElements:se,noPanClassName:gt,noDragClassName:qt,disableKeyboardA11y:ct,nodeOrigin:kt,nodeExtent:wt,rfId:Mt})))};Xc.displayName="GraphView";var xm=O.memo(Xc);const Oi=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],un={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Oi,nodeExtent:Oi,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:Sn.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:Uh,isValidConnection:void 0},bm=()=>cl((e,t)=>({...un,setNodes:r=>{const{nodeInternals:o,nodeOrigin:s,elevateNodesOnSelect:c}=t();e({nodeInternals:mi(r,o,s,c)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:r=>{const{defaultEdgeOptions:o={}}=t();e({edges:r.map(s=>({...o,...s}))})},setDefaultNodesAndEdges:(r,o)=>{const s=typeof r<"u",c=typeof o<"u",a=s?mi(r,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:a,edges:c?o:[],hasDefaultNodes:s,hasDefaultEdges:c})},updateNodeDimensions:r=>{const{onNodesChange:o,nodeInternals:s,fitViewOnInit:c,fitViewOnInitDone:a,fitViewOnInitOptions:l,domNode:d,nodeOrigin:p}=t(),m=d==null?void 0:d.querySelector(".react-flow__viewport");if(!m)return;const g=window.getComputedStyle(m),{m22:v}=new window.DOMMatrixReadOnly(g.transform),w=r.reduce((N,z)=>{const P=s.get(z.id);if(P!=null&&P.hidden)s.set(P.id,{...P,[We]:{...P[We],handleBounds:void 0}});else if(P){const H=Xi(z.nodeElement);!!(H.width&&H.height&&(P.width!==H.width||P.height!==H.height||z.forceUpdate))&&(s.set(P.id,{...P,[We]:{...P[We],handleBounds:{source:pa(".source",z.nodeElement,v,p),target:pa(".target",z.nodeElement,v,p)}},...H}),N.push({id:P.id,type:"dimensions",dimensions:H}))}return N},[]);Oc(s,p);const E=a||c&&!a&&$c(t,{initial:!0,...l});e({nodeInternals:new Map(s),fitViewOnInitDone:E}),(w==null?void 0:w.length)>0&&(o==null||o(w))},updateNodePositions:(r,o=!0,s=!1)=>{const{triggerNodeChanges:c}=t(),a=r.map(l=>{const d={id:l.id,type:"position",dragging:s};return o&&(d.positionAbsolute=l.positionAbsolute,d.position=l.position),d});c(a)},triggerNodeChanges:r=>{const{onNodesChange:o,nodeInternals:s,hasDefaultNodes:c,nodeOrigin:a,getNodes:l,elevateNodesOnSelect:d}=t();if(r!=null&&r.length){if(c){const p=Bc(r,l()),m=mi(p,s,a,d);e({nodeInternals:m})}o==null||o(r)}},addSelectedNodes:r=>{const{multiSelectionActive:o,edges:s,getNodes:c}=t();let a,l=null;o?a=r.map(d=>dn(d,!0)):(a=Kn(c(),r),l=Kn(s,[])),so({changedNodes:a,changedEdges:l,get:t,set:e})},addSelectedEdges:r=>{const{multiSelectionActive:o,edges:s,getNodes:c}=t();let a,l=null;o?a=r.map(d=>dn(d,!0)):(a=Kn(s,r),l=Kn(c(),[])),so({changedNodes:l,changedEdges:a,get:t,set:e})},unselectNodesAndEdges:({nodes:r,edges:o}={})=>{const{edges:s,getNodes:c}=t(),a=r||c(),l=o||s,d=a.map(m=>(m.selected=!1,dn(m.id,!1))),p=l.map(m=>dn(m.id,!1));so({changedNodes:d,changedEdges:p,get:t,set:e})},setMinZoom:r=>{const{d3Zoom:o,maxZoom:s}=t();o==null||o.scaleExtent([r,s]),e({minZoom:r})},setMaxZoom:r=>{const{d3Zoom:o,minZoom:s}=t();o==null||o.scaleExtent([s,r]),e({maxZoom:r})},setTranslateExtent:r=>{var o;(o=t().d3Zoom)==null||o.translateExtent(r),e({translateExtent:r})},resetSelectedElements:()=>{const{edges:r,getNodes:o}=t(),c=o().filter(l=>l.selected).map(l=>dn(l.id,!1)),a=r.filter(l=>l.selected).map(l=>dn(l.id,!1));so({changedNodes:c,changedEdges:a,get:t,set:e})},setNodeExtent:r=>{const{nodeInternals:o}=t();o.forEach(s=>{s.positionAbsolute=Gi(s.position,r)}),e({nodeExtent:r,nodeInternals:new Map(o)})},panBy:r=>{const{transform:o,width:s,height:c,d3Zoom:a,d3Selection:l,translateExtent:d}=t();if(!a||!l||!r.x&&!r.y)return!1;const p=Jt.translate(o[0]+r.x,o[1]+r.y).scale(o[2]),m=[[0,0],[s,c]],g=a==null?void 0:a.constrain()(p,m,d);return a.transform(l,g),o[0]!==g.x||o[1]!==g.y||o[2]!==g.k},cancelConnection:()=>e({connectionNodeId:un.connectionNodeId,connectionHandleId:un.connectionHandleId,connectionHandleType:un.connectionHandleType,connectionStatus:un.connectionStatus,connectionStartHandle:un.connectionStartHandle,connectionEndHandle:un.connectionEndHandle}),reset:()=>e({...un})}),Object.is),Gc=({children:e})=>{const t=O.useRef(null);return t.current||(t.current=bm()),J.createElement(Fh,{value:t.current},e)};Gc.displayName="ReactFlowProvider";const Zc=({children:e})=>O.useContext(To)?J.createElement(J.Fragment,null,e):J.createElement(Gc,null,e);Zc.displayName="ReactFlowWrapper";const _m={input:Tc,default:ji,output:Mc,group:ns},km={default:_o,straight:Qi,step:Ji,smoothstep:Ao,simplebezier:Zi},Em=[0,0],Sm=[15,15],Nm={x:0,y:0,zoom:1},Cm={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},Jc=O.forwardRef(({nodes:e,edges:t,defaultNodes:r,defaultEdges:o,className:s,nodeTypes:c=_m,edgeTypes:a=km,onNodeClick:l,onEdgeClick:d,onInit:p,onMove:m,onMoveStart:g,onMoveEnd:v,onConnect:w,onConnectStart:E,onConnectEnd:N,onClickConnectStart:z,onClickConnectEnd:P,onNodeMouseEnter:H,onNodeMouseMove:K,onNodeMouseLeave:I,onNodeContextMenu:Q,onNodeDoubleClick:G,onNodeDragStart:Y,onNodeDrag:te,onNodeDragStop:V,onNodesDelete:ie,onEdgesDelete:ee,onSelectionChange:se,onSelectionDragStart:ae,onSelectionDrag:b,onSelectionDragStop:A,onSelectionContextMenu:R,onSelectionStart:Z,onSelectionEnd:re,connectionMode:M=Sn.Strict,connectionLineType:q=hn.Bezier,connectionLineStyle:oe,connectionLineComponent:ce,connectionLineContainerStyle:me,deleteKeyCode:ve="Backspace",selectionKeyCode:be="Shift",selectionOnDrag:Se=!1,selectionMode:Ie=Sr.Full,panActivationKeyCode:De="Space",multiSelectionKeyCode:de=xo()?"Meta":"Control",zoomActivationKeyCode:Re=xo()?"Meta":"Control",snapToGrid:He=!1,snapGrid:Ee=Sm,onlyRenderVisibleElements:qe=!1,selectNodesOnDrag:Xe=!0,nodesDraggable:$e,nodesConnectable:at,nodesFocusable:Oe,nodeOrigin:ke=Em,edgesFocusable:Qe,edgesUpdatable:dt,elementsSelectable:tt,defaultViewport:qt=Nm,minZoom:yt=.5,maxZoom:gt=2,translateExtent:vt=Oi,preventScrolling:ct=!0,nodeExtent:kt,defaultMarkerColor:wt="#b1b1b7",zoomOnScroll:Mt=!0,zoomOnPinch:Pt=!0,panOnScroll:Fe=!1,panOnScrollSpeed:nt=.5,panOnScrollMode:Et=bn.Free,zoomOnDoubleClick:rt=!0,panOnDrag:xe=!0,onPaneClick:ut,onPaneMouseEnter:Ge,onPaneMouseMove:Rt,onPaneMouseLeave:ye,onPaneScroll:Vt,onPaneContextMenu:Nn,children:Cn,onEdgeContextMenu:jt,onEdgeDoubleClick:Gn,onEdgeMouseEnter:Ro,onEdgeMouseMove:jo,onEdgeMouseLeave:tn,onEdgeUpdate:nn,onEdgeUpdateStart:Zn,onEdgeUpdateEnd:In,onReconnect:Be,onReconnectStart:Ye,onReconnectEnd:Do,reconnectRadius:Tn=10,edgeUpdaterRadius:An=10,onNodesChange:Mn,onEdgesChange:Oo,noDragClassName:Dt="nodrag",noWheelClassName:rn="nowheel",noPanClassName:St="nopan",fitView:Pn=!1,fitViewOptions:$o,connectOnClick:Ot=!0,attributionPosition:Pr,proOptions:Yt,defaultEdgeOptions:Rr,elevateNodesOnSelect:Jn=!0,elevateEdgesOnSelect:Ke=!1,disableKeyboardA11y:$t=!1,autoPanOnConnect:Nt=!0,autoPanOnNodeDrag:jr=!0,connectionRadius:on=20,isValidConnection:Rn,onError:Qn,style:er,id:Bt,nodeDragThreshold:Dr,...jn},Or)=>{const Te=Bt||"1";return J.createElement("div",{...jn,style:{...er,...Cm},ref:Or,className:et(["react-flow",s]),"data-testid":"rf__wrapper",id:Bt},J.createElement(Zc,null,J.createElement(xm,{onInit:p,onMove:m,onMoveStart:g,onMoveEnd:v,onNodeClick:l,onEdgeClick:d,onNodeMouseEnter:H,onNodeMouseMove:K,onNodeMouseLeave:I,onNodeContextMenu:Q,onNodeDoubleClick:G,nodeTypes:c,edgeTypes:a,connectionLineType:q,connectionLineStyle:oe,connectionLineComponent:ce,connectionLineContainerStyle:me,selectionKeyCode:be,selectionOnDrag:Se,selectionMode:Ie,deleteKeyCode:ve,multiSelectionKeyCode:de,panActivationKeyCode:De,zoomActivationKeyCode:Re,onlyRenderVisibleElements:qe,selectNodesOnDrag:Xe,defaultViewport:qt,translateExtent:vt,minZoom:yt,maxZoom:gt,preventScrolling:ct,zoomOnScroll:Mt,zoomOnPinch:Pt,zoomOnDoubleClick:rt,panOnScroll:Fe,panOnScrollSpeed:nt,panOnScrollMode:Et,panOnDrag:xe,onPaneClick:ut,onPaneMouseEnter:Ge,onPaneMouseMove:Rt,onPaneMouseLeave:ye,onPaneScroll:Vt,onPaneContextMenu:Nn,onSelectionContextMenu:R,onSelectionStart:Z,onSelectionEnd:re,onEdgeContextMenu:jt,onEdgeDoubleClick:Gn,onEdgeMouseEnter:Ro,onEdgeMouseMove:jo,onEdgeMouseLeave:tn,onReconnect:Be??nn,onReconnectStart:Ye??Zn,onReconnectEnd:Do??In,reconnectRadius:Tn??An,defaultMarkerColor:wt,noDragClassName:Dt,noWheelClassName:rn,noPanClassName:St,elevateEdgesOnSelect:Ke,rfId:Te,disableKeyboardA11y:$t,nodeOrigin:ke,nodeExtent:kt}),J.createElement(gp,{nodes:e,edges:t,defaultNodes:r,defaultEdges:o,onConnect:w,onConnectStart:E,onConnectEnd:N,onClickConnectStart:z,onClickConnectEnd:P,nodesDraggable:$e,nodesConnectable:at,nodesFocusable:Oe,edgesFocusable:Qe,edgesUpdatable:dt,elementsSelectable:tt,elevateNodesOnSelect:Jn,minZoom:yt,maxZoom:gt,nodeExtent:kt,onNodesChange:Mn,onEdgesChange:Oo,snapToGrid:He,snapGrid:Ee,connectionMode:M,translateExtent:vt,connectOnClick:Ot,defaultEdgeOptions:Rr,fitView:Pn,fitViewOptions:$o,onNodesDelete:ie,onEdgesDelete:ee,onNodeDragStart:Y,onNodeDrag:te,onNodeDragStop:V,onSelectionDrag:b,onSelectionDragStart:ae,onSelectionDragStop:A,noPanClassName:St,nodeOrigin:ke,rfId:Te,autoPanOnConnect:Nt,autoPanOnNodeDrag:jr,onError:Qn,connectionRadius:on,isValidConnection:Rn,nodeDragThreshold:Dr}),J.createElement(mp,{onSelectionChange:se}),Cn,J.createElement(Hh,{proOptions:Yt,position:Pr}),J.createElement(_p,{rfId:Te,disableKeyboardA11y:$t})))});Jc.displayName="ReactFlow";const Qc=({id:e,x:t,y:r,width:o,height:s,style:c,color:a,strokeColor:l,strokeWidth:d,className:p,borderRadius:m,shapeRendering:g,onClick:v,selected:w})=>{const{background:E,backgroundColor:N}=c||{},z=a||E||N;return J.createElement("rect",{className:et(["react-flow__minimap-node",{selected:w},p]),x:t,y:r,rx:m,ry:m,width:o,height:s,fill:z,stroke:l,strokeWidth:d,shapeRendering:g,onClick:v?P=>v(P,e):void 0})};Qc.displayName="MiniMapNode";var Im=O.memo(Qc);const Tm=e=>e.nodeOrigin,Am=e=>e.getNodes().filter(t=>!t.hidden&&t.width&&t.height),wi=e=>e instanceof Function?e:()=>e;function Mm({nodeStrokeColor:e="transparent",nodeColor:t="#e2e2e2",nodeClassName:r="",nodeBorderRadius:o=5,nodeStrokeWidth:s=2,nodeComponent:c=Im,onClick:a}){const l=ze(Am,Je),d=ze(Tm),p=wi(t),m=wi(e),g=wi(r),v=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return J.createElement(J.Fragment,null,l.map(w=>{const{x:E,y:N}=kn(w,d).positionAbsolute;return J.createElement(c,{key:w.id,x:E,y:N,width:w.width,height:w.height,style:w.style,selected:w.selected,className:g(w),color:p(w),borderRadius:o,strokeColor:m(w),strokeWidth:s,shapeRendering:v,onClick:a,id:w.id})}))}var Pm=O.memo(Mm);const Rm=200,jm=150,Dm=e=>{const t=e.getNodes(),r={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:r,boundingRect:t.length>0?Vh(Mo(t,e.nodeOrigin),r):r,rfId:e.rfId}},Om="react-flow__minimap-desc";function eu({style:e,className:t,nodeStrokeColor:r="transparent",nodeColor:o="#e2e2e2",nodeClassName:s="",nodeBorderRadius:c=5,nodeStrokeWidth:a=2,nodeComponent:l,maskColor:d="rgb(240, 240, 240, 0.6)",maskStrokeColor:p="none",maskStrokeWidth:m=1,position:g="bottom-right",onClick:v,onNodeClick:w,pannable:E=!1,zoomable:N=!1,ariaLabel:z="React Flow mini map",inversePan:P=!1,zoomStep:H=10,offsetScale:K=5}){const I=Ue(),Q=O.useRef(null),{boundingRect:G,viewBB:Y,rfId:te}=ze(Dm,Je),V=(e==null?void 0:e.width)??Rm,ie=(e==null?void 0:e.height)??jm,ee=G.width/V,se=G.height/ie,ae=Math.max(ee,se),b=ae*V,A=ae*ie,R=K*ae,Z=G.x-(b-G.width)/2-R,re=G.y-(A-G.height)/2-R,M=b+R*2,q=A+R*2,oe=`${Om}-${te}`,ce=O.useRef(0);ce.current=ae,O.useEffect(()=>{if(Q.current){const be=bt(Q.current),Se=de=>{const{transform:Re,d3Selection:He,d3Zoom:Ee}=I.getState();if(de.sourceEvent.type!=="wheel"||!He||!Ee)return;const qe=-de.sourceEvent.deltaY*(de.sourceEvent.deltaMode===1?.05:de.sourceEvent.deltaMode?1:.002)*H,Xe=Re[2]*Math.pow(2,qe);Ee.scaleTo(He,Xe)},Ie=de=>{const{transform:Re,d3Selection:He,d3Zoom:Ee,translateExtent:qe,width:Xe,height:$e}=I.getState();if(de.sourceEvent.type!=="mousemove"||!He||!Ee)return;const at=ce.current*Math.max(1,Re[2])*(P?-1:1),Oe={x:Re[0]-de.sourceEvent.movementX*at,y:Re[1]-de.sourceEvent.movementY*at},ke=[[0,0],[Xe,$e]],Qe=Jt.translate(Oe.x,Oe.y).scale(Re[2]),dt=Ee.constrain()(Qe,ke,qe);Ee.transform(He,dt)},De=ac().on("zoom",E?Ie:null).on("zoom.wheel",N?Se:null);return be.call(De),()=>{be.on("zoom",null)}}},[E,N,P,H]);const me=v?be=>{const Se=Ct(be);v(be,{x:Se[0],y:Se[1]})}:void 0,ve=w?(be,Se)=>{const Ie=I.getState().nodeInternals.get(Se);w(be,Ie)}:void 0;return J.createElement(kr,{position:g,style:e,className:et(["react-flow__minimap",t]),"data-testid":"rf__minimap"},J.createElement("svg",{width:V,height:ie,viewBox:`${Z} ${re} ${M} ${q}`,role:"img","aria-labelledby":oe,ref:Q,onClick:me},z&&J.createElement("title",{id:oe},z),J.createElement(Pm,{onClick:ve,nodeColor:o,nodeStrokeColor:r,nodeBorderRadius:c,nodeClassName:s,nodeStrokeWidth:a,nodeComponent:l}),J.createElement("path",{className:"react-flow__minimap-mask",d:`M${Z-R},${re-R}h${M+R*2}v${q+R*2}h${-M-R*2}z
        M${Y.x},${Y.y}h${Y.width}v${Y.height}h${-Y.width}z`,fill:d,fillRule:"evenodd",stroke:p,strokeWidth:m,pointerEvents:"none"})))}eu.displayName="MiniMap";var $m=O.memo(eu);function Bm(){return J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},J.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function zm(){return J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},J.createElement("path",{d:"M0 0h32v4.2H0z"}))}function Lm(){return J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},J.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function Fm(){return J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},J.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function Km(){return J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},J.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const gr=({children:e,className:t,...r})=>J.createElement("button",{type:"button",className:et(["react-flow__controls-button",t]),...r},e);gr.displayName="ControlButton";const Hm=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom}),tu=({style:e,showZoom:t=!0,showFitView:r=!0,showInteractive:o=!0,fitViewOptions:s,onZoomIn:c,onZoomOut:a,onFitView:l,onInteractiveChange:d,className:p,children:m,position:g="bottom-left"})=>{const v=Ue(),[w,E]=O.useState(!1),{isInteractive:N,minZoomReached:z,maxZoomReached:P}=ze(Hm,Je),{zoomIn:H,zoomOut:K,fitView:I}=rs();if(O.useEffect(()=>{E(!0)},[]),!w)return null;const Q=()=>{H(),c==null||c()},G=()=>{K(),a==null||a()},Y=()=>{I(s),l==null||l()},te=()=>{v.setState({nodesDraggable:!N,nodesConnectable:!N,elementsSelectable:!N}),d==null||d(!N)};return J.createElement(kr,{className:et(["react-flow__controls",p]),position:g,style:e,"data-testid":"rf__controls"},t&&J.createElement(J.Fragment,null,J.createElement(gr,{onClick:Q,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:P},J.createElement(Bm,null)),J.createElement(gr,{onClick:G,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:z},J.createElement(zm,null))),r&&J.createElement(gr,{className:"react-flow__controls-fitview",onClick:Y,title:"fit view","aria-label":"fit view"},J.createElement(Lm,null)),o&&J.createElement(gr,{className:"react-flow__controls-interactive",onClick:te,title:"toggle interactivity","aria-label":"toggle interactivity"},N?J.createElement(Km,null):J.createElement(Fm,null)),m)};tu.displayName="Controls";var Wm=O.memo(tu),Tt;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Tt||(Tt={}));function qm({color:e,dimensions:t,lineWidth:r}){return J.createElement("path",{stroke:e,strokeWidth:r,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`})}function Vm({color:e,radius:t}){return J.createElement("circle",{cx:t,cy:t,r:t,fill:e})}const Ym={[Tt.Dots]:"#91919a",[Tt.Lines]:"#eee",[Tt.Cross]:"#e2e2e2"},Um={[Tt.Dots]:1,[Tt.Lines]:1,[Tt.Cross]:6},Xm=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function nu({id:e,variant:t=Tt.Dots,gap:r=20,size:o,lineWidth:s=1,offset:c=2,color:a,style:l,className:d}){const p=O.useRef(null),{transform:m,patternId:g}=ze(Xm,Je),v=a||Ym[t],w=o||Um[t],E=t===Tt.Dots,N=t===Tt.Cross,z=Array.isArray(r)?r:[r,r],P=[z[0]*m[2]||1,z[1]*m[2]||1],H=w*m[2],K=N?[H,H]:P,I=E?[H/c,H/c]:[K[0]/c,K[1]/c];return J.createElement("svg",{className:et(["react-flow__background",d]),style:{...l,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:p,"data-testid":"rf__background"},J.createElement("pattern",{id:g+e,x:m[0]%P[0],y:m[1]%P[1],width:P[0],height:P[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${I[0]},-${I[1]})`},E?J.createElement(Vm,{color:v,radius:H/c}):J.createElement(qm,{dimensions:K,color:v,lineWidth:s})),J.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${g+e})`}))}nu.displayName="Background";var Gm=O.memo(nu);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Zm={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jm=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Po=(e,t)=>{const r=O.forwardRef(({color:o="currentColor",size:s=24,strokeWidth:c=2,absoluteStrokeWidth:a,className:l="",children:d,...p},m)=>O.createElement("svg",{ref:m,...Zm,width:s,height:s,stroke:o,strokeWidth:a?Number(c)*24/Number(s):c,className:["lucide",`lucide-${Jm(e)}`,l].join(" "),...p},[...t.map(([g,v])=>O.createElement(g,v)),...Array.isArray(d)?d:[d]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qm=Po("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ey=Po("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ty=Po("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=Po("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function ru(e){var t,r,o="";if(typeof e=="string"||typeof e=="number")o+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(r=ru(e[t]))&&(o&&(o+=" "),o+=r)}else for(r in e)e[r]&&(o&&(o+=" "),o+=r);return o}function Ft(){for(var e,t,r=0,o="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=ru(e))&&(o&&(o+=" "),o+=t);return o}const ou=(e,t)=>{if(!e||!t)return null;const r=new Date(e),s=new Date(t).getTime()-r.getTime(),c=Math.floor(s/1e3),a=Math.floor(c/60),l=Math.floor(a/60),d=[];return l>0&&d.push(`${l}h`),a%60>0&&d.push(`${a%60}m`),c%60>0&&d.push(`${c%60}s`),s%1e3>0&&d.push(`${s%1e3}ms`),d.join(" ")},xi=e=>{var t;switch((t=e.status)==null?void 0:t.toLowerCase()){case"completed":return"border-green-500";case"running":return"border-blue-500";case"retrying":return"border-orange-600";case"pending":return"border-purple-600";case"terminated":return"border-yellow-500";case"failed":return"border-red-600";default:return"border-gray-500"}},ny=(e,t=50)=>e?e.length<=t?e:e.slice(0,t)+"...":"",ry=e=>{switch(e==null?void 0:e.toLowerCase()){case"completed":return"text-green-600 bg-green-50";case"retrying":return"text-orange-700 bg-orange-100";case"running":return"text-blue-600 bg-blue-50";case"pending":return"text-purple-700 bg-purple-100";case"terminated":return"text-yellow-600 bg-yellow-50";case"failed":return"text-red-700 bg-red-100";default:return"text-gray-600 bg-gray-50"}};function oy({id:e,data:t,expandChildWorkflowNode:r,collapseChildWorkflowNode:o,onShowNodeData:s,onSpreadBatchNodes:c}){var m;const a=t.type==="workflow"||t.type==="childWorkflow",l=t.count&&t.count>1,d=`${e}-${t.type}-${t.workflowId||""}-${t.runId||""}`,p=async()=>{t.count===1&&a&&!t.isLoading&&(t.isExpanded?await o(e,t.runId):await r(e,t.runId))};return _.jsxs("div",{className:"relative min-w-[450px]",children:[_.jsx(pn,{type:"source",position:_e.Right,id:`${e}-right`,style:{top:"50%",transform:"translateY(-50%)"}}),_.jsx(pn,{type:"target",position:_e.Left,id:`${e}-left`,style:{top:"50%",transform:"translateY(-50%)"}}),_.jsx(pn,{type:"source",position:_e.Bottom,id:`${e}-bottom`,style:{left:"25px"}}),_.jsx(pn,{type:"target",position:_e.Top,id:`${e}-top`,style:{left:"25px"}}),_.jsxs("div",{className:"relative",children:[l&&_.jsxs(_.Fragment,{children:[_.jsx("div",{className:Ft("absolute rounded-xl shadow-lg border-2 transition-all duration-300",xi(t),"opacity-40"),style:{top:"-8px",left:"-8px",width:"100%",height:"100%",pointerEvents:"none"},children:_.jsx("div",{className:"p-4 bg-white rounded-xl"})}),_.jsx("div",{className:Ft("absolute rounded-xl shadow-lg border-2 transition-all duration-300",xi(t),"opacity-70"),style:{top:"-4px",left:"-4px",width:"100%",height:"100%",pointerEvents:"none"},children:_.jsx("div",{className:"p-4 bg-white rounded-xl"})})]}),_.jsx("div",{className:Ft("rounded-xl shadow-lg border-2 transition-all duration-300 relative",xi(t),t.isLoading&&"opacity-75"),children:_.jsxs("div",{className:Ft("p-4 relative bg-white rounded-xl",a&&!t.isLoading&&!l&&"cursor-pointer",t.isLoading&&"pointer-events-none"),onClick:p,children:[_.jsxs("div",{className:"absolute -top-2.5 -right-2.5 flex gap-1",children:[l&&_.jsx("div",{onClick:g=>{g.stopPropagation(),o(e,t.runId),c==null||c(e)},className:"w-6 h-6 flex items-center justify-center bg-blue-500 hover:bg-blue-600 rounded-full text-white shadow-lg z-10 cursor-pointer",children:_.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",strokeWidth:2,viewBox:"0 0 24 24",children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11 4.5a6.5 6.5 0 1 0 4.135 11.286l3.572 3.572a1 1 0 0 0 1.414-1.414l-3.572-3.572A6.5 6.5 0 0 0 11 4.5z"})})}),!l&&_.jsx("div",{onClick:g=>{g.stopPropagation();const v=g.currentTarget.closest(".relative");if(v){const w=v.getBoundingClientRect();s(t,{x:w.left+w.width/2,y:w.top})}},className:"w-6 h-6 flex items-center justify-center bg-gray-500 hover:bg-gray-600 rounded-full text-white shadow-lg z-10 cursor-pointer",children:_.jsx(ey,{className:"w-3 h-3"})})]}),_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx("div",{className:Ft("w-8 h-8 rounded flex items-center justify-center flex-shrink-0",a?"bg-amber-50":"bg-fuchsia-50"),children:a?_.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[_.jsx("rect",{x:"9",y:"3",width:"6",height:"6",rx:"1"}),_.jsx("rect",{x:"3",y:"15",width:"6",height:"6",rx:"1"}),_.jsx("rect",{x:"15",y:"15",width:"6",height:"6",rx:"1"}),_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3M6 15v-3h12v3"})]}):_.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:_.jsx("path",{d:"M5 12L12 5L19 12L12 19L5 12Z"})})}),_.jsxs("div",{className:Ft("min-w-0",a?"":"flex items-center h-[2.5rem]"),children:[_.jsx("h3",{className:"font-semibold text-gray-800 truncate",children:t.title}),a&&_.jsx("p",{className:"text-xs text-gray-500 overflow-hidden text-ellipsis",children:ny(e)})]})]}),_.jsxs("div",{className:"absolute -top-3 left-3 flex gap-2",children:[_.jsx("div",{className:"px-2 py-0.5 rounded text-xs font-medium shadow-sm z-10",style:{backgroundColor:a?"rgb(254 243 199)":"rgb(253 244 255)",color:a?"rgb(217 119 6)":"rgb(192 38 211)"},children:a?"workflow":"activity"}),_.jsx("div",{className:Ft("px-2 py-0.5 rounded text-xs font-medium shadow-sm z-10",ry(t.status)),children:((m=t.status)==null?void 0:m.toLowerCase())||"unknown"}),l&&_.jsxs("div",{className:"px-2 py-0.5 rounded text-xs font-medium shadow-sm z-10",style:{backgroundColor:"rgba(224, 242, 254, 0.9)",color:"#0369a1"},children:["batch: ",t.count]}),t.startTime&&t.endTime&&_.jsx("div",{className:"px-2 py-0.5 rounded text-xs font-medium shadow-sm z-10",style:{backgroundColor:"rgba(236, 254, 255, 0.9)",color:"#0891b2"},children:ou(t.startTime,t.endTime)})]}),t.taskQueue&&_.jsx("div",{className:"absolute -bottom-2.5 right-2",children:_.jsx("div",{className:"px-2 py-0.5 rounded text-xs font-medium shadow-sm",style:{backgroundColor:"rgba(240, 253, 244, 0.9)",color:"#166534",fontSize:"0.7rem"},children:t.taskQueue?t.taskQueue.name:""})}),t.isLoading&&_.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-50 flex items-center justify-center z-20",children:_.jsx("div",{className:"bg-white p-2 rounded-full shadow-lg",children:_.jsx(Qm,{className:"w-5 h-5 text-blue-500 animate-spin"})})})]})})]})]},d)}function iy({nodes:e,onFocusChange:t,selectedWorkflow:r,onReset:o,onClose:s}){const[c,a]=O.useState(288),l=O.useRef(null),d=O.useRef(null),p=O.useRef(!1),m=e.filter(w=>w.data.type==="workflow"||w.data.type==="childWorkflow"),g=w=>{t(r===w?null:w)};O.useEffect(()=>{const w=N=>{if(!p.current||!d.current)return;const z=N.clientX-d.current.getBoundingClientRect().left;z>200&&z<600&&a(z)},E=()=>{p.current&&(p.current=!1,document.body.style.cursor="default")};return window.addEventListener("mousemove",w),window.addEventListener("mouseup",E),()=>{window.removeEventListener("mousemove",w),window.removeEventListener("mouseup",E)}},[]);const v=w=>{w.preventDefault(),p.current=!0,document.body.style.cursor="col-resize"};return _.jsxs("div",{ref:d,className:"absolute left-0 top-0 bottom-0 bg-white shadow-lg border-r z-10",style:{width:`${c}px`},children:[_.jsxs("div",{className:"p-4 border-b flex items-center justify-between bg-gray-50",children:[_.jsx("h3",{className:"font-semibold text-gray-800",children:"Focus Workflow"}),_.jsx("button",{onClick:s,className:"p-1 hover:bg-gray-200 rounded-full transition-colors",children:_.jsx(is,{className:"w-5 h-5 text-gray-600"})})]}),_.jsxs("div",{className:"p-4 overflow-y-auto",children:[_.jsx("button",{onClick:o,className:"w-full mb-4 px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-md transition-colors",children:"Reset View"}),_.jsx("div",{className:"space-y-2",children:m.map(w=>_.jsx("button",{onClick:()=>g(w.id),className:Ft("w-full px-3 py-2 text-left rounded-md transition-colors","text-sm",r===w.id?"bg-blue-50 text-blue-700 font-medium":"text-gray-700 hover:bg-gray-50"),children:w.data.title},w.id))})]}),_.jsx("div",{ref:l,onMouseDown:v,className:"w-1 cursor-col-resize hover:bg-gray-300 absolute top-0 right-0 bottom-0"})]})}var iu={exports:{}};(function(e,t){(function(r,o){e.exports=o()})(Ms,function(){var r=function(n,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,f){u.__proto__=f}||function(u,f){for(var h in f)Object.prototype.hasOwnProperty.call(f,h)&&(u[h]=f[h])})(n,i)},o=function(){return(o=Object.assign||function(n){for(var i,u=1,f=arguments.length;u<f;u++)for(var h in i=arguments[u])Object.prototype.hasOwnProperty.call(i,h)&&(n[h]=i[h]);return n}).apply(this,arguments)};function s(n,i,u){for(var f,h=0,y=i.length;h<y;h++)!f&&h in i||((f=f||Array.prototype.slice.call(i,0,h))[h]=i[h]);return n.concat(f||Array.prototype.slice.call(i))}var c=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Ms,a=Object.keys,l=Array.isArray;function d(n,i){return typeof i!="object"||a(i).forEach(function(u){n[u]=i[u]}),n}typeof Promise>"u"||c.Promise||(c.Promise=Promise);var p=Object.getPrototypeOf,m={}.hasOwnProperty;function g(n,i){return m.call(n,i)}function v(n,i){typeof i=="function"&&(i=i(p(n))),(typeof Reflect>"u"?a:Reflect.ownKeys)(i).forEach(function(u){E(n,u,i[u])})}var w=Object.defineProperty;function E(n,i,u,f){w(n,i,d(u&&g(u,"get")&&typeof u.get=="function"?{get:u.get,set:u.set,configurable:!0}:{value:u,configurable:!0,writable:!0},f))}function N(n){return{from:function(i){return n.prototype=Object.create(i.prototype),E(n.prototype,"constructor",n),{extend:v.bind(null,n.prototype)}}}}var z=Object.getOwnPropertyDescriptor,P=[].slice;function H(n,i,u){return P.call(n,i,u)}function K(n,i){return i(n)}function I(n){if(!n)throw new Error("Assertion Failed")}function Q(n){c.setImmediate?setImmediate(n):setTimeout(n,0)}function G(n,i){if(typeof i=="string"&&g(n,i))return n[i];if(!i)return n;if(typeof i!="string"){for(var u=[],f=0,h=i.length;f<h;++f){var y=G(n,i[f]);u.push(y)}return u}var x=i.indexOf(".");if(x!==-1){var k=n[i.substr(0,x)];return k==null?void 0:G(k,i.substr(x+1))}}function Y(n,i,u){if(n&&i!==void 0&&!("isFrozen"in Object&&Object.isFrozen(n)))if(typeof i!="string"&&"length"in i){I(typeof u!="string"&&"length"in u);for(var f=0,h=i.length;f<h;++f)Y(n,i[f],u[f])}else{var y,x,k=i.indexOf(".");k!==-1?(y=i.substr(0,k),(x=i.substr(k+1))===""?u===void 0?l(n)&&!isNaN(parseInt(y))?n.splice(y,1):delete n[y]:n[y]=u:Y(k=!(k=n[y])||!g(n,y)?n[y]={}:k,x,u)):u===void 0?l(n)&&!isNaN(parseInt(i))?n.splice(i,1):delete n[i]:n[i]=u}}function te(n){var i,u={};for(i in n)g(n,i)&&(u[i]=n[i]);return u}var V=[].concat;function ie(n){return V.apply([],n)}var Ut="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(ie([8,16,32,64].map(function(n){return["Int","Uint","Float"].map(function(i){return i+n+"Array"})}))).filter(function(n){return c[n]}),ee=new Set(Ut.map(function(n){return c[n]})),se=null;function ae(n){return se=new WeakMap,n=function i(u){if(!u||typeof u!="object")return u;var f=se.get(u);if(f)return f;if(l(u)){f=[],se.set(u,f);for(var h=0,y=u.length;h<y;++h)f.push(i(u[h]))}else if(ee.has(u.constructor))f=u;else{var x,k=p(u);for(x in f=k===Object.prototype?{}:Object.create(k),se.set(u,f),u)g(u,x)&&(f[x]=i(u[x]))}return f}(n),se=null,n}var b={}.toString;function A(n){return b.call(n).slice(8,-1)}var R=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Z=typeof R=="symbol"?function(n){var i;return n!=null&&(i=n[R])&&i.apply(n)}:function(){return null};function re(n,i){return i=n.indexOf(i),0<=i&&n.splice(i,1),0<=i}var M={};function q(n){var i,u,f,h;if(arguments.length===1){if(l(n))return n.slice();if(this===M&&typeof n=="string")return[n];if(h=Z(n)){for(u=[];!(f=h.next()).done;)u.push(f.value);return u}if(n==null)return[n];if(typeof(i=n.length)!="number")return[n];for(u=new Array(i);i--;)u[i]=n[i];return u}for(i=arguments.length,u=new Array(i);i--;)u[i]=arguments[i];return u}var oe=typeof Symbol<"u"?function(n){return n[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},vt=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],xt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(vt),ce={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function me(n,i){this.name=n,this.message=i}function ve(n,i){return n+". Errors: "+Object.keys(i).map(function(u){return i[u].toString()}).filter(function(u,f,h){return h.indexOf(u)===f}).join(`
`)}function be(n,i,u,f){this.failures=i,this.failedKeys=f,this.successCount=u,this.message=ve(n,i)}function Se(n,i){this.name="BulkError",this.failures=Object.keys(i).map(function(u){return i[u]}),this.failuresByPos=i,this.message=ve(n,this.failures)}N(me).from(Error).extend({toString:function(){return this.name+": "+this.message}}),N(be).from(me),N(Se).from(me);var Ie=xt.reduce(function(n,i){return n[i]=i+"Error",n},{}),De=me,de=xt.reduce(function(n,i){var u=i+"Error";function f(h,y){this.name=u,h?typeof h=="string"?(this.message="".concat(h).concat(y?`
 `+y:""),this.inner=y||null):typeof h=="object"&&(this.message="".concat(h.name," ").concat(h.message),this.inner=h):(this.message=ce[i]||u,this.inner=null)}return N(f).from(De),n[i]=f,n},{});de.Syntax=SyntaxError,de.Type=TypeError,de.Range=RangeError;var Re=vt.reduce(function(n,i){return n[i+"Error"]=de[i],n},{}),He=xt.reduce(function(n,i){return["Syntax","Type","Range"].indexOf(i)===-1&&(n[i+"Error"]=de[i]),n},{});function Ee(){}function qe(n){return n}function Xe(n,i){return n==null||n===qe?i:function(u){return i(n(u))}}function $e(n,i){return function(){n.apply(this,arguments),i.apply(this,arguments)}}function at(n,i){return n===Ee?i:function(){var u=n.apply(this,arguments);u!==void 0&&(arguments[0]=u);var f=this.onsuccess,h=this.onerror;this.onsuccess=null,this.onerror=null;var y=i.apply(this,arguments);return f&&(this.onsuccess=this.onsuccess?$e(f,this.onsuccess):f),h&&(this.onerror=this.onerror?$e(h,this.onerror):h),y!==void 0?y:u}}function Oe(n,i){return n===Ee?i:function(){n.apply(this,arguments);var u=this.onsuccess,f=this.onerror;this.onsuccess=this.onerror=null,i.apply(this,arguments),u&&(this.onsuccess=this.onsuccess?$e(u,this.onsuccess):u),f&&(this.onerror=this.onerror?$e(f,this.onerror):f)}}function ke(n,i){return n===Ee?i:function(u){var f=n.apply(this,arguments);d(u,f);var h=this.onsuccess,y=this.onerror;return this.onsuccess=null,this.onerror=null,u=i.apply(this,arguments),h&&(this.onsuccess=this.onsuccess?$e(h,this.onsuccess):h),y&&(this.onerror=this.onerror?$e(y,this.onerror):y),f===void 0?u===void 0?void 0:u:d(f,u)}}function Qe(n,i){return n===Ee?i:function(){return i.apply(this,arguments)!==!1&&n.apply(this,arguments)}}function dt(n,i){return n===Ee?i:function(){var u=n.apply(this,arguments);if(u&&typeof u.then=="function"){for(var f=this,h=arguments.length,y=new Array(h);h--;)y[h]=arguments[h];return u.then(function(){return i.apply(f,y)})}return i.apply(this,arguments)}}He.ModifyError=be,He.DexieError=me,He.BulkError=Se;var tt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function qt(n){tt=n}var yt={},gt=100,Ut=typeof Promise>"u"?[]:function(){var n=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[n,p(n),n];var i=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[i,p(i),n]}(),vt=Ut[0],xt=Ut[1],Ut=Ut[2],xt=xt&&xt.then,ct=vt&&vt.constructor,kt=!!Ut,wt=function(n,i){ut.push([n,i]),Pt&&(queueMicrotask(jo),Pt=!1)},Mt=!0,Pt=!0,Fe=[],nt=[],Et=qe,rt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Ee,pgp:!1,env:{},finalize:Ee},xe=rt,ut=[],Ge=0,Rt=[];function ye(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var i=this._PSD=xe;if(typeof n!="function"){if(n!==yt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Cn(this,this._value))}this._state=null,this._value=null,++i.ref,function u(f,h){try{h(function(y){if(f._state===null){if(y===f)throw new TypeError("A promise cannot be resolved with itself.");var x=f._lib&&tn();y&&typeof y.then=="function"?u(f,function(k,C){y instanceof ye?y._then(k,C):y.then(k,C)}):(f._state=!0,f._value=y,jt(f)),x&&nn()}},Cn.bind(null,f))}catch(y){Cn(f,y)}}(this,n)}var Vt={get:function(){var n=xe,i=Mn;function u(f,h){var y=this,x=!n.global&&(n!==xe||i!==Mn),k=x&&!St(),C=new ye(function(j,B){Gn(y,new Nn(Rr(f,n,x,k),Rr(h,n,x,k),j,B,n))});return this._consoleTask&&(C._consoleTask=this._consoleTask),C}return u.prototype=yt,u},set:function(n){E(this,"then",n&&n.prototype===yt?Vt:{get:function(){return n},set:Vt.set})}};function Nn(n,i,u,f,h){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof i=="function"?i:null,this.resolve=u,this.reject=f,this.psd=h}function Cn(n,i){var u,f;nt.push(i),n._state===null&&(u=n._lib&&tn(),i=Et(i),n._state=!1,n._value=i,f=n,Fe.some(function(h){return h._value===f._value})||Fe.push(f),jt(n),u&&nn())}function jt(n){var i=n._listeners;n._listeners=[];for(var u=0,f=i.length;u<f;++u)Gn(n,i[u]);var h=n._PSD;--h.ref||h.finalize(),Ge===0&&(++Ge,wt(function(){--Ge==0&&Zn()},[]))}function Gn(n,i){if(n._state!==null){var u=n._state?i.onFulfilled:i.onRejected;if(u===null)return(n._state?i.resolve:i.reject)(n._value);++i.psd.ref,++Ge,wt(Ro,[u,n,i])}else n._listeners.push(i)}function Ro(n,i,u){try{var f,h=i._value;!i._state&&nt.length&&(nt=[]),f=tt&&i._consoleTask?i._consoleTask.run(function(){return n(h)}):n(h),i._state||nt.indexOf(h)!==-1||function(y){for(var x=Fe.length;x;)if(Fe[--x]._value===y._value)return Fe.splice(x,1)}(i),u.resolve(f)}catch(y){u.reject(y)}finally{--Ge==0&&Zn(),--u.psd.ref||u.psd.finalize()}}function jo(){Yt(rt,function(){tn()&&nn()})}function tn(){var n=Mt;return Pt=Mt=!1,n}function nn(){var n,i,u;do for(;0<ut.length;)for(n=ut,ut=[],u=n.length,i=0;i<u;++i){var f=n[i];f[0].apply(null,f[1])}while(0<ut.length);Pt=Mt=!0}function Zn(){var n=Fe;Fe=[],n.forEach(function(f){f._PSD.onunhandled.call(null,f._value,f)});for(var i=Rt.slice(0),u=i.length;u;)i[--u]()}function In(n){return new ye(yt,!1,n)}function Be(n,i){var u=xe;return function(){var f=tn(),h=xe;try{return Ot(u,!0),n.apply(this,arguments)}catch(y){i&&i(y)}finally{Ot(h,!1),f&&nn()}}}v(ye.prototype,{then:Vt,_then:function(n,i){Gn(this,new Nn(null,null,n,i,xe))},catch:function(n){if(arguments.length===1)return this.then(null,n);var i=n,u=arguments[1];return typeof i=="function"?this.then(null,function(f){return(f instanceof i?u:In)(f)}):this.then(null,function(f){return(f&&f.name===i?u:In)(f)})},finally:function(n){return this.then(function(i){return ye.resolve(n()).then(function(){return i})},function(i){return ye.resolve(n()).then(function(){return In(i)})})},timeout:function(n,i){var u=this;return n<1/0?new ye(function(f,h){var y=setTimeout(function(){return h(new de.Timeout(i))},n);u.then(f,h).finally(clearTimeout.bind(null,y))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&E(ye.prototype,Symbol.toStringTag,"Dexie.Promise"),rt.env=Pr(),v(ye,{all:function(){var n=q.apply(null,arguments).map(Pn);return new ye(function(i,u){n.length===0&&i([]);var f=n.length;n.forEach(function(h,y){return ye.resolve(h).then(function(x){n[y]=x,--f||i(n)},u)})})},resolve:function(n){return n instanceof ye?n:n&&typeof n.then=="function"?new ye(function(i,u){n.then(i,u)}):new ye(yt,!0,n)},reject:In,race:function(){var n=q.apply(null,arguments).map(Pn);return new ye(function(i,u){n.map(function(f){return ye.resolve(f).then(i,u)})})},PSD:{get:function(){return xe},set:function(n){return xe=n}},totalEchoes:{get:function(){return Mn}},newPSD:Dt,usePSD:Yt,scheduler:{get:function(){return wt},set:function(n){wt=n}},rejectionMapper:{get:function(){return Et},set:function(n){Et=n}},follow:function(n,i){return new ye(function(u,f){return Dt(function(h,y){var x=xe;x.unhandleds=[],x.onunhandled=y,x.finalize=$e(function(){var k,C=this;k=function(){C.unhandleds.length===0?h():y(C.unhandleds[0])},Rt.push(function j(){k(),Rt.splice(Rt.indexOf(j),1)}),++Ge,wt(function(){--Ge==0&&Zn()},[])},x.finalize),n()},i,u,f)})}}),ct&&(ct.allSettled&&E(ye,"allSettled",function(){var n=q.apply(null,arguments).map(Pn);return new ye(function(i){n.length===0&&i([]);var u=n.length,f=new Array(u);n.forEach(function(h,y){return ye.resolve(h).then(function(x){return f[y]={status:"fulfilled",value:x}},function(x){return f[y]={status:"rejected",reason:x}}).then(function(){return--u||i(f)})})})}),ct.any&&typeof AggregateError<"u"&&E(ye,"any",function(){var n=q.apply(null,arguments).map(Pn);return new ye(function(i,u){n.length===0&&u(new AggregateError([]));var f=n.length,h=new Array(f);n.forEach(function(y,x){return ye.resolve(y).then(function(k){return i(k)},function(k){h[x]=k,--f||u(new AggregateError(h))})})})}),ct.withResolvers&&(ye.withResolvers=ct.withResolvers));var Ye={awaits:0,echoes:0,id:0},Do=0,Tn=[],An=0,Mn=0,Oo=0;function Dt(n,i,u,f){var h=xe,y=Object.create(h);return y.parent=h,y.ref=0,y.global=!1,y.id=++Oo,rt.env,y.env=kt?{Promise:ye,PromiseProp:{value:ye,configurable:!0,writable:!0},all:ye.all,race:ye.race,allSettled:ye.allSettled,any:ye.any,resolve:ye.resolve,reject:ye.reject}:{},i&&d(y,i),++h.ref,y.finalize=function(){--this.parent.ref||this.parent.finalize()},f=Yt(y,n,u,f),y.ref===0&&y.finalize(),f}function rn(){return Ye.id||(Ye.id=++Do),++Ye.awaits,Ye.echoes+=gt,Ye.id}function St(){return!!Ye.awaits&&(--Ye.awaits==0&&(Ye.id=0),Ye.echoes=Ye.awaits*gt,!0)}function Pn(n){return Ye.echoes&&n&&n.constructor===ct?(rn(),n.then(function(i){return St(),i},function(i){return St(),Ke(i)})):n}function $o(){var n=Tn[Tn.length-1];Tn.pop(),Ot(n,!1)}function Ot(n,i){var u,f=xe;(i?!Ye.echoes||An++&&n===xe:!An||--An&&n===xe)||queueMicrotask(i?(function(h){++Mn,Ye.echoes&&--Ye.echoes!=0||(Ye.echoes=Ye.awaits=Ye.id=0),Tn.push(xe),Ot(h,!0)}).bind(null,n):$o),n!==xe&&(xe=n,f===rt&&(rt.env=Pr()),kt&&(u=rt.env.Promise,i=n.env,(f.global||n.global)&&(Object.defineProperty(c,"Promise",i.PromiseProp),u.all=i.all,u.race=i.race,u.resolve=i.resolve,u.reject=i.reject,i.allSettled&&(u.allSettled=i.allSettled),i.any&&(u.any=i.any))))}function Pr(){var n=c.Promise;return kt?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(c,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject}:{}}function Yt(n,i,u,f,h){var y=xe;try{return Ot(n,!0),i(u,f,h)}finally{Ot(y,!1)}}function Rr(n,i,u,f){return typeof n!="function"?n:function(){var h=xe;u&&rn(),Ot(i,!0);try{return n.apply(this,arguments)}finally{Ot(h,!1),f&&queueMicrotask(St)}}}function Jn(n){Promise===ct&&Ye.echoes===0?An===0?n():enqueueNativeMicroTask(n):setTimeout(n,0)}(""+xt).indexOf("[native code]")===-1&&(rn=St=Ee);var Ke=ye.reject,$t="￿",Nt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",jr="String expected.",on=[],Rn="__dbnames",Qn="readonly",er="readwrite";function Bt(n,i){return n?i?function(){return n.apply(this,arguments)&&i.apply(this,arguments)}:n:i}var Dr={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function jn(n){return typeof n!="string"||/\./.test(n)?function(i){return i}:function(i){return i[n]===void 0&&n in i&&delete(i=ae(i))[n],i}}function Or(){throw de.Type()}function Te(n,i){try{var u=as(n),f=as(i);if(u!==f)return u==="Array"?1:f==="Array"?-1:u==="binary"?1:f==="binary"?-1:u==="string"?1:f==="string"?-1:u==="Date"?1:f!=="Date"?NaN:-1;switch(u){case"number":case"Date":case"string":return i<n?1:n<i?-1:0;case"binary":return function(h,y){for(var x=h.length,k=y.length,C=x<k?x:k,j=0;j<C;++j)if(h[j]!==y[j])return h[j]<y[j]?-1:1;return x===k?0:x<k?-1:1}(cs(n),cs(i));case"Array":return function(h,y){for(var x=h.length,k=y.length,C=x<k?x:k,j=0;j<C;++j){var B=Te(h[j],y[j]);if(B!==0)return B}return x===k?0:x<k?-1:1}(n,i)}}catch{}return NaN}function as(n){var i=typeof n;return i!="object"?i:ArrayBuffer.isView(n)?"binary":(n=A(n),n==="ArrayBuffer"?"binary":n)}function cs(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}var us=(Le.prototype._trans=function(n,i,u){var f=this._tx||xe.trans,h=this.name,y=tt&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(n==="readonly"?"read":"write"," ").concat(this.name));function x(j,B,S){if(!S.schema[h])throw new de.NotFound("Table "+h+" not part of transaction");return i(S.idbtrans,S)}var k=tn();try{var C=f&&f.db._novip===this.db._novip?f===xe.trans?f._promise(n,x,u):Dt(function(){return f._promise(n,x,u)},{trans:f,transless:xe.transless||xe}):function j(B,S,F,T){if(B.idbdb&&(B._state.openComplete||xe.letThrough||B._vip)){var $=B._createTransaction(S,F,B._dbSchema);try{$.create(),B._state.PR1398_maxLoop=3}catch(L){return L.name===Ie.InvalidState&&B.isOpen()&&0<--B._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),B.close({disableAutoOpen:!1}),B.open().then(function(){return j(B,S,F,T)})):Ke(L)}return $._promise(S,function(L,D){return Dt(function(){return xe.trans=$,T(L,D,$)})}).then(function(L){if(S==="readwrite")try{$.idbtrans.commit()}catch{}return S==="readonly"?L:$._completion.then(function(){return L})})}if(B._state.openComplete)return Ke(new de.DatabaseClosed(B._state.dbOpenError));if(!B._state.isBeingOpened){if(!B._state.autoOpen)return Ke(new de.DatabaseClosed);B.open().catch(Ee)}return B._state.dbReadyPromise.then(function(){return j(B,S,F,T)})}(this.db,n,[this.name],x);return y&&(C._consoleTask=y,C=C.catch(function(j){return console.trace(j),Ke(j)})),C}finally{k&&nn()}},Le.prototype.get=function(n,i){var u=this;return n&&n.constructor===Object?this.where(n).first(i):n==null?Ke(new de.Type("Invalid argument to Table.get()")):this._trans("readonly",function(f){return u.core.get({trans:f,key:n}).then(function(h){return u.hook.reading.fire(h)})}).then(i)},Le.prototype.where=function(n){if(typeof n=="string")return new this.db.WhereClause(this,n);if(l(n))return new this.db.WhereClause(this,"[".concat(n.join("+"),"]"));var i=a(n);if(i.length===1)return this.where(i[0]).equals(n[i[0]]);var u=this.schema.indexes.concat(this.schema.primKey).filter(function(k){if(k.compound&&i.every(function(j){return 0<=k.keyPath.indexOf(j)})){for(var C=0;C<i.length;++C)if(i.indexOf(k.keyPath[C])===-1)return!1;return!0}return!1}).sort(function(k,C){return k.keyPath.length-C.keyPath.length})[0];if(u&&this.db._maxKey!==$t){var y=u.keyPath.slice(0,i.length);return this.where(y).equals(y.map(function(C){return n[C]}))}!u&&tt&&console.warn("The query ".concat(JSON.stringify(n)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(i.join("+"),"]"));var f=this.schema.idxByName;function h(k,C){return Te(k,C)===0}var x=i.reduce(function(S,C){var j=S[0],B=S[1],S=f[C],F=n[C];return[j||S,j||!S?Bt(B,S&&S.multi?function(T){return T=G(T,C),l(T)&&T.some(function($){return h(F,$)})}:function(T){return h(F,G(T,C))}):B]},[null,null]),y=x[0],x=x[1];return y?this.where(y.name).equals(n[y.keyPath]).filter(x):u?this.filter(x):this.where(i).equals("")},Le.prototype.filter=function(n){return this.toCollection().and(n)},Le.prototype.count=function(n){return this.toCollection().count(n)},Le.prototype.offset=function(n){return this.toCollection().offset(n)},Le.prototype.limit=function(n){return this.toCollection().limit(n)},Le.prototype.each=function(n){return this.toCollection().each(n)},Le.prototype.toArray=function(n){return this.toCollection().toArray(n)},Le.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Le.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,l(n)?"[".concat(n.join("+"),"]"):n))},Le.prototype.reverse=function(){return this.toCollection().reverse()},Le.prototype.mapToClass=function(n){var i,u=this.db,f=this.name;function h(){return i!==null&&i.apply(this,arguments)||this}(this.schema.mappedClass=n).prototype instanceof Or&&(function(C,j){if(typeof j!="function"&&j!==null)throw new TypeError("Class extends value "+String(j)+" is not a constructor or null");function B(){this.constructor=C}r(C,j),C.prototype=j===null?Object.create(j):(B.prototype=j.prototype,new B)}(h,i=n),Object.defineProperty(h.prototype,"db",{get:function(){return u},enumerable:!1,configurable:!0}),h.prototype.table=function(){return f},n=h);for(var y=new Set,x=n.prototype;x;x=p(x))Object.getOwnPropertyNames(x).forEach(function(C){return y.add(C)});function k(C){if(!C)return C;var j,B=Object.create(n.prototype);for(j in C)if(!y.has(j))try{B[j]=C[j]}catch{}return B}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=k,this.hook("reading",k),n},Le.prototype.defineClass=function(){return this.mapToClass(function(n){d(this,n)})},Le.prototype.add=function(n,i){var u=this,f=this.schema.primKey,h=f.auto,y=f.keyPath,x=n;return y&&h&&(x=jn(y)(n)),this._trans("readwrite",function(k){return u.core.mutate({trans:k,type:"add",keys:i!=null?[i]:null,values:[x]})}).then(function(k){return k.numFailures?ye.reject(k.failures[0]):k.lastResult}).then(function(k){if(y)try{Y(n,y,k)}catch{}return k})},Le.prototype.update=function(n,i){return typeof n!="object"||l(n)?this.where(":id").equals(n).modify(i):(n=G(n,this.schema.primKey.keyPath),n===void 0?Ke(new de.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(i))},Le.prototype.put=function(n,i){var u=this,f=this.schema.primKey,h=f.auto,y=f.keyPath,x=n;return y&&h&&(x=jn(y)(n)),this._trans("readwrite",function(k){return u.core.mutate({trans:k,type:"put",values:[x],keys:i!=null?[i]:null})}).then(function(k){return k.numFailures?ye.reject(k.failures[0]):k.lastResult}).then(function(k){if(y)try{Y(n,y,k)}catch{}return k})},Le.prototype.delete=function(n){var i=this;return this._trans("readwrite",function(u){return i.core.mutate({trans:u,type:"delete",keys:[n]})}).then(function(u){return u.numFailures?ye.reject(u.failures[0]):void 0})},Le.prototype.clear=function(){var n=this;return this._trans("readwrite",function(i){return n.core.mutate({trans:i,type:"deleteRange",range:Dr})}).then(function(i){return i.numFailures?ye.reject(i.failures[0]):void 0})},Le.prototype.bulkGet=function(n){var i=this;return this._trans("readonly",function(u){return i.core.getMany({keys:n,trans:u}).then(function(f){return f.map(function(h){return i.hook.reading.fire(h)})})})},Le.prototype.bulkAdd=function(n,i,u){var f=this,h=Array.isArray(i)?i:void 0,y=(u=u||(h?void 0:i))?u.allKeys:void 0;return this._trans("readwrite",function(x){var j=f.schema.primKey,k=j.auto,j=j.keyPath;if(j&&h)throw new de.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(h&&h.length!==n.length)throw new de.InvalidArgument("Arguments objects and keys must have the same length");var C=n.length,j=j&&k?n.map(jn(j)):n;return f.core.mutate({trans:x,type:"add",keys:h,values:j,wantResults:y}).then(function($){var S=$.numFailures,F=$.results,T=$.lastResult,$=$.failures;if(S===0)return y?F:T;throw new Se("".concat(f.name,".bulkAdd(): ").concat(S," of ").concat(C," operations failed"),$)})})},Le.prototype.bulkPut=function(n,i,u){var f=this,h=Array.isArray(i)?i:void 0,y=(u=u||(h?void 0:i))?u.allKeys:void 0;return this._trans("readwrite",function(x){var j=f.schema.primKey,k=j.auto,j=j.keyPath;if(j&&h)throw new de.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(h&&h.length!==n.length)throw new de.InvalidArgument("Arguments objects and keys must have the same length");var C=n.length,j=j&&k?n.map(jn(j)):n;return f.core.mutate({trans:x,type:"put",keys:h,values:j,wantResults:y}).then(function($){var S=$.numFailures,F=$.results,T=$.lastResult,$=$.failures;if(S===0)return y?F:T;throw new Se("".concat(f.name,".bulkPut(): ").concat(S," of ").concat(C," operations failed"),$)})})},Le.prototype.bulkUpdate=function(n){var i=this,u=this.core,f=n.map(function(x){return x.key}),h=n.map(function(x){return x.changes}),y=[];return this._trans("readwrite",function(x){return u.getMany({trans:x,keys:f,cache:"clone"}).then(function(k){var C=[],j=[];n.forEach(function(S,F){var T=S.key,$=S.changes,L=k[F];if(L){for(var D=0,W=Object.keys($);D<W.length;D++){var U=W[D],X=$[U];if(U===i.schema.primKey.keyPath){if(Te(X,T)!==0)throw new de.Constraint("Cannot update primary key in bulkUpdate()")}else Y(L,U,X)}y.push(F),C.push(T),j.push(L)}});var B=C.length;return u.mutate({trans:x,type:"put",keys:C,values:j,updates:{keys:f,changeSpecs:h}}).then(function(S){var F=S.numFailures,T=S.failures;if(F===0)return B;for(var $=0,L=Object.keys(T);$<L.length;$++){var D,W=L[$],U=y[Number(W)];U!=null&&(D=T[W],delete T[W],T[U]=D)}throw new Se("".concat(i.name,".bulkUpdate(): ").concat(F," of ").concat(B," operations failed"),T)})})})},Le.prototype.bulkDelete=function(n){var i=this,u=n.length;return this._trans("readwrite",function(f){return i.core.mutate({trans:f,type:"delete",keys:n})}).then(function(x){var h=x.numFailures,y=x.lastResult,x=x.failures;if(h===0)return y;throw new Se("".concat(i.name,".bulkDelete(): ").concat(h," of ").concat(u," operations failed"),x)})},Le);function Le(){}function tr(n){function i(x,k){if(k){for(var C=arguments.length,j=new Array(C-1);--C;)j[C-1]=arguments[C];return u[x].subscribe.apply(null,j),n}if(typeof x=="string")return u[x]}var u={};i.addEventType=y;for(var f=1,h=arguments.length;f<h;++f)y(arguments[f]);return i;function y(x,k,C){if(typeof x!="object"){var j;k=k||Qe;var B={subscribers:[],fire:C=C||Ee,subscribe:function(S){B.subscribers.indexOf(S)===-1&&(B.subscribers.push(S),B.fire=k(B.fire,S))},unsubscribe:function(S){B.subscribers=B.subscribers.filter(function(F){return F!==S}),B.fire=B.subscribers.reduce(k,C)}};return u[x]=i[x]=B}a(j=x).forEach(function(S){var F=j[S];if(l(F))y(S,j[S][0],j[S][1]);else{if(F!=="asap")throw new de.InvalidArgument("Invalid event config");var T=y(S,qe,function(){for(var $=arguments.length,L=new Array($);$--;)L[$]=arguments[$];T.subscribers.forEach(function(D){Q(function(){D.apply(null,L)})})})}})}}function nr(n,i){return N(i).from({prototype:n}),i}function Dn(n,i){return!(n.filter||n.algorithm||n.or)&&(i?n.justLimit:!n.replayFilter)}function Bo(n,i){n.filter=Bt(n.filter,i)}function zo(n,i,u){var f=n.replayFilter;n.replayFilter=f?function(){return Bt(f(),i())}:i,n.justLimit=u&&!f}function $r(n,i){if(n.isPrimKey)return i.primaryKey;var u=i.getIndexByKeyPath(n.index);if(!u)throw new de.Schema("KeyPath "+n.index+" on object store "+i.name+" is not indexed");return u}function ls(n,i,u){var f=$r(n,i.schema);return i.openCursor({trans:u,values:!n.keysOnly,reverse:n.dir==="prev",unique:!!n.unique,query:{index:f,range:n.range}})}function Br(n,i,u,f){var h=n.replayFilter?Bt(n.filter,n.replayFilter()):n.filter;if(n.or){var y={},x=function(k,C,j){var B,S;h&&!h(C,j,function(F){return C.stop(F)},function(F){return C.fail(F)})||((S=""+(B=C.primaryKey))=="[object ArrayBuffer]"&&(S=""+new Uint8Array(B)),g(y,S)||(y[S]=!0,i(k,C,j)))};return Promise.all([n.or._iterate(x,u),fs(ls(n,f,u),n.algorithm,x,!n.keysOnly&&n.valueMapper)])}return fs(ls(n,f,u),Bt(n.algorithm,h),i,!n.keysOnly&&n.valueMapper)}function fs(n,i,u,f){var h=Be(f?function(y,x,k){return u(f(y),x,k)}:u);return n.then(function(y){if(y)return y.start(function(){var x=function(){return y.continue()};i&&!i(y,function(k){return x=k},function(k){y.stop(k),x=Ee},function(k){y.fail(k),x=Ee})||h(y.value,y,function(k){return x=k}),x()})})}var Ut=Symbol(),rr=(ds.prototype.execute=function(n){if(this.add!==void 0){var i=this.add;if(l(i))return s(s([],l(n)?n:[],!0),i).sort();if(typeof i=="number")return(Number(n)||0)+i;if(typeof i=="bigint")try{return BigInt(n)+i}catch{return BigInt(0)+i}throw new TypeError("Invalid term ".concat(i))}if(this.remove!==void 0){var u=this.remove;if(l(u))return l(n)?n.filter(function(f){return!u.includes(f)}).sort():[];if(typeof u=="number")return Number(n)-u;if(typeof u=="bigint")try{return BigInt(n)-u}catch{return BigInt(0)-u}throw new TypeError("Invalid subtrahend ".concat(u))}return i=(i=this.replacePrefix)===null||i===void 0?void 0:i[0],i&&typeof n=="string"&&n.startsWith(i)?this.replacePrefix[1]+n.substring(i.length):n},ds);function ds(n){Object.assign(this,n)}var lu=(je.prototype._read=function(n,i){var u=this._ctx;return u.error?u.table._trans(null,Ke.bind(null,u.error)):u.table._trans("readonly",n).then(i)},je.prototype._write=function(n){var i=this._ctx;return i.error?i.table._trans(null,Ke.bind(null,i.error)):i.table._trans("readwrite",n,"locked")},je.prototype._addAlgorithm=function(n){var i=this._ctx;i.algorithm=Bt(i.algorithm,n)},je.prototype._iterate=function(n,i){return Br(this._ctx,n,i,this._ctx.table.core)},je.prototype.clone=function(n){var i=Object.create(this.constructor.prototype),u=Object.create(this._ctx);return n&&d(u,n),i._ctx=u,i},je.prototype.raw=function(){return this._ctx.valueMapper=null,this},je.prototype.each=function(n){var i=this._ctx;return this._read(function(u){return Br(i,n,u,i.table.core)})},je.prototype.count=function(n){var i=this;return this._read(function(u){var f=i._ctx,h=f.table.core;if(Dn(f,!0))return h.count({trans:u,query:{index:$r(f,h.schema),range:f.range}}).then(function(x){return Math.min(x,f.limit)});var y=0;return Br(f,function(){return++y,!1},u,h).then(function(){return y})}).then(n)},je.prototype.sortBy=function(n,i){var u=n.split(".").reverse(),f=u[0],h=u.length-1;function y(C,j){return j?y(C[u[j]],j-1):C[f]}var x=this._ctx.dir==="next"?1:-1;function k(C,j){return Te(y(C,h),y(j,h))*x}return this.toArray(function(C){return C.sort(k)}).then(i)},je.prototype.toArray=function(n){var i=this;return this._read(function(u){var f=i._ctx;if(f.dir==="next"&&Dn(f,!0)&&0<f.limit){var h=f.valueMapper,y=$r(f,f.table.core.schema);return f.table.core.query({trans:u,limit:f.limit,values:!0,query:{index:y,range:f.range}}).then(function(k){return k=k.result,h?k.map(h):k})}var x=[];return Br(f,function(k){return x.push(k)},u,f.table.core).then(function(){return x})},n)},je.prototype.offset=function(n){var i=this._ctx;return n<=0||(i.offset+=n,Dn(i)?zo(i,function(){var u=n;return function(f,h){return u===0||(u===1?--u:h(function(){f.advance(u),u=0}),!1)}}):zo(i,function(){var u=n;return function(){return--u<0}})),this},je.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),zo(this._ctx,function(){var i=n;return function(u,f,h){return--i<=0&&f(h),0<=i}},!0),this},je.prototype.until=function(n,i){return Bo(this._ctx,function(u,f,h){return!n(u.value)||(f(h),i)}),this},je.prototype.first=function(n){return this.limit(1).toArray(function(i){return i[0]}).then(n)},je.prototype.last=function(n){return this.reverse().first(n)},je.prototype.filter=function(n){var i;return Bo(this._ctx,function(u){return n(u.value)}),(i=this._ctx).isMatch=Bt(i.isMatch,n),this},je.prototype.and=function(n){return this.filter(n)},je.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},je.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},je.prototype.desc=function(){return this.reverse()},je.prototype.eachKey=function(n){var i=this._ctx;return i.keysOnly=!i.isMatch,this.each(function(u,f){n(f.key,f)})},je.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},je.prototype.eachPrimaryKey=function(n){var i=this._ctx;return i.keysOnly=!i.isMatch,this.each(function(u,f){n(f.primaryKey,f)})},je.prototype.keys=function(n){var i=this._ctx;i.keysOnly=!i.isMatch;var u=[];return this.each(function(f,h){u.push(h.key)}).then(function(){return u}).then(n)},je.prototype.primaryKeys=function(n){var i=this._ctx;if(i.dir==="next"&&Dn(i,!0)&&0<i.limit)return this._read(function(f){var h=$r(i,i.table.core.schema);return i.table.core.query({trans:f,values:!1,limit:i.limit,query:{index:h,range:i.range}})}).then(function(f){return f.result}).then(n);i.keysOnly=!i.isMatch;var u=[];return this.each(function(f,h){u.push(h.primaryKey)}).then(function(){return u}).then(n)},je.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},je.prototype.firstKey=function(n){return this.limit(1).keys(function(i){return i[0]}).then(n)},je.prototype.lastKey=function(n){return this.reverse().firstKey(n)},je.prototype.distinct=function(){var n=this._ctx,n=n.index&&n.table.schema.idxByName[n.index];if(!n||!n.multi)return this;var i={};return Bo(this._ctx,function(h){var f=h.primaryKey.toString(),h=g(i,f);return i[f]=!0,!h}),this},je.prototype.modify=function(n){var i=this,u=this._ctx;return this._write(function(f){var h,y,x;x=typeof n=="function"?n:(h=a(n),y=h.length,function(D){for(var W=!1,U=0;U<y;++U){var X=h[U],ne=n[X],ue=G(D,X);ne instanceof rr?(Y(D,X,ne.execute(ue)),W=!0):ue!==ne&&(Y(D,X,ne),W=!0)}return W});var k=u.table.core,S=k.schema.primaryKey,C=S.outbound,j=S.extractKey,B=200,S=i.db._options.modifyChunkSize;S&&(B=typeof S=="object"?S[k.name]||S["*"]||200:S);function F(D,X){var U=X.failures,X=X.numFailures;$+=D-X;for(var ne=0,ue=a(U);ne<ue.length;ne++){var pe=ue[ne];T.push(U[pe])}}var T=[],$=0,L=[];return i.clone().primaryKeys().then(function(D){function W(X){var ne=Math.min(B,D.length-X);return k.getMany({trans:f,keys:D.slice(X,X+ne),cache:"immutable"}).then(function(ue){for(var pe=[],le=[],fe=C?[]:null,ge=[],he=0;he<ne;++he){var we=ue[he],Ce={value:ae(we),primKey:D[X+he]};x.call(Ce,Ce.value,Ce)!==!1&&(Ce.value==null?ge.push(D[X+he]):C||Te(j(we),j(Ce.value))===0?(le.push(Ce.value),C&&fe.push(D[X+he])):(ge.push(D[X+he]),pe.push(Ce.value)))}return Promise.resolve(0<pe.length&&k.mutate({trans:f,type:"add",values:pe}).then(function(Ae){for(var Me in Ae.failures)ge.splice(parseInt(Me),1);F(pe.length,Ae)})).then(function(){return(0<le.length||U&&typeof n=="object")&&k.mutate({trans:f,type:"put",keys:fe,values:le,criteria:U,changeSpec:typeof n!="function"&&n,isAdditionalChunk:0<X}).then(function(Ae){return F(le.length,Ae)})}).then(function(){return(0<ge.length||U&&n===Lo)&&k.mutate({trans:f,type:"delete",keys:ge,criteria:U,isAdditionalChunk:0<X}).then(function(Ae){return F(ge.length,Ae)})}).then(function(){return D.length>X+ne&&W(X+B)})})}var U=Dn(u)&&u.limit===1/0&&(typeof n!="function"||n===Lo)&&{index:u.index,range:u.range};return W(0).then(function(){if(0<T.length)throw new be("Error modifying one or more objects",T,$,L);return D.length})})})},je.prototype.delete=function(){var n=this._ctx,i=n.range;return Dn(n)&&(n.isPrimKey||i.type===3)?this._write(function(u){var f=n.table.core.schema.primaryKey,h=i;return n.table.core.count({trans:u,query:{index:f,range:h}}).then(function(y){return n.table.core.mutate({trans:u,type:"deleteRange",range:h}).then(function(x){var k=x.failures;if(x.lastResult,x.results,x=x.numFailures,x)throw new be("Could not delete some values",Object.keys(k).map(function(C){return k[C]}),y-x);return y-x})})}):this.modify(Lo)},je);function je(){}var Lo=function(n,i){return i.value=null};function fu(n,i){return n<i?-1:n===i?0:1}function du(n,i){return i<n?-1:n===i?0:1}function ht(n,i,u){return n=n instanceof ps?new n.Collection(n):n,n._ctx.error=new(u||TypeError)(i),n}function On(n){return new n.Collection(n,function(){return hs("")}).limit(0)}function zr(n,i,u,f){var h,y,x,k,C,j,B,S=u.length;if(!u.every(function($){return typeof $=="string"}))return ht(n,jr);function F($){h=$==="next"?function(D){return D.toUpperCase()}:function(D){return D.toLowerCase()},y=$==="next"?function(D){return D.toLowerCase()}:function(D){return D.toUpperCase()},x=$==="next"?fu:du;var L=u.map(function(D){return{lower:y(D),upper:h(D)}}).sort(function(D,W){return x(D.lower,W.lower)});k=L.map(function(D){return D.upper}),C=L.map(function(D){return D.lower}),B=(j=$)==="next"?"":f}F("next"),n=new n.Collection(n,function(){return sn(k[0],C[S-1]+f)}),n._ondirectionchange=function($){F($)};var T=0;return n._addAlgorithm(function($,L,D){var W=$.key;if(typeof W!="string")return!1;var U=y(W);if(i(U,C,T))return!0;for(var X=null,ne=T;ne<S;++ne){var ue=function(pe,le,fe,ge,he,we){for(var Ce=Math.min(pe.length,ge.length),Ae=-1,Me=0;Me<Ce;++Me){var pt=le[Me];if(pt!==ge[Me])return he(pe[Me],fe[Me])<0?pe.substr(0,Me)+fe[Me]+fe.substr(Me+1):he(pe[Me],ge[Me])<0?pe.substr(0,Me)+ge[Me]+fe.substr(Me+1):0<=Ae?pe.substr(0,Ae)+le[Ae]+fe.substr(Ae+1):null;he(pe[Me],pt)<0&&(Ae=Me)}return Ce<ge.length&&we==="next"?pe+fe.substr(pe.length):Ce<pe.length&&we==="prev"?pe.substr(0,fe.length):Ae<0?null:pe.substr(0,Ae)+ge[Ae]+fe.substr(Ae+1)}(W,U,k[ne],C[ne],x,j);ue===null&&X===null?T=ne+1:(X===null||0<x(X,ue))&&(X=ue)}return L(X!==null?function(){$.continue(X+B)}:D),!1}),n}function sn(n,i,u,f){return{type:2,lower:n,upper:i,lowerOpen:u,upperOpen:f}}function hs(n){return{type:1,lower:n,upper:n}}var ps=(Object.defineProperty(Ze.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Ze.prototype.between=function(n,i,u,f){u=u!==!1,f=f===!0;try{return 0<this._cmp(n,i)||this._cmp(n,i)===0&&(u||f)&&(!u||!f)?On(this):new this.Collection(this,function(){return sn(n,i,!u,!f)})}catch{return ht(this,Nt)}},Ze.prototype.equals=function(n){return n==null?ht(this,Nt):new this.Collection(this,function(){return hs(n)})},Ze.prototype.above=function(n){return n==null?ht(this,Nt):new this.Collection(this,function(){return sn(n,void 0,!0)})},Ze.prototype.aboveOrEqual=function(n){return n==null?ht(this,Nt):new this.Collection(this,function(){return sn(n,void 0,!1)})},Ze.prototype.below=function(n){return n==null?ht(this,Nt):new this.Collection(this,function(){return sn(void 0,n,!1,!0)})},Ze.prototype.belowOrEqual=function(n){return n==null?ht(this,Nt):new this.Collection(this,function(){return sn(void 0,n)})},Ze.prototype.startsWith=function(n){return typeof n!="string"?ht(this,jr):this.between(n,n+$t,!0,!0)},Ze.prototype.startsWithIgnoreCase=function(n){return n===""?this.startsWith(n):zr(this,function(i,u){return i.indexOf(u[0])===0},[n],$t)},Ze.prototype.equalsIgnoreCase=function(n){return zr(this,function(i,u){return i===u[0]},[n],"")},Ze.prototype.anyOfIgnoreCase=function(){var n=q.apply(M,arguments);return n.length===0?On(this):zr(this,function(i,u){return u.indexOf(i)!==-1},n,"")},Ze.prototype.startsWithAnyOfIgnoreCase=function(){var n=q.apply(M,arguments);return n.length===0?On(this):zr(this,function(i,u){return u.some(function(f){return i.indexOf(f)===0})},n,$t)},Ze.prototype.anyOf=function(){var n=this,i=q.apply(M,arguments),u=this._cmp;try{i.sort(u)}catch{return ht(this,Nt)}if(i.length===0)return On(this);var f=new this.Collection(this,function(){return sn(i[0],i[i.length-1])});f._ondirectionchange=function(y){u=y==="next"?n._ascending:n._descending,i.sort(u)};var h=0;return f._addAlgorithm(function(y,x,k){for(var C=y.key;0<u(C,i[h]);)if(++h===i.length)return x(k),!1;return u(C,i[h])===0||(x(function(){y.continue(i[h])}),!1)}),f},Ze.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Ze.prototype.noneOf=function(){var n=q.apply(M,arguments);if(n.length===0)return new this.Collection(this);try{n.sort(this._ascending)}catch{return ht(this,Nt)}var i=n.reduce(function(u,f){return u?u.concat([[u[u.length-1][1],f]]):[[-1/0,f]]},null);return i.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(i,{includeLowers:!1,includeUppers:!1})},Ze.prototype.inAnyRange=function(W,i){var u=this,f=this._cmp,h=this._ascending,y=this._descending,x=this._min,k=this._max;if(W.length===0)return On(this);if(!W.every(function(U){return U[0]!==void 0&&U[1]!==void 0&&h(U[0],U[1])<=0}))return ht(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",de.InvalidArgument);var C=!i||i.includeLowers!==!1,j=i&&i.includeUppers===!0,B,S=h;function F(U,X){return S(U[0],X[0])}try{(B=W.reduce(function(U,X){for(var ne=0,ue=U.length;ne<ue;++ne){var pe=U[ne];if(f(X[0],pe[1])<0&&0<f(X[1],pe[0])){pe[0]=x(pe[0],X[0]),pe[1]=k(pe[1],X[1]);break}}return ne===ue&&U.push(X),U},[])).sort(F)}catch{return ht(this,Nt)}var T=0,$=j?function(U){return 0<h(U,B[T][1])}:function(U){return 0<=h(U,B[T][1])},L=C?function(U){return 0<y(U,B[T][0])}:function(U){return 0<=y(U,B[T][0])},D=$,W=new this.Collection(this,function(){return sn(B[0][0],B[B.length-1][1],!C,!j)});return W._ondirectionchange=function(U){S=U==="next"?(D=$,h):(D=L,y),B.sort(F)},W._addAlgorithm(function(U,X,ne){for(var ue,pe=U.key;D(pe);)if(++T===B.length)return X(ne),!1;return!$(ue=pe)&&!L(ue)||(u._cmp(pe,B[T][1])===0||u._cmp(pe,B[T][0])===0||X(function(){S===h?U.continue(B[T][0]):U.continue(B[T][1])}),!1)}),W},Ze.prototype.startsWithAnyOf=function(){var n=q.apply(M,arguments);return n.every(function(i){return typeof i=="string"})?n.length===0?On(this):this.inAnyRange(n.map(function(i){return[i,i+$t]})):ht(this,"startsWithAnyOf() only works with strings")},Ze);function Ze(){}function zt(n){return Be(function(i){return or(i),n(i.target.error),!1})}function or(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var ir="storagemutated",Fo="x-storagemutated-1",an=tr(null,ir),hu=(Lt.prototype._lock=function(){return I(!xe.global),++this._reculock,this._reculock!==1||xe.global||(xe.lockOwnerFor=this),this},Lt.prototype._unlock=function(){if(I(!xe.global),--this._reculock==0)for(xe.global||(xe.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var n=this._blockedFuncs.shift();try{Yt(n[1],n[0])}catch{}}return this},Lt.prototype._locked=function(){return this._reculock&&xe.lockOwnerFor!==this},Lt.prototype.create=function(n){var i=this;if(!this.mode)return this;var u=this.db.idbdb,f=this.db._state.dbOpenError;if(I(!this.idbtrans),!n&&!u)switch(f&&f.name){case"DatabaseClosedError":throw new de.DatabaseClosed(f);case"MissingAPIError":throw new de.MissingAPI(f.message,f);default:throw new de.OpenFailed(f)}if(!this.active)throw new de.TransactionInactive;return I(this._completion._state===null),(n=this.idbtrans=n||(this.db.core||u).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Be(function(h){or(h),i._reject(n.error)}),n.onabort=Be(function(h){or(h),i.active&&i._reject(new de.Abort(n.error)),i.active=!1,i.on("abort").fire(h)}),n.oncomplete=Be(function(){i.active=!1,i._resolve(),"mutatedParts"in n&&an.storagemutated.fire(n.mutatedParts)}),this},Lt.prototype._promise=function(n,i,u){var f=this;if(n==="readwrite"&&this.mode!=="readwrite")return Ke(new de.ReadOnly("Transaction is readonly"));if(!this.active)return Ke(new de.TransactionInactive);if(this._locked())return new ye(function(y,x){f._blockedFuncs.push([function(){f._promise(n,i,u).then(y,x)},xe])});if(u)return Dt(function(){var y=new ye(function(x,k){f._lock();var C=i(x,k,f);C&&C.then&&C.then(x,k)});return y.finally(function(){return f._unlock()}),y._lib=!0,y});var h=new ye(function(y,x){var k=i(y,x,f);k&&k.then&&k.then(y,x)});return h._lib=!0,h},Lt.prototype._root=function(){return this.parent?this.parent._root():this},Lt.prototype.waitFor=function(n){var i,u=this._root(),f=ye.resolve(n);u._waitingFor?u._waitingFor=u._waitingFor.then(function(){return f}):(u._waitingFor=f,u._waitingQueue=[],i=u.idbtrans.objectStore(u.storeNames[0]),function y(){for(++u._spinCount;u._waitingQueue.length;)u._waitingQueue.shift()();u._waitingFor&&(i.get(-1/0).onsuccess=y)}());var h=u._waitingFor;return new ye(function(y,x){f.then(function(k){return u._waitingQueue.push(Be(y.bind(null,k)))},function(k){return u._waitingQueue.push(Be(x.bind(null,k)))}).finally(function(){u._waitingFor===h&&(u._waitingFor=null)})})},Lt.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new de.Abort))},Lt.prototype.table=function(n){var i=this._memoizedTables||(this._memoizedTables={});if(g(i,n))return i[n];var u=this.schema[n];if(!u)throw new de.NotFound("Table "+n+" not part of transaction");return u=new this.db.Table(n,u,this),u.core=this.db.core.table(n),i[n]=u},Lt);function Lt(){}function Ko(n,i,u,f,h,y,x){return{name:n,keyPath:i,unique:u,multi:f,auto:h,compound:y,src:(u&&!x?"&":"")+(f?"*":"")+(h?"++":"")+ms(i)}}function ms(n){return typeof n=="string"?n:n?"["+[].join.call(n,"+")+"]":""}function Ho(n,i,u){return{name:n,primKey:i,indexes:u,mappedClass:null,idxByName:(f=function(h){return[h.name,h]},u.reduce(function(h,y,x){return x=f(y,x),x&&(h[x[0]]=x[1]),h},{}))};var f}var sr=function(n){try{return n.only([[]]),sr=function(){return[[]]},[[]]}catch{return sr=function(){return $t},$t}};function Wo(n){return n==null?function(){}:typeof n=="string"?(i=n).split(".").length===1?function(u){return u[i]}:function(u){return G(u,i)}:function(u){return G(u,n)};var i}function ys(n){return[].slice.call(n)}var pu=0;function ar(n){return n==null?":id":typeof n=="string"?n:"[".concat(n.join("+"),"]")}function mu(n,i,C){function f(D){if(D.type===3)return null;if(D.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var T=D.lower,$=D.upper,L=D.lowerOpen,D=D.upperOpen;return T===void 0?$===void 0?null:i.upperBound($,!!D):$===void 0?i.lowerBound(T,!!L):i.bound(T,$,!!L,!!D)}function h(F){var T,$=F.name;return{name:$,schema:F,mutate:function(L){var D=L.trans,W=L.type,U=L.keys,X=L.values,ne=L.range;return new Promise(function(ue,pe){ue=Be(ue);var le=D.objectStore($),fe=le.keyPath==null,ge=W==="put"||W==="add";if(!ge&&W!=="delete"&&W!=="deleteRange")throw new Error("Invalid operation type: "+W);var he,we=(U||X||{length:1}).length;if(U&&X&&U.length!==X.length)throw new Error("Given keys array must have same length as given values array.");if(we===0)return ue({numFailures:0,failures:{},results:[],lastResult:void 0});function Ce(lt){++pt,or(lt)}var Ae=[],Me=[],pt=0;if(W==="deleteRange"){if(ne.type===4)return ue({numFailures:pt,failures:Me,results:[],lastResult:void 0});ne.type===3?Ae.push(he=le.clear()):Ae.push(he=le.delete(f(ne)))}else{var fe=ge?fe?[X,U]:[X,null]:[U,null],Ne=fe[0],it=fe[1];if(ge)for(var st=0;st<we;++st)Ae.push(he=it&&it[st]!==void 0?le[W](Ne[st],it[st]):le[W](Ne[st])),he.onerror=Ce;else for(st=0;st<we;++st)Ae.push(he=le[W](Ne[st])),he.onerror=Ce}function Jr(lt){lt=lt.target.result,Ae.forEach(function(vn,ci){return vn.error!=null&&(Me[ci]=vn.error)}),ue({numFailures:pt,failures:Me,results:W==="delete"?U:Ae.map(function(vn){return vn.result}),lastResult:lt})}he.onerror=function(lt){Ce(lt),Jr(lt)},he.onsuccess=Jr})},getMany:function(L){var D=L.trans,W=L.keys;return new Promise(function(U,X){U=Be(U);for(var ne,ue=D.objectStore($),pe=W.length,le=new Array(pe),fe=0,ge=0,he=function(Ae){Ae=Ae.target,le[Ae._pos]=Ae.result,++ge===fe&&U(le)},we=zt(X),Ce=0;Ce<pe;++Ce)W[Ce]!=null&&((ne=ue.get(W[Ce]))._pos=Ce,ne.onsuccess=he,ne.onerror=we,++fe);fe===0&&U(le)})},get:function(L){var D=L.trans,W=L.key;return new Promise(function(U,X){U=Be(U);var ne=D.objectStore($).get(W);ne.onsuccess=function(ue){return U(ue.target.result)},ne.onerror=zt(X)})},query:(T=j,function(L){return new Promise(function(D,W){D=Be(D);var U,X,ne,fe=L.trans,ue=L.values,pe=L.limit,he=L.query,le=pe===1/0?void 0:pe,ge=he.index,he=he.range,fe=fe.objectStore($),ge=ge.isPrimaryKey?fe:fe.index(ge.name),he=f(he);if(pe===0)return D({result:[]});T?((le=ue?ge.getAll(he,le):ge.getAllKeys(he,le)).onsuccess=function(we){return D({result:we.target.result})},le.onerror=zt(W)):(U=0,X=!ue&&"openKeyCursor"in ge?ge.openKeyCursor(he):ge.openCursor(he),ne=[],X.onsuccess=function(we){var Ce=X.result;return Ce?(ne.push(ue?Ce.value:Ce.primaryKey),++U===pe?D({result:ne}):void Ce.continue()):D({result:ne})},X.onerror=zt(W))})}),openCursor:function(L){var D=L.trans,W=L.values,U=L.query,X=L.reverse,ne=L.unique;return new Promise(function(ue,pe){ue=Be(ue);var ge=U.index,le=U.range,fe=D.objectStore($),fe=ge.isPrimaryKey?fe:fe.index(ge.name),ge=X?ne?"prevunique":"prev":ne?"nextunique":"next",he=!W&&"openKeyCursor"in fe?fe.openKeyCursor(f(le),ge):fe.openCursor(f(le),ge);he.onerror=zt(pe),he.onsuccess=Be(function(we){var Ce,Ae,Me,pt,Ne=he.result;Ne?(Ne.___id=++pu,Ne.done=!1,Ce=Ne.continue.bind(Ne),Ae=(Ae=Ne.continuePrimaryKey)&&Ae.bind(Ne),Me=Ne.advance.bind(Ne),pt=function(){throw new Error("Cursor not stopped")},Ne.trans=D,Ne.stop=Ne.continue=Ne.continuePrimaryKey=Ne.advance=function(){throw new Error("Cursor not started")},Ne.fail=Be(pe),Ne.next=function(){var it=this,st=1;return this.start(function(){return st--?it.continue():it.stop()}).then(function(){return it})},Ne.start=function(it){function st(){if(he.result)try{it()}catch(lt){Ne.fail(lt)}else Ne.done=!0,Ne.start=function(){throw new Error("Cursor behind last entry")},Ne.stop()}var Jr=new Promise(function(lt,vn){lt=Be(lt),he.onerror=zt(vn),Ne.fail=vn,Ne.stop=function(ci){Ne.stop=Ne.continue=Ne.continuePrimaryKey=Ne.advance=pt,lt(ci)}});return he.onsuccess=Be(function(lt){he.onsuccess=st,st()}),Ne.continue=Ce,Ne.continuePrimaryKey=Ae,Ne.advance=Me,st(),Jr},ue(Ne)):ue(null)},pe)})},count:function(L){var D=L.query,W=L.trans,U=D.index,X=D.range;return new Promise(function(ne,ue){var pe=W.objectStore($),le=U.isPrimaryKey?pe:pe.index(U.name),pe=f(X),le=pe?le.count(pe):le.count();le.onsuccess=Be(function(fe){return ne(fe.target.result)}),le.onerror=zt(ue)})}}}var y,x,k,B=(x=C,k=ys((y=n).objectStoreNames),{schema:{name:y.name,tables:k.map(function(F){return x.objectStore(F)}).map(function(F){var T=F.keyPath,D=F.autoIncrement,$=l(T),L={},D={name:F.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:T==null,compound:$,keyPath:T,autoIncrement:D,unique:!0,extractKey:Wo(T)},indexes:ys(F.indexNames).map(function(W){return F.index(W)}).map(function(ne){var U=ne.name,X=ne.unique,ue=ne.multiEntry,ne=ne.keyPath,ue={name:U,compound:l(ne),keyPath:ne,unique:X,multiEntry:ue,extractKey:Wo(ne)};return L[ar(ne)]=ue}),getIndexByKeyPath:function(W){return L[ar(W)]}};return L[":id"]=D.primaryKey,T!=null&&(L[ar(T)]=D.primaryKey),D})},hasGetAll:0<k.length&&"getAll"in x.objectStore(k[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),C=B.schema,j=B.hasGetAll,B=C.tables.map(h),S={};return B.forEach(function(F){return S[F.name]=F}),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(F){if(!S[F])throw new Error("Table '".concat(F,"' not found"));return S[F]},MIN_KEY:-1/0,MAX_KEY:sr(i),schema:C}}function yu(n,i,u,f){var h=u.IDBKeyRange;return u.indexedDB,{dbcore:(f=mu(i,h,f),n.dbcore.reduce(function(y,x){return x=x.create,o(o({},y),x(y))},f))}}function Lr(n,f){var u=f.db,f=yu(n._middlewares,u,n._deps,f);n.core=f.dbcore,n.tables.forEach(function(h){var y=h.name;n.core.schema.tables.some(function(x){return x.name===y})&&(h.core=n.core.table(y),n[y]instanceof n.Table&&(n[y].core=h.core))})}function Fr(n,i,u,f){u.forEach(function(h){var y=f[h];i.forEach(function(x){var k=function C(j,B){return z(j,B)||(j=p(j))&&C(j,B)}(x,h);(!k||"value"in k&&k.value===void 0)&&(x===n.Transaction.prototype||x instanceof n.Transaction?E(x,h,{get:function(){return this.table(h)},set:function(C){w(this,h,{value:C,writable:!0,configurable:!0,enumerable:!0})}}):x[h]=new n.Table(h,y))})})}function qo(n,i){i.forEach(function(u){for(var f in u)u[f]instanceof n.Table&&delete u[f]})}function gu(n,i){return n._cfg.version-i._cfg.version}function vu(n,i,u,f){var h=n._dbSchema;u.objectStoreNames.contains("$meta")&&!h.$meta&&(h.$meta=Ho("$meta",vs("")[0],[]),n._storeNames.push("$meta"));var y=n._createTransaction("readwrite",n._storeNames,h);y.create(u),y._completion.catch(f);var x=y._reject.bind(y),k=xe.transless||xe;Dt(function(){return xe.trans=y,xe.transless=k,i!==0?(Lr(n,u),j=i,((C=y).storeNames.includes("$meta")?C.table("$meta").get("version").then(function(B){return B??j}):ye.resolve(j)).then(function(B){return F=B,T=y,$=u,L=[],B=(S=n)._versions,D=S._dbSchema=Hr(0,S.idbdb,$),(B=B.filter(function(W){return W._cfg.version>=F})).length!==0?(B.forEach(function(W){L.push(function(){var U=D,X=W._cfg.dbschema;Wr(S,U,$),Wr(S,X,$),D=S._dbSchema=X;var ne=Vo(U,X);ne.add.forEach(function(ge){Yo($,ge[0],ge[1].primKey,ge[1].indexes)}),ne.change.forEach(function(ge){if(ge.recreate)throw new de.Upgrade("Not yet support for changing primary key");var he=$.objectStore(ge.name);ge.add.forEach(function(we){return Kr(he,we)}),ge.change.forEach(function(we){he.deleteIndex(we.name),Kr(he,we)}),ge.del.forEach(function(we){return he.deleteIndex(we)})});var ue=W._cfg.contentUpgrade;if(ue&&W._cfg.version>F){Lr(S,$),T._memoizedTables={};var pe=te(X);ne.del.forEach(function(ge){pe[ge]=U[ge]}),qo(S,[S.Transaction.prototype]),Fr(S,[S.Transaction.prototype],a(pe),pe),T.schema=pe;var le,fe=oe(ue);return fe&&rn(),ne=ye.follow(function(){var ge;(le=ue(T))&&fe&&(ge=St.bind(null,null),le.then(ge,ge))}),le&&typeof le.then=="function"?ye.resolve(le):ne.then(function(){return le})}}),L.push(function(U){var X,ne,ue=W._cfg.dbschema;X=ue,ne=U,[].slice.call(ne.db.objectStoreNames).forEach(function(pe){return X[pe]==null&&ne.db.deleteObjectStore(pe)}),qo(S,[S.Transaction.prototype]),Fr(S,[S.Transaction.prototype],S._storeNames,S._dbSchema),T.schema=S._dbSchema}),L.push(function(U){S.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(S.idbdb.version/10)===W._cfg.version?(S.idbdb.deleteObjectStore("$meta"),delete S._dbSchema.$meta,S._storeNames=S._storeNames.filter(function(X){return X!=="$meta"})):U.objectStore("$meta").put(W._cfg.version,"version"))})}),function W(){return L.length?ye.resolve(L.shift()(T.idbtrans)).then(W):ye.resolve()}().then(function(){gs(D,$)})):ye.resolve();var S,F,T,$,L,D}).catch(x)):(a(h).forEach(function(B){Yo(u,B,h[B].primKey,h[B].indexes)}),Lr(n,u),void ye.follow(function(){return n.on.populate.fire(y)}).catch(x));var C,j})}function wu(n,i){gs(n._dbSchema,i),i.db.version%10!=0||i.objectStoreNames.contains("$meta")||i.db.createObjectStore("$meta").add(Math.ceil(i.db.version/10-1),"version");var u=Hr(0,n.idbdb,i);Wr(n,n._dbSchema,i);for(var f=0,h=Vo(u,n._dbSchema).change;f<h.length;f++){var y=function(x){if(x.change.length||x.recreate)return console.warn("Unable to patch indexes of table ".concat(x.name," because it has changes on the type of index or primary key.")),{value:void 0};var k=i.objectStore(x.name);x.add.forEach(function(C){tt&&console.debug("Dexie upgrade patch: Creating missing index ".concat(x.name,".").concat(C.src)),Kr(k,C)})}(h[f]);if(typeof y=="object")return y.value}}function Vo(n,i){var u,f={del:[],add:[],change:[]};for(u in n)i[u]||f.del.push(u);for(u in i){var h=n[u],y=i[u];if(h){var x={name:u,def:y,recreate:!1,del:[],add:[],change:[]};if(""+(h.primKey.keyPath||"")!=""+(y.primKey.keyPath||"")||h.primKey.auto!==y.primKey.auto)x.recreate=!0,f.change.push(x);else{var k=h.idxByName,C=y.idxByName,j=void 0;for(j in k)C[j]||x.del.push(j);for(j in C){var B=k[j],S=C[j];B?B.src!==S.src&&x.change.push(S):x.add.push(S)}(0<x.del.length||0<x.add.length||0<x.change.length)&&f.change.push(x)}}else f.add.push([u,y])}return f}function Yo(n,i,u,f){var h=n.db.createObjectStore(i,u.keyPath?{keyPath:u.keyPath,autoIncrement:u.auto}:{autoIncrement:u.auto});return f.forEach(function(y){return Kr(h,y)}),h}function gs(n,i){a(n).forEach(function(u){i.db.objectStoreNames.contains(u)||(tt&&console.debug("Dexie: Creating missing table",u),Yo(i,u,n[u].primKey,n[u].indexes))})}function Kr(n,i){n.createIndex(i.name,i.keyPath,{unique:i.unique,multiEntry:i.multi})}function Hr(n,i,u){var f={};return H(i.objectStoreNames,0).forEach(function(h){for(var y=u.objectStore(h),x=Ko(ms(j=y.keyPath),j||"",!0,!1,!!y.autoIncrement,j&&typeof j!="string",!0),k=[],C=0;C<y.indexNames.length;++C){var B=y.index(y.indexNames[C]),j=B.keyPath,B=Ko(B.name,j,!!B.unique,!!B.multiEntry,!1,j&&typeof j!="string",!1);k.push(B)}f[h]=Ho(h,x,k)}),f}function Wr(n,i,u){for(var f=u.db.objectStoreNames,h=0;h<f.length;++h){var y=f[h],x=u.objectStore(y);n._hasGetAll="getAll"in x;for(var k=0;k<x.indexNames.length;++k){var C=x.indexNames[k],j=x.index(C).keyPath,B=typeof j=="string"?j:"["+H(j).join("+")+"]";!i[y]||(j=i[y].idxByName[B])&&(j.name=C,delete i[y].idxByName[B],i[y].idxByName[C]=j)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&c.WorkerGlobalScope&&c instanceof c.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function vs(n){return n.split(",").map(function(i,u){var f=(i=i.trim()).replace(/([&*]|\+\+)/g,""),h=/^\[/.test(f)?f.match(/^\[(.*)\]$/)[1].split("+"):f;return Ko(f,h||null,/\&/.test(i),/\*/.test(i),/\+\+/.test(i),l(h),u===0)})}var xu=(qr.prototype._parseStoresSpec=function(n,i){a(n).forEach(function(u){if(n[u]!==null){var f=vs(n[u]),h=f.shift();if(h.unique=!0,h.multi)throw new de.Schema("Primary key cannot be multi-valued");f.forEach(function(y){if(y.auto)throw new de.Schema("Only primary key can be marked as autoIncrement (++)");if(!y.keyPath)throw new de.Schema("Index must have a name and cannot be an empty string")}),i[u]=Ho(u,h,f)}})},qr.prototype.stores=function(u){var i=this.db;this._cfg.storesSource=this._cfg.storesSource?d(this._cfg.storesSource,u):u;var u=i._versions,f={},h={};return u.forEach(function(y){d(f,y._cfg.storesSource),h=y._cfg.dbschema={},y._parseStoresSpec(f,h)}),i._dbSchema=h,qo(i,[i._allTables,i,i.Transaction.prototype]),Fr(i,[i._allTables,i,i.Transaction.prototype,this._cfg.tables],a(h),h),i._storeNames=a(h),this},qr.prototype.upgrade=function(n){return this._cfg.contentUpgrade=dt(this._cfg.contentUpgrade||Ee,n),this},qr);function qr(){}function Uo(n,i){var u=n._dbNamesDB;return u||(u=n._dbNamesDB=new Xt(Rn,{addons:[],indexedDB:n,IDBKeyRange:i})).version(1).stores({dbnames:"name"}),u.table("dbnames")}function Xo(n){return n&&typeof n.databases=="function"}function Go(n){return Dt(function(){return xe.letThrough=!0,n()})}function Zo(n){return!("from"in n)}var ot=function(n,i){if(!this){var u=new ot;return n&&"d"in n&&d(u,n),u}d(this,arguments.length?{d:1,from:n,to:1<arguments.length?i:n}:{d:0})};function cr(n,i,u){var f=Te(i,u);if(!isNaN(f)){if(0<f)throw RangeError();if(Zo(n))return d(n,{from:i,to:u,d:1});var h=n.l,f=n.r;if(Te(u,n.from)<0)return h?cr(h,i,u):n.l={from:i,to:u,d:1,l:null,r:null},xs(n);if(0<Te(i,n.to))return f?cr(f,i,u):n.r={from:i,to:u,d:1,l:null,r:null},xs(n);Te(i,n.from)<0&&(n.from=i,n.l=null,n.d=f?f.d+1:1),0<Te(u,n.to)&&(n.to=u,n.r=null,n.d=n.l?n.l.d+1:1),u=!n.r,h&&!n.l&&ur(n,h),f&&u&&ur(n,f)}}function ur(n,i){Zo(i)||function u(f,C){var y=C.from,x=C.to,k=C.l,C=C.r;cr(f,y,x),k&&u(f,k),C&&u(f,C)}(n,i)}function ws(n,i){var u=Vr(i),f=u.next();if(f.done)return!1;for(var h=f.value,y=Vr(n),x=y.next(h.from),k=x.value;!f.done&&!x.done;){if(Te(k.from,h.to)<=0&&0<=Te(k.to,h.from))return!0;Te(h.from,k.from)<0?h=(f=u.next(k.from)).value:k=(x=y.next(h.from)).value}return!1}function Vr(n){var i=Zo(n)?null:{s:0,n};return{next:function(u){for(var f=0<arguments.length;i;)switch(i.s){case 0:if(i.s=1,f)for(;i.n.l&&Te(u,i.n.from)<0;)i={up:i,n:i.n.l,s:1};else for(;i.n.l;)i={up:i,n:i.n.l,s:1};case 1:if(i.s=2,!f||Te(u,i.n.to)<=0)return{value:i.n,done:!1};case 2:if(i.n.r){i.s=3,i={up:i,n:i.n.r,s:0};continue}case 3:i=i.up}return{done:!0}}}}function xs(n){var i,u,f=(((i=n.r)===null||i===void 0?void 0:i.d)||0)-(((u=n.l)===null||u===void 0?void 0:u.d)||0),h=1<f?"r":f<-1?"l":"";h&&(i=h=="r"?"l":"r",u=o({},n),f=n[h],n.from=f.from,n.to=f.to,n[h]=f[h],u[h]=f[i],(n[i]=u).d=bs(u)),n.d=bs(n)}function bs(u){var i=u.r,u=u.l;return(i?u?Math.max(i.d,u.d):i.d:u?u.d:0)+1}function Yr(n,i){return a(i).forEach(function(u){n[u]?ur(n[u],i[u]):n[u]=function f(h){var y,x,k={};for(y in h)g(h,y)&&(x=h[y],k[y]=!x||typeof x!="object"||ee.has(x.constructor)?x:f(x));return k}(i[u])}),n}function Jo(n,i){return n.all||i.all||Object.keys(n).some(function(u){return i[u]&&ws(i[u],n[u])})}v(ot.prototype,((xt={add:function(n){return ur(this,n),this},addKey:function(n){return cr(this,n,n),this},addKeys:function(n){var i=this;return n.forEach(function(u){return cr(i,u,u)}),this},hasKey:function(n){var i=Vr(this).next(n).value;return i&&Te(i.from,n)<=0&&0<=Te(i.to,n)}})[R]=function(){return Vr(this)},xt));var yn={},Qo={},ei=!1;function Ur(n){Yr(Qo,n),ei||(ei=!0,setTimeout(function(){ei=!1,ti(Qo,!(Qo={}))},0))}function ti(n,i){i===void 0&&(i=!1);var u=new Set;if(n.all)for(var f=0,h=Object.values(yn);f<h.length;f++)_s(x=h[f],n,u,i);else for(var y in n){var x,k=/^idb\:\/\/(.*)\/(.*)\//.exec(y);k&&(y=k[1],k=k[2],(x=yn["idb://".concat(y,"/").concat(k)])&&_s(x,n,u,i))}u.forEach(function(C){return C()})}function _s(n,i,u,f){for(var h=[],y=0,x=Object.entries(n.queries.query);y<x.length;y++){for(var k=x[y],C=k[0],j=[],B=0,S=k[1];B<S.length;B++){var F=S[B];Jo(i,F.obsSet)?F.subscribers.forEach(function(D){return u.add(D)}):f&&j.push(F)}f&&h.push([C,j])}if(f)for(var T=0,$=h;T<$.length;T++){var L=$[T],C=L[0],j=L[1];n.queries.query[C]=j}}function bu(n){var i=n._state,u=n._deps.indexedDB;if(i.isBeingOpened||n.idbdb)return i.dbReadyPromise.then(function(){return i.dbOpenError?Ke(i.dbOpenError):n});i.isBeingOpened=!0,i.dbOpenError=null,i.openComplete=!1;var f=i.openCanceller,h=Math.round(10*n.verno),y=!1;function x(){if(i.openCanceller!==f)throw new de.DatabaseClosed("db.open() was cancelled")}function k(){return new ye(function(F,T){if(x(),!u)throw new de.MissingAPI;var $=n.name,L=i.autoSchema||!h?u.open($):u.open($,h);if(!L)throw new de.MissingAPI;L.onerror=zt(T),L.onblocked=Be(n._fireOnBlocked),L.onupgradeneeded=Be(function(D){var W;B=L.transaction,i.autoSchema&&!n._options.allowEmptyDB?(L.onerror=or,B.abort(),L.result.close(),(W=u.deleteDatabase($)).onsuccess=W.onerror=Be(function(){T(new de.NoSuchDatabase("Database ".concat($," doesnt exist")))})):(B.onerror=zt(T),D=D.oldVersion>Math.pow(2,62)?0:D.oldVersion,S=D<1,n.idbdb=L.result,y&&wu(n,B),vu(n,D/10,B,T))},T),L.onsuccess=Be(function(){B=null;var D,W,U,X,ne,ue=n.idbdb=L.result,pe=H(ue.objectStoreNames);if(0<pe.length)try{var le=ue.transaction((X=pe).length===1?X[0]:X,"readonly");if(i.autoSchema)W=ue,U=le,(D=n).verno=W.version/10,U=D._dbSchema=Hr(0,W,U),D._storeNames=H(W.objectStoreNames,0),Fr(D,[D._allTables],a(U),U);else if(Wr(n,n._dbSchema,le),((ne=Vo(Hr(0,(ne=n).idbdb,le),ne._dbSchema)).add.length||ne.change.some(function(fe){return fe.add.length||fe.change.length}))&&!y)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),ue.close(),h=ue.version+1,y=!0,F(k());Lr(n,le)}catch{}on.push(n),ue.onversionchange=Be(function(fe){i.vcFired=!0,n.on("versionchange").fire(fe)}),ue.onclose=Be(function(fe){n.on("close").fire(fe)}),S&&(ne=n._deps,le=$,ue=ne.indexedDB,ne=ne.IDBKeyRange,Xo(ue)||le===Rn||Uo(ue,ne).put({name:le}).catch(Ee)),F()},T)}).catch(function(F){switch(F==null?void 0:F.name){case"UnknownError":if(0<i.PR1398_maxLoop)return i.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),k();break;case"VersionError":if(0<h)return h=0,k()}return ye.reject(F)})}var C,j=i.dbReadyResolve,B=null,S=!1;return ye.race([f,(typeof navigator>"u"?ye.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(F){function T(){return indexedDB.databases().finally(F)}C=setInterval(T,100),T()}).finally(function(){return clearInterval(C)}):Promise.resolve()).then(k)]).then(function(){return x(),i.onReadyBeingFired=[],ye.resolve(Go(function(){return n.on.ready.fire(n.vip)})).then(function F(){if(0<i.onReadyBeingFired.length){var T=i.onReadyBeingFired.reduce(dt,Ee);return i.onReadyBeingFired=[],ye.resolve(Go(function(){return T(n.vip)})).then(F)}})}).finally(function(){i.openCanceller===f&&(i.onReadyBeingFired=null,i.isBeingOpened=!1)}).catch(function(F){i.dbOpenError=F;try{B&&B.abort()}catch{}return f===i.openCanceller&&n._close(),Ke(F)}).finally(function(){i.openComplete=!0,j()}).then(function(){var F;return S&&(F={},n.tables.forEach(function(T){T.schema.indexes.forEach(function($){$.name&&(F["idb://".concat(n.name,"/").concat(T.name,"/").concat($.name)]=new ot(-1/0,[[[]]]))}),F["idb://".concat(n.name,"/").concat(T.name,"/")]=F["idb://".concat(n.name,"/").concat(T.name,"/:dels")]=new ot(-1/0,[[[]]])}),an(ir).fire(F),ti(F,!0)),n})}function ni(n){function i(y){return n.next(y)}var u=h(i),f=h(function(y){return n.throw(y)});function h(y){return function(C){var k=y(C),C=k.value;return k.done?C:C&&typeof C.then=="function"?C.then(u,f):l(C)?Promise.all(C).then(u,f):u(C)}}return h(i)()}function Xr(n,i,u){for(var f=l(n)?n.slice():[n],h=0;h<u;++h)f.push(i);return f}var _u={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return o(o({},n),{table:function(i){var u=n.table(i),f=u.schema,h={},y=[];function x(S,F,T){var $=ar(S),L=h[$]=h[$]||[],D=S==null?0:typeof S=="string"?1:S.length,W=0<F,W=o(o({},T),{name:W?"".concat($,"(virtual-from:").concat(T.name,")"):T.name,lowLevelIndex:T,isVirtual:W,keyTail:F,keyLength:D,extractKey:Wo(S),unique:!W&&T.unique});return L.push(W),W.isPrimaryKey||y.push(W),1<D&&x(D===2?S[0]:S.slice(0,D-1),F+1,T),L.sort(function(U,X){return U.keyTail-X.keyTail}),W}i=x(f.primaryKey.keyPath,0,f.primaryKey),h[":id"]=[i];for(var k=0,C=f.indexes;k<C.length;k++){var j=C[k];x(j.keyPath,0,j)}function B(S){var F,T=S.query.index;return T.isVirtual?o(o({},S),{query:{index:T.lowLevelIndex,range:(F=S.query.range,T=T.keyTail,{type:F.type===1?2:F.type,lower:Xr(F.lower,F.lowerOpen?n.MAX_KEY:n.MIN_KEY,T),lowerOpen:!0,upper:Xr(F.upper,F.upperOpen?n.MIN_KEY:n.MAX_KEY,T),upperOpen:!0})}}):S}return o(o({},u),{schema:o(o({},f),{primaryKey:i,indexes:y,getIndexByKeyPath:function(S){return(S=h[ar(S)])&&S[0]}}),count:function(S){return u.count(B(S))},query:function(S){return u.query(B(S))},openCursor:function(S){var F=S.query.index,T=F.keyTail,$=F.isVirtual,L=F.keyLength;return $?u.openCursor(B(S)).then(function(W){return W&&D(W)}):u.openCursor(S);function D(W){return Object.create(W,{continue:{value:function(U){U!=null?W.continue(Xr(U,S.reverse?n.MAX_KEY:n.MIN_KEY,T)):S.unique?W.continue(W.key.slice(0,L).concat(S.reverse?n.MIN_KEY:n.MAX_KEY,T)):W.continue()}},continuePrimaryKey:{value:function(U,X){W.continuePrimaryKey(Xr(U,n.MAX_KEY,T),X)}},primaryKey:{get:function(){return W.primaryKey}},key:{get:function(){var U=W.key;return L===1?U[0]:U.slice(0,L)}},value:{get:function(){return W.value}}})}}})}})}};function ri(n,i,u,f){return u=u||{},f=f||"",a(n).forEach(function(h){var y,x,k;g(i,h)?(y=n[h],x=i[h],typeof y=="object"&&typeof x=="object"&&y&&x?(k=A(y))!==A(x)?u[f+h]=i[h]:k==="Object"?ri(y,x,u,f+h+"."):y!==x&&(u[f+h]=i[h]):y!==x&&(u[f+h]=i[h])):u[f+h]=void 0}),a(i).forEach(function(h){g(n,h)||(u[f+h]=i[h])}),u}function oi(n,i){return i.type==="delete"?i.keys:i.keys||i.values.map(n.extractKey)}var ku={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return o(o({},n),{table:function(i){var u=n.table(i),f=u.schema.primaryKey;return o(o({},u),{mutate:function(h){var y=xe.trans,x=y.table(i).hook,k=x.deleting,C=x.creating,j=x.updating;switch(h.type){case"add":if(C.fire===Ee)break;return y._promise("readwrite",function(){return B(h)},!0);case"put":if(C.fire===Ee&&j.fire===Ee)break;return y._promise("readwrite",function(){return B(h)},!0);case"delete":if(k.fire===Ee)break;return y._promise("readwrite",function(){return B(h)},!0);case"deleteRange":if(k.fire===Ee)break;return y._promise("readwrite",function(){return function S(F,T,$){return u.query({trans:F,values:!1,query:{index:f,range:T},limit:$}).then(function(L){var D=L.result;return B({type:"delete",keys:D,trans:F}).then(function(W){return 0<W.numFailures?Promise.reject(W.failures[0]):D.length<$?{failures:[],numFailures:0,lastResult:void 0}:S(F,o(o({},T),{lower:D[D.length-1],lowerOpen:!0}),$)})})}(h.trans,h.range,1e4)},!0)}return u.mutate(h);function B(S){var F,T,$,L=xe.trans,D=S.keys||oi(f,S);if(!D)throw new Error("Keys missing");return(S=S.type==="add"||S.type==="put"?o(o({},S),{keys:D}):o({},S)).type!=="delete"&&(S.values=s([],S.values)),S.keys&&(S.keys=s([],S.keys)),F=u,$=D,((T=S).type==="add"?Promise.resolve([]):F.getMany({trans:T.trans,keys:$,cache:"immutable"})).then(function(W){var U=D.map(function(X,ne){var ue,pe,le,fe=W[ne],ge={onerror:null,onsuccess:null};return S.type==="delete"?k.fire.call(ge,X,fe,L):S.type==="add"||fe===void 0?(ue=C.fire.call(ge,X,S.values[ne],L),X==null&&ue!=null&&(S.keys[ne]=X=ue,f.outbound||Y(S.values[ne],f.keyPath,X))):(ue=ri(fe,S.values[ne]),(pe=j.fire.call(ge,ue,X,fe,L))&&(le=S.values[ne],Object.keys(pe).forEach(function(he){g(le,he)?le[he]=pe[he]:Y(le,he,pe[he])}))),ge});return u.mutate(S).then(function(X){for(var ne=X.failures,ue=X.results,pe=X.numFailures,X=X.lastResult,le=0;le<D.length;++le){var fe=(ue||D)[le],ge=U[le];fe==null?ge.onerror&&ge.onerror(ne[le]):ge.onsuccess&&ge.onsuccess(S.type==="put"&&W[le]?S.values[le]:fe)}return{failures:ne,results:ue,numFailures:pe,lastResult:X}}).catch(function(X){return U.forEach(function(ne){return ne.onerror&&ne.onerror(X)}),Promise.reject(X)})})}}})}})}};function ks(n,i,u){try{if(!i||i.keys.length<n.length)return null;for(var f=[],h=0,y=0;h<i.keys.length&&y<n.length;++h)Te(i.keys[h],n[y])===0&&(f.push(u?ae(i.values[h]):i.values[h]),++y);return f.length===n.length?f:null}catch{return null}}var Eu={stack:"dbcore",level:-1,create:function(n){return{table:function(i){var u=n.table(i);return o(o({},u),{getMany:function(f){if(!f.cache)return u.getMany(f);var h=ks(f.keys,f.trans._cache,f.cache==="clone");return h?ye.resolve(h):u.getMany(f).then(function(y){return f.trans._cache={keys:f.keys,values:f.cache==="clone"?ae(y):y},y})},mutate:function(f){return f.type!=="add"&&(f.trans._cache=null),u.mutate(f)}})}}}};function Es(n,i){return n.trans.mode==="readonly"&&!!n.subscr&&!n.trans.explicit&&n.trans.db._options.cache!=="disabled"&&!i.schema.primaryKey.outbound}function Ss(n,i){switch(n){case"query":return i.values&&!i.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Su={stack:"dbcore",level:0,name:"Observability",create:function(n){var i=n.schema.name,u=new ot(n.MIN_KEY,n.MAX_KEY);return o(o({},n),{transaction:function(f,h,y){if(xe.subscr&&h!=="readonly")throw new de.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(xe.querier));return n.transaction(f,h,y)},table:function(f){var h=n.table(f),y=h.schema,x=y.primaryKey,S=y.indexes,k=x.extractKey,C=x.outbound,j=x.autoIncrement&&S.filter(function(T){return T.compound&&T.keyPath.includes(x.keyPath)}),B=o(o({},h),{mutate:function(T){function $(he){return he="idb://".concat(i,"/").concat(f,"/").concat(he),X[he]||(X[he]=new ot)}var L,D,W,U=T.trans,X=T.mutatedParts||(T.mutatedParts={}),ne=$(""),ue=$(":dels"),pe=T.type,ge=T.type==="deleteRange"?[T.range]:T.type==="delete"?[T.keys]:T.values.length<50?[oi(x,T).filter(function(he){return he}),T.values]:[],le=ge[0],fe=ge[1],ge=T.trans._cache;return l(le)?(ne.addKeys(le),(ge=pe==="delete"||le.length===fe.length?ks(le,ge):null)||ue.addKeys(le),(ge||fe)&&(L=$,D=ge,W=fe,y.indexes.forEach(function(he){var we=L(he.name||"");function Ce(Me){return Me!=null?he.extractKey(Me):null}function Ae(Me){return he.multiEntry&&l(Me)?Me.forEach(function(pt){return we.addKey(pt)}):we.addKey(Me)}(D||W).forEach(function(Me,it){var Ne=D&&Ce(D[it]),it=W&&Ce(W[it]);Te(Ne,it)!==0&&(Ne!=null&&Ae(Ne),it!=null&&Ae(it))})}))):le?(fe={from:(fe=le.lower)!==null&&fe!==void 0?fe:n.MIN_KEY,to:(fe=le.upper)!==null&&fe!==void 0?fe:n.MAX_KEY},ue.add(fe),ne.add(fe)):(ne.add(u),ue.add(u),y.indexes.forEach(function(he){return $(he.name).add(u)})),h.mutate(T).then(function(he){return!le||T.type!=="add"&&T.type!=="put"||(ne.addKeys(he.results),j&&j.forEach(function(we){for(var Ce=T.values.map(function(Ne){return we.extractKey(Ne)}),Ae=we.keyPath.findIndex(function(Ne){return Ne===x.keyPath}),Me=0,pt=he.results.length;Me<pt;++Me)Ce[Me][Ae]=he.results[Me];$(we.name).addKeys(Ce)})),U.mutatedParts=Yr(U.mutatedParts||{},X),he})}}),S=function($){var L=$.query,$=L.index,L=L.range;return[$,new ot(($=L.lower)!==null&&$!==void 0?$:n.MIN_KEY,(L=L.upper)!==null&&L!==void 0?L:n.MAX_KEY)]},F={get:function(T){return[x,new ot(T.key)]},getMany:function(T){return[x,new ot().addKeys(T.keys)]},count:S,query:S,openCursor:S};return a(F).forEach(function(T){B[T]=function($){var L=xe.subscr,D=!!L,W=Es(xe,h)&&Ss(T,$)?$.obsSet={}:L;if(D){var U=function(fe){return fe="idb://".concat(i,"/").concat(f,"/").concat(fe),W[fe]||(W[fe]=new ot)},X=U(""),ne=U(":dels"),L=F[T]($),D=L[0],L=L[1];if((T==="query"&&D.isPrimaryKey&&!$.values?ne:U(D.name||"")).add(L),!D.isPrimaryKey){if(T!=="count"){var ue=T==="query"&&C&&$.values&&h.query(o(o({},$),{values:!1}));return h[T].apply(this,arguments).then(function(fe){if(T==="query"){if(C&&$.values)return ue.then(function(Ce){return Ce=Ce.result,X.addKeys(Ce),fe});var ge=$.values?fe.result.map(k):fe.result;($.values?X:ne).addKeys(ge)}else if(T==="openCursor"){var he=fe,we=$.values;return he&&Object.create(he,{key:{get:function(){return ne.addKey(he.primaryKey),he.key}},primaryKey:{get:function(){var Ce=he.primaryKey;return ne.addKey(Ce),Ce}},value:{get:function(){return we&&X.addKey(he.primaryKey),he.value}}})}return fe})}ne.add(u)}}return h[T].apply(this,arguments)}}),B}})}};function Ns(n,i,u){if(u.numFailures===0)return i;if(i.type==="deleteRange")return null;var f=i.keys?i.keys.length:"values"in i&&i.values?i.values.length:1;return u.numFailures===f?null:(i=o({},i),l(i.keys)&&(i.keys=i.keys.filter(function(h,y){return!(y in u.failures)})),"values"in i&&l(i.values)&&(i.values=i.values.filter(function(h,y){return!(y in u.failures)})),i)}function ii(n,i){return u=n,((f=i).lower===void 0||(f.lowerOpen?0<Te(u,f.lower):0<=Te(u,f.lower)))&&(n=n,(i=i).upper===void 0||(i.upperOpen?Te(n,i.upper)<0:Te(n,i.upper)<=0));var u,f}function Cs(n,i,F,f,h,y){if(!F||F.length===0)return n;var x=i.query.index,k=x.multiEntry,C=i.query.range,j=f.schema.primaryKey.extractKey,B=x.extractKey,S=(x.lowLevelIndex||x).extractKey,F=F.reduce(function(T,$){var L=T,D=[];if($.type==="add"||$.type==="put")for(var W=new ot,U=$.values.length-1;0<=U;--U){var X,ne=$.values[U],ue=j(ne);W.hasKey(ue)||(X=B(ne),(k&&l(X)?X.some(function(he){return ii(he,C)}):ii(X,C))&&(W.addKey(ue),D.push(ne)))}switch($.type){case"add":var pe=new ot().addKeys(i.values?T.map(function(we){return j(we)}):T),L=T.concat(i.values?D.filter(function(we){return we=j(we),!pe.hasKey(we)&&(pe.addKey(we),!0)}):D.map(function(we){return j(we)}).filter(function(we){return!pe.hasKey(we)&&(pe.addKey(we),!0)}));break;case"put":var le=new ot().addKeys($.values.map(function(we){return j(we)}));L=T.filter(function(we){return!le.hasKey(i.values?j(we):we)}).concat(i.values?D:D.map(function(we){return j(we)}));break;case"delete":var fe=new ot().addKeys($.keys);L=T.filter(function(we){return!fe.hasKey(i.values?j(we):we)});break;case"deleteRange":var ge=$.range;L=T.filter(function(we){return!ii(j(we),ge)})}return L},n);return F===n?n:(F.sort(function(T,$){return Te(S(T),S($))||Te(j(T),j($))}),i.limit&&i.limit<1/0&&(F.length>i.limit?F.length=i.limit:n.length===i.limit&&F.length<i.limit&&(h.dirty=!0)),y?Object.freeze(F):F)}function Is(n,i){return Te(n.lower,i.lower)===0&&Te(n.upper,i.upper)===0&&!!n.lowerOpen==!!i.lowerOpen&&!!n.upperOpen==!!i.upperOpen}function Nu(n,i){return function(u,f,h,y){if(u===void 0)return f!==void 0?-1:0;if(f===void 0)return 1;if((f=Te(u,f))===0){if(h&&y)return 0;if(h)return 1;if(y)return-1}return f}(n.lower,i.lower,n.lowerOpen,i.lowerOpen)<=0&&0<=function(u,f,h,y){if(u===void 0)return f!==void 0?1:0;if(f===void 0)return-1;if((f=Te(u,f))===0){if(h&&y)return 0;if(h)return-1;if(y)return 1}return f}(n.upper,i.upper,n.upperOpen,i.upperOpen)}function Cu(n,i,u,f){n.subscribers.add(u),f.addEventListener("abort",function(){var h,y;n.subscribers.delete(u),n.subscribers.size===0&&(h=n,y=i,setTimeout(function(){h.subscribers.size===0&&re(y,h)},3e3))})}var Iu={stack:"dbcore",level:0,name:"Cache",create:function(n){var i=n.schema.name;return o(o({},n),{transaction:function(u,f,h){var y,x,k=n.transaction(u,f,h);return f==="readwrite"&&(x=(y=new AbortController).signal,h=function(C){return function(){if(y.abort(),f==="readwrite"){for(var j=new Set,B=0,S=u;B<S.length;B++){var F=S[B],T=yn["idb://".concat(i,"/").concat(F)];if(T){var $=n.table(F),L=T.optimisticOps.filter(function(we){return we.trans===k});if(k._explicit&&C&&k.mutatedParts)for(var D=0,W=Object.values(T.queries.query);D<W.length;D++)for(var U=0,X=(pe=W[D]).slice();U<X.length;U++)Jo((le=X[U]).obsSet,k.mutatedParts)&&(re(pe,le),le.subscribers.forEach(function(we){return j.add(we)}));else if(0<L.length){T.optimisticOps=T.optimisticOps.filter(function(we){return we.trans!==k});for(var ne=0,ue=Object.values(T.queries.query);ne<ue.length;ne++)for(var pe,le,fe,ge=0,he=(pe=ue[ne]).slice();ge<he.length;ge++)(le=he[ge]).res!=null&&k.mutatedParts&&(C&&!le.dirty?(fe=Object.isFrozen(le.res),fe=Cs(le.res,le.req,L,$,le,fe),le.dirty?(re(pe,le),le.subscribers.forEach(function(we){return j.add(we)})):fe!==le.res&&(le.res=fe,le.promise=ye.resolve({result:fe}))):(le.dirty&&re(pe,le),le.subscribers.forEach(function(we){return j.add(we)})))}}}j.forEach(function(we){return we()})}}},k.addEventListener("abort",h(!1),{signal:x}),k.addEventListener("error",h(!1),{signal:x}),k.addEventListener("complete",h(!0),{signal:x})),k},table:function(u){var f=n.table(u),h=f.schema.primaryKey;return o(o({},f),{mutate:function(y){var x=xe.trans;if(h.outbound||x.db._options.cache==="disabled"||x.explicit||x.idbtrans.mode!=="readwrite")return f.mutate(y);var k=yn["idb://".concat(i,"/").concat(u)];return k?(x=f.mutate(y),y.type!=="add"&&y.type!=="put"||!(50<=y.values.length||oi(h,y).some(function(C){return C==null}))?(k.optimisticOps.push(y),y.mutatedParts&&Ur(y.mutatedParts),x.then(function(C){0<C.numFailures&&(re(k.optimisticOps,y),(C=Ns(0,y,C))&&k.optimisticOps.push(C),y.mutatedParts&&Ur(y.mutatedParts))}),x.catch(function(){re(k.optimisticOps,y),y.mutatedParts&&Ur(y.mutatedParts)})):x.then(function(C){var j=Ns(0,o(o({},y),{values:y.values.map(function(B,S){var F;return C.failures[S]?B:(B=(F=h.keyPath)!==null&&F!==void 0&&F.includes(".")?ae(B):o({},B),Y(B,h.keyPath,C.results[S]),B)})}),C);k.optimisticOps.push(j),queueMicrotask(function(){return y.mutatedParts&&Ur(y.mutatedParts)})}),x):f.mutate(y)},query:function(y){if(!Es(xe,f)||!Ss("query",y))return f.query(y);var x=((j=xe.trans)===null||j===void 0?void 0:j.db._options.cache)==="immutable",S=xe,k=S.requery,C=S.signal,j=function($,L,D,W){var U=yn["idb://".concat($,"/").concat(L)];if(!U)return[];if(!(L=U.queries[D]))return[null,!1,U,null];var X=L[(W.query?W.query.index.name:null)||""];if(!X)return[null,!1,U,null];switch(D){case"query":var ne=X.find(function(ue){return ue.req.limit===W.limit&&ue.req.values===W.values&&Is(ue.req.query.range,W.query.range)});return ne?[ne,!0,U,X]:[X.find(function(ue){return("limit"in ue.req?ue.req.limit:1/0)>=W.limit&&(!W.values||ue.req.values)&&Nu(ue.req.query.range,W.query.range)}),!1,U,X];case"count":return ne=X.find(function(ue){return Is(ue.req.query.range,W.query.range)}),[ne,!!ne,U,X]}}(i,u,"query",y),B=j[0],S=j[1],F=j[2],T=j[3];return B&&S?B.obsSet=y.obsSet:(S=f.query(y).then(function($){var L=$.result;if(B&&(B.res=L),x){for(var D=0,W=L.length;D<W;++D)Object.freeze(L[D]);Object.freeze(L)}else $.result=ae(L);return $}).catch(function($){return T&&B&&re(T,B),Promise.reject($)}),B={obsSet:y.obsSet,promise:S,subscribers:new Set,type:"query",req:y,dirty:!1},T?T.push(B):(T=[B],(F=F||(yn["idb://".concat(i,"/").concat(u)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[y.query.index.name||""]=T)),Cu(B,T,k,C),B.promise.then(function($){return{result:Cs($.result,y,F==null?void 0:F.optimisticOps,f,B,x)}})}})}})}};function Gr(n,i){return new Proxy(n,{get:function(u,f,h){return f==="db"?i:Reflect.get(u,f,h)}})}var Xt=(Ve.prototype.version=function(n){if(isNaN(n)||n<.1)throw new de.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new de.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var i=this._versions,u=i.filter(function(f){return f._cfg.version===n})[0];return u||(u=new this.Version(n),i.push(u),i.sort(gu),u.stores({}),this._state.autoSchema=!1,u)},Ve.prototype._whenReady=function(n){var i=this;return this.idbdb&&(this._state.openComplete||xe.letThrough||this._vip)?n():new ye(function(u,f){if(i._state.openComplete)return f(new de.DatabaseClosed(i._state.dbOpenError));if(!i._state.isBeingOpened){if(!i._state.autoOpen)return void f(new de.DatabaseClosed);i.open().catch(Ee)}i._state.dbReadyPromise.then(u,f)}).then(n)},Ve.prototype.use=function(n){var i=n.stack,u=n.create,f=n.level,h=n.name;return h&&this.unuse({stack:i,name:h}),n=this._middlewares[i]||(this._middlewares[i]=[]),n.push({stack:i,create:u,level:f??10,name:h}),n.sort(function(y,x){return y.level-x.level}),this},Ve.prototype.unuse=function(n){var i=n.stack,u=n.name,f=n.create;return i&&this._middlewares[i]&&(this._middlewares[i]=this._middlewares[i].filter(function(h){return f?h.create!==f:!!u&&h.name!==u})),this},Ve.prototype.open=function(){var n=this;return Yt(rt,function(){return bu(n)})},Ve.prototype._close=function(){var n=this._state,i=on.indexOf(this);if(0<=i&&on.splice(i,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}n.isBeingOpened||(n.dbReadyPromise=new ye(function(u){n.dbReadyResolve=u}),n.openCanceller=new ye(function(u,f){n.cancelOpen=f}))},Ve.prototype.close=function(u){var i=(u===void 0?{disableAutoOpen:!0}:u).disableAutoOpen,u=this._state;i?(u.isBeingOpened&&u.cancelOpen(new de.DatabaseClosed),this._close(),u.autoOpen=!1,u.dbOpenError=new de.DatabaseClosed):(this._close(),u.autoOpen=this._options.autoOpen||u.isBeingOpened,u.openComplete=!1,u.dbOpenError=null)},Ve.prototype.delete=function(n){var i=this;n===void 0&&(n={disableAutoOpen:!0});var u=0<arguments.length&&typeof arguments[0]!="object",f=this._state;return new ye(function(h,y){function x(){i.close(n);var k=i._deps.indexedDB.deleteDatabase(i.name);k.onsuccess=Be(function(){var C,j,B;C=i._deps,j=i.name,B=C.indexedDB,C=C.IDBKeyRange,Xo(B)||j===Rn||Uo(B,C).delete(j).catch(Ee),h()}),k.onerror=zt(y),k.onblocked=i._fireOnBlocked}if(u)throw new de.InvalidArgument("Invalid closeOptions argument to db.delete()");f.isBeingOpened?f.dbReadyPromise.then(x):x()})},Ve.prototype.backendDB=function(){return this.idbdb},Ve.prototype.isOpen=function(){return this.idbdb!==null},Ve.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&n.name==="DatabaseClosed"},Ve.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Ve.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Ve.prototype,"tables",{get:function(){var n=this;return a(this._allTables).map(function(i){return n._allTables[i]})},enumerable:!1,configurable:!0}),Ve.prototype.transaction=function(){var n=(function(i,u,f){var h=arguments.length;if(h<2)throw new de.InvalidArgument("Too few arguments");for(var y=new Array(h-1);--h;)y[h-1]=arguments[h];return f=y.pop(),[i,ie(y),f]}).apply(this,arguments);return this._transaction.apply(this,n)},Ve.prototype._transaction=function(n,i,u){var f=this,h=xe.trans;h&&h.db===this&&n.indexOf("!")===-1||(h=null);var y,x,k=n.indexOf("?")!==-1;n=n.replace("!","").replace("?","");try{if(x=i.map(function(j){if(j=j instanceof f.Table?j.name:j,typeof j!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return j}),n=="r"||n===Qn)y=Qn;else{if(n!="rw"&&n!=er)throw new de.InvalidArgument("Invalid transaction mode: "+n);y=er}if(h){if(h.mode===Qn&&y===er){if(!k)throw new de.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");h=null}h&&x.forEach(function(j){if(h&&h.storeNames.indexOf(j)===-1){if(!k)throw new de.SubTransaction("Table "+j+" not included in parent transaction.");h=null}}),k&&h&&!h.active&&(h=null)}}catch(j){return h?h._promise(null,function(B,S){S(j)}):Ke(j)}var C=(function j(B,S,F,T,$){return ye.resolve().then(function(){var L=xe.transless||xe,D=B._createTransaction(S,F,B._dbSchema,T);if(D.explicit=!0,L={trans:D,transless:L},T)D.idbtrans=T.idbtrans;else try{D.create(),D.idbtrans._explicit=!0,B._state.PR1398_maxLoop=3}catch(X){return X.name===Ie.InvalidState&&B.isOpen()&&0<--B._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),B.close({disableAutoOpen:!1}),B.open().then(function(){return j(B,S,F,null,$)})):Ke(X)}var W,U=oe($);return U&&rn(),L=ye.follow(function(){var X;(W=$.call(D,D))&&(U?(X=St.bind(null,null),W.then(X,X)):typeof W.next=="function"&&typeof W.throw=="function"&&(W=ni(W)))},L),(W&&typeof W.then=="function"?ye.resolve(W).then(function(X){return D.active?X:Ke(new de.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):L.then(function(){return W})).then(function(X){return T&&D._resolve(),D._completion.then(function(){return X})}).catch(function(X){return D._reject(X),Ke(X)})})}).bind(null,this,y,x,h,u);return h?h._promise(y,C,"lock"):xe.trans?Yt(xe.transless,function(){return f._whenReady(C)}):this._whenReady(C)},Ve.prototype.table=function(n){if(!g(this._allTables,n))throw new de.InvalidTable("Table ".concat(n," does not exist"));return this._allTables[n]},Ve);function Ve(n,i){var u=this;this._middlewares={},this.verno=0;var f=Ve.dependencies;this._options=i=o({addons:Ve.addons,autoOpen:!0,indexedDB:f.indexedDB,IDBKeyRange:f.IDBKeyRange,cache:"cloned"},i),this._deps={indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange},f=i.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var h,y,x,k,C,j={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Ee,dbReadyPromise:null,cancelOpen:Ee,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:i.autoOpen};j.dbReadyPromise=new ye(function(S){j.dbReadyResolve=S}),j.openCanceller=new ye(function(S,F){j.cancelOpen=F}),this._state=j,this.name=n,this.on=tr(this,"populate","blocked","versionchange","close",{ready:[dt,Ee]}),this.on.ready.subscribe=K(this.on.ready.subscribe,function(S){return function(F,T){Ve.vip(function(){var $,L=u._state;L.openComplete?(L.dbOpenError||ye.resolve().then(F),T&&S(F)):L.onReadyBeingFired?(L.onReadyBeingFired.push(F),T&&S(F)):(S(F),$=u,T||S(function D(){$.on.ready.unsubscribe(F),$.on.ready.unsubscribe(D)}))})}}),this.Collection=(h=this,nr(lu.prototype,function(W,D){this.db=h;var T=Dr,$=null;if(D)try{T=D()}catch(U){$=U}var L=W._ctx,D=L.table,W=D.hook.reading.fire;this._ctx={table:D,index:L.index,isPrimKey:!L.index||D.schema.primKey.keyPath&&L.index===D.schema.primKey.name,range:T,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:$,or:L.or,valueMapper:W!==qe?W:null}})),this.Table=(y=this,nr(us.prototype,function(S,F,T){this.db=y,this._tx=T,this.name=S,this.schema=F,this.hook=y._allTables[S]?y._allTables[S].hook:tr(null,{creating:[at,Ee],reading:[Xe,qe],updating:[ke,Ee],deleting:[Oe,Ee]})})),this.Transaction=(x=this,nr(hu.prototype,function(S,F,T,$,L){var D=this;this.db=x,this.mode=S,this.storeNames=F,this.schema=T,this.chromeTransactionDurability=$,this.idbtrans=null,this.on=tr(this,"complete","error","abort"),this.parent=L||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new ye(function(W,U){D._resolve=W,D._reject=U}),this._completion.then(function(){D.active=!1,D.on.complete.fire()},function(W){var U=D.active;return D.active=!1,D.on.error.fire(W),D.parent?D.parent._reject(W):U&&D.idbtrans&&D.idbtrans.abort(),Ke(W)})})),this.Version=(k=this,nr(xu.prototype,function(S){this.db=k,this._cfg={version:S,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(C=this,nr(ps.prototype,function(S,F,T){if(this.db=C,this._ctx={table:S,index:F===":id"?null:F,or:T},this._cmp=this._ascending=Te,this._descending=function($,L){return Te(L,$)},this._max=function($,L){return 0<Te($,L)?$:L},this._min=function($,L){return Te($,L)<0?$:L},this._IDBKeyRange=C._deps.IDBKeyRange,!this._IDBKeyRange)throw new de.MissingAPI})),this.on("versionchange",function(S){0<S.newVersion?console.warn("Another connection wants to upgrade database '".concat(u.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(u.name,"'. Closing db now to resume the delete request.")),u.close({disableAutoOpen:!1})}),this.on("blocked",function(S){!S.newVersion||S.newVersion<S.oldVersion?console.warn("Dexie.delete('".concat(u.name,"') was blocked")):console.warn("Upgrade '".concat(u.name,"' blocked by other connection holding version ").concat(S.oldVersion/10))}),this._maxKey=sr(i.IDBKeyRange),this._createTransaction=function(S,F,T,$){return new u.Transaction(S,F,T,u._options.chromeTransactionDurability,$)},this._fireOnBlocked=function(S){u.on("blocked").fire(S),on.filter(function(F){return F.name===u.name&&F!==u&&!F._state.vcFired}).map(function(F){return F.on("versionchange").fire(S)})},this.use(Eu),this.use(Iu),this.use(Su),this.use(_u),this.use(ku);var B=new Proxy(this,{get:function(S,F,T){if(F==="_vip")return!0;if(F==="table")return function(L){return Gr(u.table(L),B)};var $=Reflect.get(S,F,T);return $ instanceof us?Gr($,B):F==="tables"?$.map(function(L){return Gr(L,B)}):F==="_createTransaction"?function(){return Gr($.apply(this,arguments),B)}:$}});this.vip=B,f.forEach(function(S){return S(u)})}var Zr,xt=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Tu=(si.prototype.subscribe=function(n,i,u){return this._subscribe(n&&typeof n!="function"?n:{next:n,error:i,complete:u})},si.prototype[xt]=function(){return this},si);function si(n){this._subscribe=n}try{Zr={indexedDB:c.indexedDB||c.mozIndexedDB||c.webkitIndexedDB||c.msIndexedDB,IDBKeyRange:c.IDBKeyRange||c.webkitIDBKeyRange}}catch{Zr={indexedDB:null,IDBKeyRange:null}}function Ts(n){var i,u=!1,f=new Tu(function(h){var y=oe(n),x,k=!1,C={},j={},B={get closed(){return k},unsubscribe:function(){k||(k=!0,x&&x.abort(),S&&an.storagemutated.unsubscribe(T))}};h.start&&h.start(B);var S=!1,F=function(){return Jn($)},T=function(L){Yr(C,L),Jo(j,C)&&F()},$=function(){var L,D,W;!k&&Zr.indexedDB&&(C={},L={},x&&x.abort(),x=new AbortController,W=function(U){var X=tn();try{y&&rn();var ne=Dt(n,U);return ne=y?ne.finally(St):ne}finally{X&&nn()}}(D={subscr:L,signal:x.signal,requery:F,querier:n,trans:null}),Promise.resolve(W).then(function(U){u=!0,i=U,k||D.signal.aborted||(C={},function(X){for(var ne in X)if(g(X,ne))return;return 1}(j=L)||S||(an(ir,T),S=!0),Jn(function(){return!k&&h.next&&h.next(U)}))},function(U){u=!1,["DatabaseClosedError","AbortError"].includes(U==null?void 0:U.name)||k||Jn(function(){k||h.error&&h.error(U)})}))};return setTimeout(F,0),B});return f.hasValue=function(){return u},f.getValue=function(){return i},f}var gn=Xt;function ai(n){var i=cn;try{cn=!0,an.storagemutated.fire(n),ti(n,!0)}finally{cn=i}}v(gn,o(o({},He),{delete:function(n){return new gn(n,{addons:[]}).delete()},exists:function(n){return new gn(n,{addons:[]}).open().then(function(i){return i.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(n){try{return i=gn.dependencies,u=i.indexedDB,i=i.IDBKeyRange,(Xo(u)?Promise.resolve(u.databases()).then(function(f){return f.map(function(h){return h.name}).filter(function(h){return h!==Rn})}):Uo(u,i).toCollection().primaryKeys()).then(n)}catch{return Ke(new de.MissingAPI)}var i,u},defineClass:function(){return function(n){d(this,n)}},ignoreTransaction:function(n){return xe.trans?Yt(xe.transless,n):n()},vip:Go,async:function(n){return function(){try{var i=ni(n.apply(this,arguments));return i&&typeof i.then=="function"?i:ye.resolve(i)}catch(u){return Ke(u)}}},spawn:function(n,i,u){try{var f=ni(n.apply(u,i||[]));return f&&typeof f.then=="function"?f:ye.resolve(f)}catch(h){return Ke(h)}},currentTransaction:{get:function(){return xe.trans||null}},waitFor:function(n,i){return i=ye.resolve(typeof n=="function"?gn.ignoreTransaction(n):n).timeout(i||6e4),xe.trans?xe.trans.waitFor(i):i},Promise:ye,debug:{get:function(){return tt},set:function(n){qt(n)}},derive:N,extend:d,props:v,override:K,Events:tr,on:an,liveQuery:Ts,extendObservabilitySet:Yr,getByKeyPath:G,setByKeyPath:Y,delByKeyPath:function(n,i){typeof i=="string"?Y(n,i,void 0):"length"in i&&[].map.call(i,function(u){Y(n,u,void 0)})},shallowClone:te,deepClone:ae,getObjectDiff:ri,cmp:Te,asap:Q,minKey:-1/0,addons:[],connections:on,errnames:Ie,dependencies:Zr,cache:yn,semVer:"4.0.10",version:"4.0.10".split(".").map(function(n){return parseInt(n)}).reduce(function(n,i,u){return n+i/Math.pow(10,2*u)})})),gn.maxKey=sr(gn.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(an(ir,function(n){cn||(n=new CustomEvent(Fo,{detail:n}),cn=!0,dispatchEvent(n),cn=!1)}),addEventListener(Fo,function(n){n=n.detail,cn||ai(n)}));var $n,cn=!1,As=function(){};return typeof BroadcastChannel<"u"&&((As=function(){($n=new BroadcastChannel(Fo)).onmessage=function(n){return n.data&&ai(n.data)}})(),typeof $n.unref=="function"&&$n.unref(),an(ir,function(n){cn||$n.postMessage(n)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(n){if(!Xt.disableBfCache&&n.persisted){tt&&console.debug("Dexie: handling persisted pagehide"),$n!=null&&$n.close();for(var i=0,u=on;i<u.length;i++)u[i].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(n){!Xt.disableBfCache&&n.persisted&&(tt&&console.debug("Dexie: handling persisted pageshow"),As(),ai({all:new ot(-1/0,[[]])}))})),ye.rejectionMapper=function(n,i){return!n||n instanceof me||n instanceof TypeError||n instanceof SyntaxError||!n.name||!Re[n.name]?n:(i=new Re[n.name](i||n.message,n),"stack"in n&&E(i,"stack",{get:function(){return this.inner.stack}}),i)},qt(tt),o(Xt,Object.freeze({__proto__:null,Dexie:Xt,liveQuery:Ts,Entity:Or,cmp:Te,PropModSymbol:Ut,PropModification:rr,replacePrefix:function(n,i){return new rr({replacePrefix:[n,i]})},add:function(n){return new rr({add:n})},remove:function(n){return new rr({remove:n})},default:Xt,RangeSet:ot,mergeRanges:ur,rangesOverlap:ws}),{default:Xt}),Xt})})(iu);var sy=iu.exports;const $i=Sa(sy),_a=Symbol.for("Dexie"),Bi=globalThis[_a]||(globalThis[_a]=$i);if($i.semVer!==Bi.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${$i.semVer} and ${Bi.semVer}`);class ay extends Bi{constructor(){super("TemporalDB"),this.version(3).stores({workflows:"[workflowId+runId],[parentWorkflowId+parentWorkflowRunId], parentWorkflowId, parentWorkflowRunId",activities:"[activityId+workflowId+workflowRunId],[workflowId+workflowRunId], workflowId, workflowRunId",settings:"id"})}}const Wt=new ay;async function zi(e){try{await Wt.workflows.put(e),console.debug("Workflow added successfully:",e)}catch(t){console.error("Failed to add workflow:",t,e)}}async function Ar(e,t){if(t)try{const r=await Wt.workflows.get({workflowId:e,runId:t});return console.debug("Retrieved Workflow:",r),r}catch(r){console.error("Failed to retrieve workflow:",r);return}}async function cy(e,t){try{await Wt.workflows.where({workflowId:e,runId:t}).delete(),console.debug(`Deleted Workflow with ID: ${e}`)}catch(r){console.error("Failed to delete workflow:",r)}}async function su(e){try{await Wt.activities.put(e),console.debug("Activity added successfully:",e)}catch(t){console.error("Failed to add activity:",t,e)}}async function uy(e,t,r){try{const o=await Wt.activities.get({activityId:t,workflowId:e,workflowRunId:r});return console.debug("Retrieved Activity:",o),o}catch(o){console.error("Failed to retrieve activity:",o);return}}async function ly(e,t,r){try{await Wt.activities.where({activityId:t,workflowId:e,workflowRunId:r}).delete(),console.debug(`Deleted Activity with ID: ${t}`)}catch(o){console.error("Failed to delete activity:",o)}}async function au(e,t){try{return await Wt.activities.where(["workflowId","workflowRunId"]).equals([e,t]).toArray()}catch(r){return console.error("Failed to retrieve activities by workflowId:",r),[]}}async function ss(e,t){try{return await Wt.workflows.where(["parentWorkflowId","parentWorkflowRunId"]).equals([e,t]).toArray()}catch(r){return console.error("Failed to retrieve child workflows:",r),[]}}async function fy(e,t,r){if(!e)return[];const o=[];for(const s of e)if(s.type==="workflow"||s.type==="childWorkflow"){const c=await Ar(s.id,s.workflowRunId);c&&o.push(c)}else if(s.type==="activity"){const c=await uy(t,s.id,r);c&&o.push(c)}return o}async function dy(e){try{const t=await Wt.settings.get(e);return t==null?void 0:t.value}catch(t){console.error("Failed to retrieve setting:",t);return}}async function hy(e,t){try{await Wt.settings.put({id:e,value:t}),console.debug(`Setting ${e} updated successfully:`,t)}catch(r){console.error("Failed to update setting:",r)}}const ln={name:"default-queue",kind:"TASK_QUEUE_KIND_NORMAL"},py=()=>{const e="demo-order-processing-wf-001",t=new Date().toISOString(),r=new Date(Date.parse(t)+6e4).toISOString(),o=new Date(Date.parse(t)+12e4).toISOString(),s=new Date(Date.parse(t)+18e4).toISOString(),c="1",a="2",l="3",d={orderId:"ORD-001",customer:{id:"CUST-123",name:"John Doe",email:"john.doe@example.com"},items:[{id:"ITEM-1",name:"Gaming Laptop",price:1299.99,quantity:1},{id:"ITEM-2",name:"Wireless Mouse",price:49.99,quantity:2}],totalAmount:1399.97,shippingAddress:{street:"123 Tech Lane",city:"San Francisco",state:"CA",zipCode:"94105"}},p=[{type:"workflow",workflowId:e,workflowType:"OrderProcessingWorkflow",status:"RUNNING",startTime:t,endTime:void 0,taskQueue:ln,input:JSON.stringify(d),workflowTaskCompletedEventId:c,memo:{description:"Process customer order with validation and fulfillment",priority:"HIGH"}},{type:"childWorkflow",workflowId:"demo-fulfillment-wf-001",workflowType:"OrderFulfillmentWorkflow",parentWorkflowId:e,status:"RUNNING",startTime:t,endTime:void 0,taskQueue:ln,workflowTaskCompletedEventId:a,input:JSON.stringify({orderId:d.orderId,items:d.items,shippingAddress:d.shippingAddress,warehouseId:"WH-SF-001"})},...Array(5).fill(null).map((g,v)=>({type:"childWorkflow",workflowId:`demo-shipping-wf-00${v+1}`,workflowType:"ShippingWorkflow",parentWorkflowId:"demo-fulfillment-wf-001",status:"RUNNING",startTime:t,endTime:void 0,taskQueue:ln,workflowTaskCompletedEventId:l,input:JSON.stringify({packageId:`PKG-00${v+1}`,orderId:d.orderId,item:d.items[v%2],shippingAddress:d.shippingAddress,carrier:"FastShip",trackingPrefix:"FS"})}))],m=[{type:"activity",activityId:"validate-order-001",activityType:"ValidateOrderActivity",workflowId:e,status:"COMPLETED",startTime:t,endTime:r,taskQueue:ln,input:JSON.stringify({orderId:d.orderId,customerId:d.customer.id,items:d.items,totalAmount:d.totalAmount}),result:JSON.stringify({isValid:!0,validatedAt:t,checks:{inventory:!0,pricing:!0,customerStatus:"ACTIVE",fraudCheck:{passed:!0,score:.95,reasons:["Valid customer history","Normal order pattern"]}}}),workflowTaskCompletedEventId:c},{type:"activity",activityId:"process-payment-001",activityType:"ProcessPaymentActivity",workflowId:e,status:"COMPLETED",startTime:r,endTime:o,taskQueue:ln,input:JSON.stringify({orderId:d.orderId,amount:d.totalAmount,customerId:d.customer.id,paymentMethod:{type:"CREDIT_CARD",last4:"4242",brand:"Visa",expiryMonth:12,expiryYear:2025}}),result:JSON.stringify({transactionId:"TX-789012",status:"APPROVED",processedAt:r,paymentDetails:{authorizationCode:"AUTH123",avsResult:"Y",cvvResult:"M",processorResponse:"Approved"}}),workflowTaskCompletedEventId:c},{type:"activity",activityId:"inventory-check-001",activityType:"CheckInventoryActivity",workflowId:"demo-fulfillment-wf-001",status:"COMPLETED",startTime:o,endTime:s,taskQueue:ln,input:JSON.stringify({warehouseId:"WH-SF-001",items:d.items,reservationDuration:"30m"}),result:JSON.stringify({available:!0,itemsAvailability:d.items.map(g=>({itemId:g.id,available:!0,quantity:g.quantity,location:"Zone-A12",binNumber:"BIN-456",reservationId:`RES-${g.id}`,expiresAt:new Date(Date.parse(s)+18e5).toISOString()}))}),workflowTaskCompletedEventId:a},{type:"activity",activityId:"prepare-shipment-001",activityType:"PrepareShipmentActivity",workflowId:"demo-fulfillment-wf-001",status:"FAILED",startTime:s,endTime:new Date(Date.parse(s)+3e4).toISOString(),taskQueue:ln,input:JSON.stringify({orderId:d.orderId,items:d.items,warehouseId:"WH-SF-001",packagingType:"STANDARD",packagingRequirements:{type:"BOX_MEDIUM",reinforced:!0,materials:["bubble_wrap","foam_padding"]}}),result:JSON.stringify({error:"PACKAGING_MATERIAL_UNAVAILABLE",message:"Required packaging material out of stock",details:{missingMaterials:["foam_padding"],availableAlternatives:["air_pillows"],nextRestockScheduled:new Date(Date.parse(t)+864e5).toISOString()},timestamp:s,errorCode:"PKG_001",severity:"MEDIUM"}),workflowTaskCompletedEventId:a},...Array(5).fill(null).map((g,v)=>({type:"activity",activityId:`process-shipping-00${v+1}`,activityType:"ProcessShippingActivity",workflowId:`demo-shipping-wf-00${v+1}`,status:"RUNNING",startTime:new Date(Date.parse(s)+v*1e4).toISOString(),endTime:void 0,taskQueue:ln,input:JSON.stringify({packageId:`PKG-00${v+1}`,orderId:d.orderId,carrier:"FastShip",service:"NEXT_DAY",dimensions:{length:15,width:10,height:5,weight:2.5,unit:"IMPERIAL"},shippingAddress:d.shippingAddress,item:d.items[v%2],specialInstructions:"Handle with care",insurance:{required:!0,value:d.items[v%2].price}}),workflowTaskCompletedEventId:l}))];return{workflows:p,activities:m}},my=async()=>{const e="demo-order-processing-wf-001";try{const{workflows:t,activities:r}=py();for(const o of t)await zi(o);for(const o of r)await su(o);return console.log("Demo data stored successfully"),e}catch(t){return console.error("Error storing demo data:",t),""}},yy=({showFocus:e,setShowFocus:t,autoZoomEnabled:r,setAutoZoomEnabled:o,setIsTemporalModalOpen:s,refreshWorkflowData:c,isRefreshing:a=!1,currentWorkflowId:l,onTemporalRootWorkflowDataCollected:d})=>{O.useEffect(()=>{(async()=>{const w=await dy("autoZoomEnabled");w!==void 0&&o(w)})()},[o]);const p=async()=>{const v=!r;o(v),await hy("autoZoomEnabled",v)},m=()=>{if(console.log("Refreshing root workflow",l),!c){console.log("No refresh function provided");return}if(!l){console.log("No workflow ID provided");return}c(l)},g=async()=>{const v=await my();v&&await d(v)};return _.jsxs("div",{className:"flex gap-2 items-center",children:[_.jsx("button",{onClick:m,className:"p-2",title:"Refresh workflow data from Temporal",children:_.jsx(ty,{className:"h-4 w-4"})}),_.jsx("button",{className:"px-3 py-1 rounded bg-green-500 text-white hover:bg-green-600",onClick:()=>s(!0),children:"Temporal"}),_.jsxs("button",{className:`px-3 py-1 rounded ${r?"bg-green-500 text-white":"bg-gray-200 text-gray-700"}`,onClick:p,children:["Auto Zoom ",r?"On":"Off"]}),_.jsxs("button",{className:"px-3 py-1 rounded bg-gray-200 text-gray-700 hover:bg-gray-300",onClick:()=>t(!e),children:[e?"Hide":"Show"," Focus"]}),_.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 text-gray-700 hover:bg-gray-300",onClick:g,children:"Demo"})]})};function gy({id:e,data:t,onClose:r,position:o}){const[s,c]=O.useState("io"),a=O.useRef(null),l=O.useRef(null),[d,p]=O.useState({width:600,height:600}),[m,g]=O.useState(!1),[v,w]=O.useState(!1),E=O.useRef({x:0,y:0,width:0,height:0}),[N,z]=O.useState({x:0,y:0}),[P,H]=O.useState(100);O.useEffect(()=>{t&&t!==l.current&&(c("io"),l.current=t)},[t]),O.useEffect(()=>{const A=a.current;A&&(A.style.display="none",A.scrollTop=0,A.offsetHeight,A.style.display="")},[t,s]),O.useEffect(()=>{H(A=>Math.max(A,100))},[]);const K=A=>{var Z;if(!A.target||!(A.target instanceof HTMLElement)||!A.target.closest("[data-drag-handle]"))return;A.preventDefault(),g(!0);const R=(Z=a.current)==null?void 0:Z.getBoundingClientRect();R&&(E.current={x:A.clientX-R.left,y:A.clientY-R.top,width:d.width,height:d.height}),document.body.style.userSelect="none"},I=A=>{var R,Z;A.stopPropagation(),A.preventDefault(),w(!0),E.current={x:A.clientX,y:A.clientY,width:((R=a.current)==null?void 0:R.offsetWidth)||d.width,height:((Z=a.current)==null?void 0:Z.offsetHeight)||d.height},document.body.style.userSelect="none"};O.useEffect(()=>{const A=Z=>{if(!(!m&&!v))if(v&&a.current){const re=Z.clientX-E.current.x,M=Z.clientY-E.current.y,q=Math.max(300,E.current.width+re),oe=Math.max(400,E.current.height+M);(q!==d.width||oe!==d.height)&&p({width:q,height:oe})}else m&&z({x:Z.clientX-E.current.x-o.x,y:Z.clientY-E.current.y-o.y})},R=()=>{g(!1),w(!1),document.body.style.userSelect=""};return(m||v)&&(window.addEventListener("mousemove",A),window.addEventListener("mouseup",R)),()=>{window.removeEventListener("mousemove",A),window.removeEventListener("mouseup",R)}},[m,v,o]);const Q=()=>{if(!o)return{};const A=20,R=window.innerWidth,Z=window.innerHeight;let re=Math.min(Math.max(A,o.x+N.x),R-d.width-A),M=Math.min(Math.max(A,o.y+N.y),Z-d.height-A);return{left:re,top:M}},G=()=>{const A=document.querySelectorAll("[data-node-panel]"),R=Array.from(A).reduce((Z,re)=>{const M=parseInt(window.getComputedStyle(re).zIndex)||0;return Math.max(Z,M)},100);H(R+1)};if(!t||!o)return null;const Y=!!(t.lastFailure||t.failure),te=!!(t.scheduleTime||t.startTime||t.endTime),V=!!(t.input||t.result||t.memo&&Object.keys(t.memo).length>0||t.searchAttributes&&Object.keys(t.searchAttributes).length>0),ee=(t.type==="workflow"||t.type==="childWorkflow")&&t.namespace&&t.workflowId?`https://cloud.temporal.io/namespaces/${t.namespace}/workflows/${t.workflowId}`:null,se=({tab:A,label:R,disabled:Z})=>_.jsx("button",{onClick:()=>!Z&&c(A),disabled:Z,className:Ft("px-4 py-2 text-sm font-medium transition-colors rounded-t-lg","focus:outline-none",Z&&"opacity-50 cursor-not-allowed",s===A?{io:"bg-blue-100 text-blue-800",error:"bg-red-100 text-red-800",time:"bg-purple-100 text-purple-800",common:"bg-green-100 text-green-800"}[A]:"text-gray-600 hover:bg-gray-100"),children:R}),ae=()=>{var R;const A="space-y-4 min-h-[300px]";switch(s){case"io":return _.jsxs("div",{className:A,children:[t.input&&_.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg overflow-auto relative",children:[_.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"Input"}),_.jsx(b,{content:JSON.stringify(JSON.parse(t.input),null,2)}),_.jsx("div",{className:"overflow-auto",children:_.jsx("pre",{className:"text-xs text-blue-700 whitespace-pre-wrap break-all bg-blue-100 p-2 rounded min-w-fit",children:JSON.stringify(JSON.parse(t.input),null,2)})})]}),t.result&&_.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg overflow-auto relative",children:[_.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"Result"}),_.jsx(b,{content:JSON.stringify(JSON.parse(t.result),null,2)}),_.jsx("div",{className:"overflow-auto",children:_.jsx("pre",{className:"text-xs text-blue-700 whitespace-pre-wrap break-all bg-blue-100 p-2 rounded min-w-fit",children:JSON.stringify(JSON.parse(t.result),null,2)})})]}),t.header&&Object.keys(t.header).length>0&&_.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg overflow-auto relative",children:[_.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"Header"}),_.jsx(b,{content:JSON.stringify(t.header,null,2)}),_.jsx("div",{className:"overflow-auto",children:_.jsx("pre",{className:"text-xs text-blue-700 whitespace-pre-wrap break-all bg-blue-100 p-2 rounded min-w-fit",children:JSON.stringify(t.header,null,2)})})]}),t.memo&&Object.keys(t.memo).length>0&&_.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg overflow-auto",children:[_.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"Memo"}),_.jsx("div",{className:"overflow-auto",children:_.jsx("pre",{className:"text-xs text-blue-700 whitespace-pre-wrap bg-blue-100 p-2 rounded min-w-fit",children:JSON.stringify(t.memo,null,2)})})]}),t.searchAttributes&&Object.keys(t.searchAttributes).length>0&&_.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg overflow-auto",children:[_.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"Search Attributes"}),_.jsx("div",{className:"overflow-auto",children:_.jsx("pre",{className:"text-xs text-blue-700 whitespace-pre-wrap bg-blue-100 p-2 rounded min-w-fit",children:JSON.stringify(t.searchAttributes,null,2)})})]})]});case"error":return _.jsxs("div",{className:A,children:[t.lastFailure&&_.jsxs("div",{className:"bg-red-50 p-4 rounded-lg overflow-auto relative",children:[_.jsx("h4",{className:"font-medium text-red-800 mb-2",children:"Last Failure"}),_.jsx(b,{content:JSON.stringify(JSON.parse(t.lastFailure),null,2)}),_.jsx("div",{className:"overflow-auto",children:_.jsx("pre",{className:"text-xs text-red-700 whitespace-pre-wrap break-all bg-red-100 p-2 rounded min-w-fit",children:JSON.stringify(JSON.parse(t.lastFailure),null,2)})})]}),t.failure&&_.jsxs("div",{className:"bg-red-50 p-4 rounded-lg overflow-auto relative",children:[_.jsx("h4",{className:"font-medium text-red-800 mb-2",children:"Failure"}),_.jsx(b,{content:JSON.stringify(JSON.parse(t.failure),null,2)}),_.jsx("div",{className:"overflow-auto",children:_.jsx("pre",{className:"text-xs text-red-700 whitespace-pre-wrap break-all bg-red-100 p-2 rounded min-w-fit",children:JSON.stringify(JSON.parse(t.failure),null,2)})})]})]});case"time":return _.jsxs("div",{className:A,children:[t.startTime&&t.endTime&&_.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[_.jsx("h4",{className:"font-medium text-purple-800 mb-2",children:"Duration"}),_.jsx("p",{className:"text-purple-700 text-lg font-semibold",children:ou(t.startTime,t.endTime)})]}),t.scheduleTime&&_.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[_.jsx("h4",{className:"font-medium text-purple-800 mb-2",children:"Schedule Time"}),_.jsx("p",{className:"text-purple-700",children:t.scheduleTime})]}),t.startTime&&_.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[_.jsx("h4",{className:"font-medium text-purple-800 mb-2",children:"Start Time"}),_.jsx("p",{className:"text-purple-700",children:t.startTime})]}),t.endTime&&_.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[_.jsx("h4",{className:"font-medium text-purple-800 mb-2",children:"End Time"}),_.jsx("p",{className:"text-purple-700",children:t.endTime})]}),t.lastStartedTime&&_.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[_.jsx("h4",{className:"font-medium text-purple-800 mb-2",children:"Last Started Time"}),_.jsx("p",{className:"text-purple-700",children:t.lastStartedTime})]}),t.lastAttemptCompleteTime&&_.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[_.jsx("h4",{className:"font-medium text-purple-800 mb-2",children:"Last Attempt Complete Time"}),_.jsx("p",{className:"text-purple-700",children:t.lastAttemptCompleteTime})]}),(t.heartbeatTimeout||t.scheduleToCloseTimeout||t.scheduleToStartTimeout||t.startToCloseTimeout||t.workflowRunTimeout||t.workflowTaskTimeout)&&_.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[_.jsx("h4",{className:"font-medium text-purple-800 mb-2",children:"Timeouts"}),t.heartbeatTimeout&&_.jsxs("p",{className:"text-purple-700",children:["Heartbeat: ",t.heartbeatTimeout]}),t.scheduleToCloseTimeout&&_.jsxs("p",{className:"text-purple-700",children:["Schedule to Close: ",t.scheduleToCloseTimeout]}),t.scheduleToStartTimeout&&_.jsxs("p",{className:"text-purple-700",children:["Schedule to Start: ",t.scheduleToStartTimeout]}),t.startToCloseTimeout&&_.jsxs("p",{className:"text-purple-700",children:["Start to Close: ",t.startToCloseTimeout]}),t.workflowRunTimeout&&_.jsxs("p",{className:"text-purple-700",children:["Workflow Run: ",t.workflowRunTimeout]}),t.workflowTaskTimeout&&_.jsxs("p",{className:"text-purple-700",children:["Workflow Task: ",t.workflowTaskTimeout]})]})]});case"common":return _.jsxs("div",{className:A,children:[_.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[_.jsx("h4",{className:"font-medium text-green-800 mb-2",children:"Basic Information"}),_.jsxs("div",{className:"space-y-2",children:[_.jsxs("p",{className:"text-green-700",children:["Type: ",t.type]}),t.activityType&&_.jsxs("p",{className:"text-green-700",children:["Activity Type: ",t.activityType]}),t.workflowType&&_.jsxs("p",{className:"text-green-700",children:["Workflow Type: ",t.workflowType]}),_.jsxs("p",{className:"text-green-700",children:["Status: ",t.status]}),t.namespace&&_.jsxs("p",{className:"text-green-700",children:["Namespace: ",t.namespace]}),t.workflowId&&_.jsxs("p",{className:"text-green-700",children:["Workflow ID: ",t.workflowId]}),(t.workflowRunId||t.runId)&&_.jsxs("p",{className:"text-green-700",children:["Run ID: ",t.workflowRunId||t.runId]}),t.activityId&&_.jsxs("p",{className:"text-green-700",children:["Activity ID: ",t.activityId]}),t.workflowTaskCompletedEventId&&_.jsxs("p",{className:"text-green-700",children:["Workflow Task Completed Event ID:"," ",t.workflowTaskCompletedEventId]})]})]}),t.taskQueue&&_.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[_.jsx("h4",{className:"font-medium text-green-800 mb-2",children:"Task Queue"}),_.jsxs("p",{className:"text-green-700",children:["Name: ",t.taskQueue.name]})]}),t.retryPolicy&&_.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[_.jsx("h4",{className:"font-medium text-green-800 mb-2",children:"Retry Policy"}),_.jsxs("div",{className:"space-y-2",children:[_.jsxs("p",{className:"text-green-700",children:["Initial Interval: ",t.retryPolicy.initialInterval]}),_.jsxs("p",{className:"text-green-700",children:["Backoff Coefficient: ",t.retryPolicy.backoffCoefficient]}),_.jsxs("p",{className:"text-green-700",children:["Maximum Interval: ",t.retryPolicy.maximumInterval]}),_.jsxs("p",{className:"text-green-700",children:["Maximum Attempts: ",t.retryPolicy.maximumAttempts]}),((R=t.retryPolicy.nonRetryableErrorTypes)==null?void 0:R.length)>0&&_.jsxs("div",{children:[_.jsx("p",{className:"text-green-700",children:"Non-retryable Error Types:"}),_.jsx("ul",{className:"list-disc pl-4",children:t.retryPolicy.nonRetryableErrorTypes.map((Z,re)=>_.jsx("li",{className:"text-green-700",children:Z},re))})]})]})]}),t.attempts&&_.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[_.jsx("h4",{className:"font-medium text-green-800 mb-2",children:"Attempts"}),_.jsxs("p",{className:"text-green-700",children:["Count: ",t.attempts]})]}),t.lastWorkerIdentity&&_.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[_.jsx("h4",{className:"font-medium text-green-800 mb-2",children:"Worker"}),_.jsxs("p",{className:"text-green-700",children:["Last Identity: ",t.lastWorkerIdentity]})]}),t.workflowReusePolicy&&_.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[_.jsx("h4",{className:"font-medium text-green-800 mb-2",children:"Workflow Reuse Policy"}),_.jsx("p",{className:"text-green-700",children:t.workflowReusePolicy})]})]})}},b=({content:A})=>{const R=()=>{navigator.clipboard.writeText(A)};return _.jsx("button",{onClick:R,className:"absolute top-4 right-4 p-1.5 rounded bg-white/80 hover:bg-white border border-gray-200 transition-colors",title:"Copy to clipboard",children:_.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-gray-600",children:[_.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),_.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]})})};return _.jsxs("div",{ref:a,"data-node-panel":!0,className:"fixed bg-white rounded-lg shadow-xl border border-gray-200 overflow-hidden",style:{...Q(),width:d.width,height:d.height,zIndex:P},onClick:G,children:[_.jsx("button",{onClick:A=>{A.stopPropagation(),r(e)},className:"absolute top-2 right-2 p-1.5 hover:bg-gray-100 rounded-full transition-colors z-50",title:"Close panel",children:_.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-gray-500",children:[_.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),_.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),_.jsx("div",{className:"absolute top-2 left-1/2 -translate-x-1/2 p-1.5 cursor-move select-none","data-drag-handle":!0,onMouseDown:K,children:_.jsxs("svg",{width:"20",height:"10",viewBox:"0 0 20 4",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"text-gray-400 pointer-events-none",children:[_.jsx("circle",{cx:"2",cy:"2",r:"1",fill:"currentColor"}),_.jsx("circle",{cx:"10",cy:"2",r:"1",fill:"currentColor"}),_.jsx("circle",{cx:"18",cy:"2",r:"1",fill:"currentColor"})]})}),(ee||t.type==="activity")&&_.jsxs("div",{className:Ft("px-4 py-2 bg-gray-50 border-b",t.type==="activity"&&"pt-6"),children:[_.jsxs("div",{className:"flex items-center justify-between mb-2 pr-8",children:[_.jsx("div",{className:"flex items-center gap-2",children:ee&&_.jsxs(_.Fragment,{children:[_.jsxs("svg",{className:"w-4 h-4 text-gray-600",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[_.jsx("rect",{x:"9",y:"3",width:"6",height:"6",rx:"1"}),_.jsx("rect",{x:"3",y:"15",width:"6",height:"6",rx:"1"}),_.jsx("rect",{x:"15",y:"15",width:"6",height:"6",rx:"1"}),_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3M6 15v-3h12v3"})]}),_.jsx("a",{href:ee,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"View in Temporal"})]})}),_.jsxs("div",{className:"flex flex-col items-end",children:[_.jsx("span",{className:"text-xs text-gray-500",children:t.namespace}),t.taskQueue&&_.jsx("span",{className:"text-xs text-gray-500",children:t.taskQueue.name})]})]}),_.jsxs("div",{className:"flex flex-col gap-1",children:[t.workflowType&&_.jsxs("span",{className:"text-xs text-gray-500",children:[_.jsx("span",{className:"font-bold",children:"Type:"})," ",_.jsx("span",{className:"font-bold",children:t.workflowType})]}),t.type==="activity"&&t.activityType&&_.jsxs("span",{className:"text-xs text-gray-500",children:[_.jsx("span",{className:"font-bold",children:"Type:"})," ",_.jsx("span",{className:"font-bold",children:t.activityType})]}),t.workflowId&&t.type!=="activity"&&_.jsx("span",{className:"text-xs text-gray-500 select-all font-mono",children:t.workflowId})]})]}),_.jsxs("div",{className:"border-b flex gap-1 px-2 pt-2 bg-gray-50",children:[_.jsx(se,{tab:"io",label:"Input/Output",disabled:!V}),_.jsx(se,{tab:"error",label:"Error",disabled:!Y}),_.jsx(se,{tab:"time",label:"Time",disabled:!te}),_.jsx(se,{tab:"common",label:"Common"})]}),_.jsx("div",{className:"overflow-y-auto",style:{height:"calc(100% - 116px)"},children:_.jsx("div",{className:"p-4",children:ae()})}),_.jsx("div",{className:"absolute bottom-0 right-0 w-4 h-4 cursor-se-resize",onMouseDown:I,style:{background:"linear-gradient(135deg, transparent 50%, #CBD5E1 50%)"}})]})}const co=500,Li=200,ka=8,vy=80;function Fi(e){var l,d,p;const t=((l=e.data)==null?void 0:l.title)||"",r=e.id||"",o=r.length>40?r.slice(0,37)+"...":r,s=t.length*ka,c=o.length*(ka*.8),a=Math.max(s,c)+vy;return((d=e.data)==null?void 0:d.type)==="workflow"||((p=e.data)==null?void 0:p.type)==="childWorkflow",Math.max(Math.min(Math.max(a,co*.75),co),Li)}function wy(e,t=800,r=100){const o=Fi(e),s=(t-o)/2-r;return e.position={x:s,y:0},e.style={...e.style,width:o},e}function Ea(e,t,r,o,s=200,c=40){var g,v;const a=[...e],l=[...t],d=a.find(w=>w.id===r);if(!d)return console.warn(`Parent node ${r} not found for layout.`),{nodes:a,edges:l};(g=d.style)!=null&&g.width||(d.style={...d.style,width:Fi(d)});const p=d.position.x+(((v=d.style)==null?void 0:v.width)||Li);let m=d.position.y;return o.sort((w,E)=>{const N=w.data.sortEventTime.localeCompare(E.data.sortEventTime);return N!==0?N:w.data.sortEventId-E.data.sortEventId}),o.forEach((w,E)=>{const N=Fi(w);if(w.style={...w.style,width:N},w.position={x:p+s,y:m},a.push(w),E===0)l.push({id:`${r}->${w.id}`,source:r,sourceHandle:`${r}-right`,target:w.id,targetHandle:`${w.id}-left`});else{const z=o[E-1];l.push({id:`${z.id}->${w.id}`,source:z.id,sourceHandle:`${z.id}-bottom`,target:w.id,targetHandle:`${w.id}-top`,type:"step",animated:!0})}m+=(w.height||80)+c}),{nodes:a,edges:l}}function xy(e,t,r,o,s=100){const c=e.filter(E=>E.id!==r),a=[...t],l=e.find(E=>E.id===r);if(!l)return{nodes:c,edges:a};const d=t.find(E=>E.target===r),p=t.find(E=>E.source===r),m=d==null?void 0:d.source,g=p==null?void 0:p.target,v=o.map((E,N)=>{var z;return{...E,position:{x:l.position.x,y:l.position.y+(N+1)*s},style:{...E.style,width:(z=l.style)==null?void 0:z.width}}}),w=[];if(v.forEach((E,N)=>{N>0&&w.push({id:`${v[N-1].id}->${E.id}`,source:v[N-1].id,target:E.id,sourceHandle:`${v[N-1].id}-bottom`,targetHandle:`${E.id}-top`,type:"step",animated:!0})}),m&&d){w.unshift({id:`${m}->${v[0].id}`,source:m,target:v[0].id,sourceHandle:d.sourceHandle,targetHandle:`${v[0].id}-top`,type:"step",animated:!0});const E=a.findIndex(N=>N.id===d.id);E!==-1&&a.splice(E,1)}if(g&&p){w.push({id:`${v[v.length-1].id}->${g}`,source:v[v.length-1].id,target:g,sourceHandle:`${v[v.length-1].id}-bottom`,targetHandle:p.targetHandle,type:"step",animated:!0});const E=a.findIndex(N=>N.id===p.id);E!==-1&&a.splice(E,1)}return c.push(...v),a.push(...w),{nodes:c,edges:a}}const by=async e=>{var r,o;const t={nodes:[],edges:[]};for(const s of e)if(s.type==="activity")t.nodes.push({id:`${s.activityId}-${s.workflowId}`,position:{x:0,y:0},type:"workflowNode",data:{...s,title:s.activityType,description:"",type:"activity",count:1,parentNodeId:s.workflowId,workflowTaskCompletedEventId:s.workflowTaskCompletedEventId,payload:(r=s.payload)==null?void 0:r.map(c=>c.data?atob(c.data):void 0)}});else if(s.type==="workflow"||s.type==="childWorkflow"){const c={...s,title:s.workflowType,description:"",type:s.type,count:1,workflowTaskCompletedEventId:s.workflowTaskCompletedEventId,parentNodeId:s.parentWorkflowId,groupComponentIds:[],payload:(o=s.payload)==null?void 0:o.map(a=>a.data?atob(a.data):void 0)};t.nodes.push({id:s.workflowId,position:{x:0,y:0},type:"workflowNode",data:c})}else throw new Error("Invalid item type "+s.type);return _y(t),t};function _y(e){const t={};for(const s of e.nodes){const c=s.data;let a=ky(c);const l=c.title,d=`${a}::${l}`;t[d]||(t[d]={batchKey:a,title:l,nodes:[]}),t[d].nodes.push(s)}const r=[],o=4;for(const s in t){const c=t[s],{nodes:a}=c;if(a.length<o){r.push(...a);continue}const l=a.length;let d=null;for(const v of a){const w=v.data,E=w.startTime??w.scheduleTime;E&&(d===null||E<d)&&(d=E)}const p=a[0],m=p.data,g={...p,position:{...p.position},data:{...m,count:l,batchKey:c.batchKey,groupComponentIds:c.nodes.map(v=>({type:v.data.type,id:v.data.type==="activity"?v.data.activityId:v.data.workflowId,workflowRunId:v.data.workflowRunId||v.data.runId})),nonCompletedStatusExists:c.nodes.some(v=>v.data.status!=="COMPLETED")}};g._earliestTime=d,r.push(g)}r.sort((s,c)=>{const a=s._earliestTime,l=c._earliestTime;return!a&&!l?0:a?l?a.localeCompare(l):-1:1});for(const s of r)delete s._earliestTime;e.nodes=r}function ky(e){return!e.workflowTaskCompletedEventId&&e.type==="workflow"?e.workflowId:parseInt(e.workflowTaskCompletedEventId,10).toString().padStart(10,"0")}const Ey=()=>{const[e,t]=O.useState(!0),r=O.useRef(null),o=O.useRef(!0),s=O.useCallback((p,m,g,v=.75,w=800)=>{!p||!o.current||p.setCenter(m,g,{zoom:v,duration:w})},[]),c=O.useCallback(p=>{!p||!o.current||p.fitView({padding:.2,duration:800,minZoom:.4})},[]),a=O.useCallback(p=>{r.current=p},[]),l=O.useCallback(()=>{!r.current||!o.current||r.current.fitView({padding:.2,duration:800,minZoom:.4})},[]),d=O.useCallback(p=>{o.current=p,t(p)},[]);return{autoZoomEnabled:e,setAutoZoomEnabled:d,handleZoom:s,fitView:c,onInit:a,onGraphLoad:l}},Sy=async(e,t,r)=>{r||(r="");const o=await fetch(`http://localhost:7531/workflow?namespace=${e}&id=${t}&runId=${r}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()},Ny=async()=>{try{return(await fetch("http://localhost:7531/health",{method:"GET"})).status===200}catch{return!1}},Mr=new Set,cu=e=>{Mr.add(e),window.dispatchEvent(new CustomEvent("workflow-loading-change",{detail:{workflowId:e,isLoading:!0}}))},uu=e=>{Mr.delete(e),window.dispatchEvent(new CustomEvent("workflow-loading-change",{detail:{workflowId:e,isLoading:!1}}))};function Cy(e){return Mr.has(e)}async function Ki(e,t,r,o=0){if(Mr.has(t))return r;const s=[{id:t,runId:r,workflowTaskCompletedEventId:"-1",depth:o}],c=new Set;for(;s.length>0;){const{id:a,runId:l,workflowTaskCompletedEventId:d,depth:p}=s.shift();if(c.has(a))continue;const m=await Ar(a,l);if(m&&!m.isPlaceholder){c.add(a);continue}cu(a);try{const g=await Sy(e,a,l);c.add(a);const v=[];for(const w of g)w.type==="workflow"?await zi({...w,workflowTaskCompletedEventId:d,isPlaceholder:!1}):w.type==="childWorkflow"?(v.push({workflowId:w.workflowId,workflowRunId:w.runId,workflowTaskCompletedEventId:w.workflowTaskCompletedEventId}),await zi({...w,type:"workflow",isPlaceholder:!0})):w.type==="activity"&&await su(w);p>0&&v.length>0&&v.forEach(w=>{s.push({id:w.workflowId,runId:w.workflowRunId,workflowTaskCompletedEventId:w.workflowTaskCompletedEventId,depth:p-1})})}catch(g){console.error("Error processing workflow:",g)}finally{uu(a)}}return r}async function Iy(e,t,r){try{cu(t);const o=await ss(t,r),s=[];for(const a of o){const l=a.workflowId;if(Mr.has(l))continue;const d=await Ar(l,r);d&&!d.isPlaceholder||s.push(a)}const c=s.map(async a=>{try{await Ki(e,a.workflowId,a.runId,1)}catch(l){console.error("Error loading workflow:",l)}});await Promise.all(c)}catch(o){console.error("Error checking child workflow data:",o)}finally{uu(t)}}function Ty(){const[e,t]=O.useState({nodes:[],edges:[],rootWorkflowId:void 0}),[r,o]=J.useState(!1),s=O.useRef(e),c=O.useRef(null),a=.4,{autoZoomEnabled:l,setAutoZoomEnabled:d,handleZoom:p,fitView:m,onInit:g,onGraphLoad:v}=Ey();O.useEffect(()=>{s.current=e},[e]);const w=async(K,I)=>{const Q=await P(K,I),G=Q.nodes.find(ee=>ee.id===K);if(!G){console.error(`Root node ${K} not found in graph data.`);return}const Y=Q.nodes.filter(ee=>ee.id!==K);G.data.isExpanded=!0;const te=wy(G),{nodes:V,edges:ie}=Ea([te],[],K,Y,150,20);t({nodes:V,edges:ie,rootWorkflowId:K}),o(!0),setTimeout(v,100)},E=O.useCallback(async(K,I)=>{const{nodes:Q,edges:G}=await z(K);return new Promise(Y=>{t(te=>{const V=te.nodes.filter(se=>!Q.includes(se.id)).map(se=>se.id===K?{...se,data:{...se.data,isExpanded:!1}}:se),ie=te.edges.filter(se=>!G.includes(se.id)),ee={nodes:V,edges:ie};return s.current=ee,Y(ee),ee})})},[]),N=O.useCallback(async(K,I)=>{try{const Q=s.current,G=Q.nodes.find(V=>V.id===K);if(!G)return;const Y=Q.nodes.filter(V=>V.data.type==="workflow"&&V.data.parentWorkflowId===G.data.parentWorkflowId&&V.data.workflowId!==K&&!G.data.groupComponentIds.some(ie=>ie.id===V.id)&&V.data.isExpanded);for(const V of Y)await E(V.id,V.data.workflowRunId);const te=await P(K,I);t(V=>{const ie=te.nodes.filter(M=>M.id!==K).map(M=>({...M,data:{...M.data,parentNodeId:K}})),ee=V.nodes.map(M=>M.id===K?{...M,data:{...M.data,isExpanded:!0}}:M),{nodes:se,edges:ae}=Ea(ee,V.edges,K,ie),b=te.edges.map(M=>({...M,id:`${M.id}-${Date.now()}`})),R={nodes:se.map(M=>M.id===K?{...M,data:{...M.data,isLoading:!1}}:M),edges:[...ae,...b]};s.current=R;const Z=se.find(M=>M.id===K),re=se.filter(M=>M.data.parentNodeId===K);return Z&&setTimeout(()=>{const M=re.reduce((oe,ce)=>Math.max(oe,ce.position.x),Z.position.x),q=(Z.position.x+M)/2;p(c.current,q,Z.position.y)},50),R})}catch(Q){console.error("Error expanding child workflow:",Q)}},[p,E]),z=async(K,I)=>{const Q=s.current.nodes.find(ie=>ie.id===K);if(!Q)return console.error(`Root node ${K} not found in graph data.`),{nodes:[],edges:[]};const G=new Set,Y=new Set,te=new Set,V=ie=>{te.has(ie)||(te.add(ie),ie!==K&&G.add(ie),s.current.edges.forEach(ee=>{var se;if(ee.source===ie){const ae=s.current.nodes.find(b=>b.id===ee.target);if(!ae){console.error(`Target node ${ee.target} not found in graph data.`);return}(ae.data.parentNodeId===K&&!((se=Q.data.groupComponentIds)!=null&&se.some(b=>b.id===ae.id))||G.has(ae.data.parentNodeId))&&(Y.add(ee.id),V(ee.target))}}))};return V(K),{nodes:Array.from(G),edges:Array.from(Y)}},P=async(K,I)=>{const Q=await Ar(K,I);if(!Q)return console.error(`Workflow ${K} not found`),{nodes:[],edges:[]};const G=await au(K,I),Y=await ss(K,I),te=[Q,...G,...Y];te.sort((ee,se)=>{const ae=ee.taskId?parseInt(ee.taskId):0,b=se.taskId?parseInt(se.taskId):0;return ae-b});const V=await by(te),ie=Y.map(async ee=>{try{await Iy(ee.namespace,ee.workflowId,ee.runId)}catch(se){console.error(`Error loading child workflow data for ${ee.workflowId}:`,se)}});return V.nodes=V.nodes.map(ee=>({...ee,data:{...ee.data,isLoading:Cy(ee.id)}})),Promise.all(ie).catch(ee=>console.error("Error loading child workflows:",ee)),V},H=O.useCallback(async K=>{try{const I=s.current.nodes.find(Y=>Y.id===K);if(!I||!I.data.count)return;const G=(await fy(I.data.groupComponentIds,I.data.workflowId,I.data.workflowRunId||I.data.runId)).map(Y=>({id:Y.type==="activity"?`${Y.activityId}-${Y.workflowId}`:Y.workflowId,type:"workflowNode",data:{...Y,parentWorkflowId:I.data.parentWorkflowId,type:I.data.type,title:Y.activityType||Y.workflowType,workflowId:Y.workflowId,count:1,groupComponentIds:[]},position:{x:0,y:0}}));G.sort((Y,te)=>{const V=Y.data.taskId||"",ie=te.data.taskId||"";return V.localeCompare(ie)}),t(Y=>{const te=new Set,V=A=>{Y.edges.forEach(R=>{R.source===A&&(te.add(R.target),V(R.target))})};V(K);const ie=G.length*100;I.data.count=1;const{nodes:ee,edges:se}=xy(Y.nodes,Y.edges,K,G),b={nodes:ee.map(A=>te.has(A.id)?{...A,position:{...A.position,y:A.position.y+ie+100}}:A),edges:se};return s.current=b,setTimeout(()=>{p(c.current,I.position.x,I.position.y)},100),b})}catch(I){console.error("Error spreading batch nodes:",I)}},[p]);return O.useEffect(()=>{const K=({detail:{workflowId:I,isLoading:Q}})=>{t(G=>{const Y=G.nodes.map(te=>te.id===I?{...te,data:{...te.data,isLoading:Q}}:te);return{...G,nodes:Y}})};return window.addEventListener("workflow-loading-change",K),()=>window.removeEventListener("workflow-loading-change",K)},[]),{graphData:e,setGraphData:t,onTemporalRootWorkflowDataCollected:w,expandChildWorkflowNode:N,collapseChildWorkflowNode:E,isRootLoaded:r,flowInstance:c,MIN_ZOOM:a,onSpreadBatchNodes:H,autoZoomEnabled:l,setAutoZoomEnabled:d,onInit:g}}const Ay=(e,t)=>{const r=new Set,o=s=>{r.add(s),e.edges.forEach(c=>{c.source===s&&!r.has(c.target)&&o(c.target)})};return t.forEach(o),Array.from(r)};function My(e,t){const[r,o]=O.useState(!1),[s,c]=O.useState(null),a=O.useRef(null),l=.4,d=O.useCallback(v=>new Set(Ay(e,[v])),[e]),p=O.useCallback(v=>{if(!a.current||!v)return;const w=e.nodes.filter(te=>te.position.x>=v.position.x);if(w.length===0){a.current.setCenter(v.position.x,v.position.y,{zoom:1,duration:800});return}const E=w.reduce((te,V)=>({minX:Math.min(te.minX,V.position.x||0),minY:Math.min(te.minY,V.position.y||0),maxX:Math.max(te.maxX,V.position.x||0),maxY:Math.max(te.maxY,V.position.y||0)}),{minX:v.position.x||0,minY:v.position.y||0,maxX:v.position.x||0,maxY:v.position.y||0});if(Object.values(E).some(isNaN)){console.warn("Invalid bounds detected, falling back to selected node"),a.current.setCenter(v.position.x,v.position.y,{zoom:1,duration:800});return}const N=(E.minX+E.maxX)/2,z=(E.minY+E.maxY)/2,P=100,H=Math.max(E.maxX-E.minX+P*2,100),K=Math.max(E.maxY-E.minY+P*2,100),I=a.current.getViewport(),Q=I.width||1e3,G=I.height||800;let Y=Math.min(Q/H,G/K);Y=Math.max(l,Math.min(isNaN(Y)?1:Y,1.5)),a.current.setCenter(isNaN(N)?v.position.x:N,isNaN(z)?v.position.y:z,{zoom:Y,duration:800})},[e.nodes]),m=O.useCallback(v=>{if(c(v),!v){t(N=>({...N,nodes:N.nodes.map(z=>({...z,style:{...z.style,opacity:1}}))})),a.current&&a.current.fitView({padding:.2,minZoom:l,duration:800});return}const w=d(v),E=e.nodes.find(N=>N.id===v);t(N=>({...N,nodes:N.nodes.map(z=>({...z,style:{...z.style,opacity:w.has(z.id)?1:.2}}))})),a.current&&E&&setTimeout(()=>{p(E)},50)},[e,t,d,p]),g=O.useCallback(()=>{c(null),t(v=>({...v,nodes:v.nodes.map(w=>({...w,style:{...w.style,opacity:1}}))})),a.current&&a.current.fitView({padding:.2,minZoom:l,duration:800})},[t]);return{showFocus:r,setShowFocus:o,selectedFocusedWorkflow:s,handleFocusChange:m,handleFocusReset:g,flowInstance:a}}function Py({onTemporalRootWorkflowDataCollected:e}){const[t,r]=O.useState(!1),[o,s]=O.useState(!1),c=async(d,p)=>{const m=await ss(d,p);for(const v of m)await c(v.workflowId,p);const g=await au(d,p);for(const v of g)await ly(d,v.activityId,p);await cy(d,p)};return{isTemporalModalOpen:t,setIsTemporalModalOpen:r,onTemporalModalSubmit:async d=>{if(!await Ny())throw new Error("The server is not running. Please start the server and try again.");const m=await Ki(d.namespace,d.workflowId,d.runId,2);r(!1),await e(d.workflowId,m)},refreshWorkflowData:async(d,p)=>{try{s(!0);const m=await Ar(d,p);if(!m){console.error("Workflow not found for refresh");return}await c(d,p);const g=await Ki(m.namespace,d,p,2);await e(d,g)}catch(m){console.error("Error refreshing workflow data:",m)}finally{s(!1)}},isRefreshing:o}}function Ry({isOpen:e,onClose:t,onSubmit:r}){const[o,s]=O.useState({namespace:"",workflowId:""}),[c,a]=O.useState(!1),[l,d]=O.useState(null);if(!e)return null;const p=async m=>{m.preventDefault(),a(!0),d(null);try{await r(o),t()}catch(g){d(g instanceof Error?g.message:"An error occurred while fetching workflow data")}finally{a(!1)}};return _.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:_.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[_.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[_.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Temporal Workflow Data"}),_.jsx("button",{onClick:t,className:"p-1 hover:bg-gray-100 rounded-full transition-colors",children:_.jsx(is,{className:"w-5 h-5 text-gray-500"})})]}),_.jsxs("form",{onSubmit:p,className:"p-4 space-y-4",children:[l&&_.jsx("div",{className:"p-3 bg-red-100 text-red-700 rounded-md text-sm",children:l}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Namespace"}),_.jsx("input",{type:"text",value:o.namespace,onChange:m=>s(g=>({...g,namespace:m.target.value})),className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,disabled:c})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Workflow ID"}),_.jsx("input",{type:"text",value:o.workflowId,onChange:m=>s(g=>({...g,workflowId:m.target.value})),className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,disabled:c})]}),_.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t mt-4",children:[_.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",disabled:c,children:"Cancel"}),_.jsx("button",{type:"submit",className:"px-4 py-2 text-white bg-blue-500 rounded-md hover:bg-blue-600 transition-colors disabled:bg-blue-300",disabled:c,children:c?"Loading...":"Get Data"})]})]})]})})}function jy(){const{graphData:e,setGraphData:t,onTemporalRootWorkflowDataCollected:r,expandChildWorkflowNode:o,collapseChildWorkflowNode:s,isRootLoaded:c,flowInstance:a,MIN_ZOOM:l,onSpreadBatchNodes:d,autoZoomEnabled:p,setAutoZoomEnabled:m,onInit:g}=Ty(),{showFocus:v,setShowFocus:w,selectedFocusedWorkflow:E,handleFocusChange:N,handleFocusReset:z,flowInstance:P}=My(e,t),{isTemporalModalOpen:H,setIsTemporalModalOpen:K,onTemporalModalSubmit:I,refreshWorkflowData:Q,isRefreshing:G}=Py({onTemporalRootWorkflowDataCollected:r}),[Y,te]=J.useState(null),[V,ie]=J.useState(!1),[ee,se]=O.useState(!0),ae=J.useRef(!1),[b,A]=O.useState([]),R=(q,oe)=>{const ce=q.type==="activity"?q.activityId:q.workflowId;ce&&A(me=>me.find(be=>be.id===ce)?me:[...me,{id:ce,node:q,position:oe}])},Z=q=>{A(oe=>oe.filter(ce=>ce.id!==q))},re=O.useMemo(()=>({workflowNode:q=>_.jsx(oy,{...q,expandChildWorkflowNode:o,collapseChildWorkflowNode:s,onSpreadBatchNodes:d,onShowNodeData:R})}),[c]),M=J.useCallback(q=>{t(oe=>({...oe,nodes:Bc(q,oe.nodes)}))},[t]);return J.useEffect(()=>{const q=new URLSearchParams(window.location.search),oe=decodeURIComponent(q.get("id")||""),ce=q.get("namespace"),me=q.get("runID");return te(null),(async()=>{if(!ae.current)if(ae.current=!0,oe&&ce&&me){ie(!0),console.log("loading from url",oe,ce,me);try{await I({workflowId:oe,namespace:ce,runId:me})}catch(be){console.error("Error loading workflow from URL params:",be),te(be instanceof Error?be.message:"An error occurred while loading the workflow")}finally{ie(!1)}}else te("Invalid URL parameters"),ie(!1)})(),()=>{}},[]),_.jsxs("div",{className:"w-screen h-screen flex flex-col bg-gray-50",children:[V&&_.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:_.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-xl flex items-center space-x-3",children:[_.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),_.jsx("div",{className:"text-gray-700",children:"Loading workflow data..."})]})}),Y&&_.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert",children:[_.jsx("strong",{className:"font-bold",children:"Error: "}),_.jsx("span",{className:"block sm:inline",children:Y}),_.jsxs("button",{className:"absolute top-0 bottom-0 right-0 px-4 py-3",onClick:()=>te(null),children:[_.jsx("span",{className:"sr-only",children:"Dismiss"}),_.jsx(is,{className:"h-5 w-5"})]})]}),_.jsx("div",{className:"flex-grow h-full",children:_.jsxs(Jc,{nodes:e.nodes,edges:e.edges,onNodesChange:M,nodeTypes:re,fitView:!1,minZoom:l,className:"bg-gray-50",onInit:q=>{a.current=q,P.current=q,g(q)},nodesDraggable:!1,edgesUpdatable:!1,children:[_.jsx(Gm,{}),_.jsx(Wm,{}),_.jsx(kr,{position:"bottom-right",className:"flex items-center gap-2 bg-transparent z-10 mb-2 mr-2",children:_.jsxs("button",{onClick:()=>se(!ee),className:"bg-blue-500 px-3 py-1 rounded-lg shadow-lg hover:bg-blue-600 text-white transition-colors",children:[ee?"Hide":"Show"," Minimap"]})}),ee&&_.jsx($m,{zoomable:!0,pannable:!0,className:"bg-white rounded-lg shadow-lg",style:{backgroundColor:"white",width:300,height:200},maskColor:"rgba(0, 0, 0, 0.1)",nodeColor:"#aaa",nodeStrokeWidth:3,nodeBorderRadius:2}),_.jsx(kr,{position:"top-right",className:"flex items-center gap-2 bg-transparent",children:_.jsx("div",{className:"bg-white p-2 rounded-lg shadow-lg",children:_.jsx(yy,{showFocus:v,setShowFocus:w,autoZoomEnabled:p,setAutoZoomEnabled:m,setIsTemporalModalOpen:K,refreshWorkflowData:Q,currentWorkflowId:e.rootWorkflowId,isRefreshing:G,onTemporalRootWorkflowDataCollected:r})})})]})}),b.map(q=>_.jsx(gy,{id:q.id,data:q.node,position:q.position,onClose:Z},q.id)),v&&_.jsx(iy,{nodes:e.nodes,onFocusChange:N,selectedWorkflow:E,onReset:z,onClose:()=>w(!1)}),_.jsx(Ry,{isOpen:H,onClose:()=>K(!1),onSubmit:I})]})}Ia(document.getElementById("root")).render(_.jsx(O.StrictMode,{children:_.jsx(jy,{})}));
